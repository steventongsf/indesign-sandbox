<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_x_m_l_utils</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_x_m_l_utils.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#nested-classes">Classes</a> | <a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_x_m_l_utils-members.html">List of all members</a></div><div class="headertitle"><div class="title">IXMLUtils Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_x_m_l_utils_8h_source.html">IXMLUtils.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IXMLUtils:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_x_m_l_utils.png" usemap="#IXMLUtils_map" /><map id="IXMLUtils_map" name="IXMLUtils_map"><area alt="IPMUnknown" coords="0,0,85,24" href="class_i_p_m_unknown.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a> Classes</h2></td></tr><tr class="memitem:"><td align="right" class="memItemLeft" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils_1_1_i_x_m_l_callback.html">IXMLCallback</a></td></tr><tr class="separator:"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a701fee1fbd7cdde10ebae6991d4fa893"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IXMLUTILS }</td></tr><tr class="separator:a701fee1fbd7cdde10ebae6991d4fa893"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa9fbd364da769c83eed3eb0fc91960ba"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aa9fbd364da769c83eed3eb0fc91960ba">CalcXMLParent_Result</a> { <b>kSuccessCalc</b> = 0, <b>kStartUnmatched</b> = 1, <b>kEndUnmatched</b> = 2, <b>kBothUnmatched</b> = kStartUnmatched+kEndUnmatched }</td></tr><tr class="separator:aa9fbd364da769c83eed3eb0fc91960ba"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:acd06ce1a1e2d946faee4051ba0bd0f0b"><td align="right" class="memItemLeft" valign="top"><a class="anchor" id="acd06ce1a1e2d946faee4051ba0bd0f0b"></a> virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>GetBackingStore</b> (<a class="el" href="class_i_document.html">IDocument</a> *doc)=0</td></tr><tr class="separator:acd06ce1a1e2d946faee4051ba0bd0f0b"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:acd3a4514744a8d647089044804f0b9ae"><td align="right" class="memItemLeft" valign="top"><a class="anchor" id="acd3a4514744a8d647089044804f0b9ae"></a> virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>GetBackingStore</b> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:acd3a4514744a8d647089044804f0b9ae"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af14c5708effd9849971258810d47bc45"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af14c5708effd9849971258810d47bc45">QueryDocElement</a> (<a class="el" href="class_i_document.html">IDocument</a> *document)=0</td></tr><tr class="separator:af14c5708effd9849971258810d47bc45"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa8c60a9e26319cfa95ce51d8fe6ff15c"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aa8c60a9e26319cfa95ce51d8fe6ff15c">QueryDocElement</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:aa8c60a9e26319cfa95ce51d8fe6ff15c"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aec089e3c7f66ff4dab9712e7a3356063"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aec089e3c7f66ff4dab9712e7a3356063">QueryRootElement</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *xmlDocElement)=0</td></tr><tr class="separator:aec089e3c7f66ff4dab9712e7a3356063"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a094cbdf3bfdc7a6b7aa7643f93b9debe"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a094cbdf3bfdc7a6b7aa7643f93b9debe">QueryRootElement</a> (<a class="el" href="class_i_document.html">IDocument</a> *document)=0</td></tr><tr class="separator:a094cbdf3bfdc7a6b7aa7643f93b9debe"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ae64c8a1cb5914c76f5002bb3aed841e9"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ae64c8a1cb5914c76f5002bb3aed841e9">QueryRootElement</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:ae64c8a1cb5914c76f5002bb3aed841e9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aaa219387c244f4ab1bda6ddcf7238be0"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_tag_list.html">IXMLTagList</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aaa219387c244f4ab1bda6ddcf7238be0">QueryXMLTagList</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:aaa219387c244f4ab1bda6ddcf7238be0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a44c4c017690d57561ae9b7ba979cc3e1"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_style_to_tag_map.html">IXMLStyleToTagMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a44c4c017690d57561ae9b7ba979cc3e1">QueryXMLStyleToTagMap</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:a44c4c017690d57561ae9b7ba979cc3e1"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af36ecf00cd924e8083943b0f82aab801"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_tag_to_style_map.html">IXMLTagToStyleMap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af36ecf00cd924e8083943b0f82aab801">QueryXMLTagToStyleMap</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:af36ecf00cd924e8083943b0f82aab801"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ac3e8c056a148d86a374e902bf7bf93bd"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ac3e8c056a148d86a374e902bf7bf93bd">QueryTextModel</a> (const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element)=0</td></tr><tr class="separator:ac3e8c056a148d86a374e902bf7bf93bd"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aae40419f5216bfe4081f6e9d649e12df"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aae40419f5216bfe4081f6e9d649e12df">QueryXMLReferenceData</a> (<a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *item, bool16 allowTOP=kFalse)=0</td></tr><tr class="separator:aae40419f5216bfe4081f6e9d649e12df"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a81e717219e3c7d58fe57bc51bfe6a84c"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a81e717219e3c7d58fe57bc51bfe6a84c">QueryXMLReferenceData</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;item, bool16 allowTOP=kFalse)=0</td></tr><tr class="separator:a81e717219e3c7d58fe57bc51bfe6a84c"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a38f9a171407245e272aa9cc3384012c2"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a38f9a171407245e272aa9cc3384012c2">QueryXMLReferenceData</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, TextIndex textIndex, bool16 allowTOP=kFalse)=0</td></tr><tr class="separator:a38f9a171407245e272aa9cc3384012c2"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a80f844ce30f5b06e2cf22babed0c315b"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a80f844ce30f5b06e2cf22babed0c315b">QueryXMLReferenceData</a> (<a class="el" href="class_i_text_model.html">ITextModel</a> *textModel, TextIndex textIndex, bool16 allowTOP=kFalse)=0</td></tr><tr class="separator:a80f844ce30f5b06e2cf22babed0c315b"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa6f4933682d7aad7b55164a9b6721b49"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aa6f4933682d7aad7b55164a9b6721b49">QueryXMLReferenceData</a> (const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;xmlReference)=0</td></tr><tr class="separator:aa6f4933682d7aad7b55164a9b6721b49"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0aea8cce43e4852ecc0bc154b7eee871"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a0aea8cce43e4852ecc0bc154b7eee871">GetElementIndices</a> (const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element, TextIndex *startPos, TextIndex *endPos)=0</td></tr><tr class="separator:a0aea8cce43e4852ecc0bc154b7eee871"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9c75a7bee13926ae774b72c9dad283e0"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a9c75a7bee13926ae774b72c9dad283e0">GetElementMarkerPositions</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element, TextIndex *startPos, TextIndex *endPos)=0</td></tr><tr class="separator:a9c75a7bee13926ae774b72c9dad283e0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af0c6a3578d9a5696dc226e657c0fa997"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af0c6a3578d9a5696dc226e657c0fa997">CalculateStartEndTextIndex</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element, int32 beforeChildIndex, TextIndex &amp;startTextIndex, TextIndex &amp;endTextIndex)=0</td></tr><tr class="separator:af0c6a3578d9a5696dc226e657c0fa997"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a87d8c9323781f66adb58dd1678fe8714"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a87d8c9323781f66adb58dd1678fe8714">UpdateAutoAttrib</a> (const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;ref)=0</td></tr><tr class="separator:a87d8c9323781f66adb58dd1678fe8714"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a97522d6b9bd8af49430f17586c4b7e06"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a97522d6b9bd8af49430f17586c4b7e06">GetStoryXMLReference</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyRef)=0</td></tr><tr class="separator:a97522d6b9bd8af49430f17586c4b7e06"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aacbb5c0b702a2012dd86bc62d3ac8870"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aacbb5c0b702a2012dd86bc62d3ac8870">GetStoryThreadXMLReference</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, TextIndex textIndex)=0</td></tr><tr class="separator:aacbb5c0b702a2012dd86bc62d3ac8870"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a4300b38d141bd5e4fd604d73ccb95d31"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a4300b38d141bd5e4fd604d73ccb95d31">GetStoryThreadXMLReference</a> (<a class="el" href="class_i_text_model.html">ITextModel</a> *textModel, TextIndex textIndex)=0</td></tr><tr class="separator:a4300b38d141bd5e4fd604d73ccb95d31"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a58720d84cfccff86b6eef847b31bb991"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a58720d84cfccff86b6eef847b31bb991">CalcXMLParent</a> (<a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;startParentXMLRef, int32 &amp;startIndexInParent, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &gt; &amp;childRefList, <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;endParentXMLRef, int32 &amp;endIndexInParent, TextIndex startTextIndex, TextIndex endTextIndex, <a class="el" href="class_i_text_model.html">ITextModel</a> *iTextModel, bool16 useReverseSearch=kTrue)=0</td></tr><tr class="separator:a58720d84cfccff86b6eef847b31bb991"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a3c7b0c532f4c7383414423b44cb348b0"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a3c7b0c532f4c7383414423b44cb348b0">CalcXMLElementsInTextRange</a> (<a class="el" href="class_i_text_model.html">ITextModel</a> *iTextModel, TextIndex startTextIndex, TextIndex endTextIndex, <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;parentXMLRef, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &gt; &amp;childRefList)=0</td></tr><tr class="separator:a3c7b0c532f4c7383414423b44cb348b0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a30b2ab3a837572afc9e678785f05d971"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a30b2ab3a837572afc9e678785f05d971">AssignTagUID</a> (const <a class="el" href="class_wide_string.html">WideString</a> &amp;strTag, <a class="el" href="class_i_data_base.html">IDataBase</a> *db, <a class="el" href="class_i_d_type.html">UID</a> colorUID, <a class="el" href="class_i_d_type.html">UID</a> &amp;tagUID)=0</td></tr><tr class="separator:a30b2ab3a837572afc9e678785f05d971"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad4dce8bae9dbc95f0d24bc39a1ac172d"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ad4dce8bae9dbc95f0d24bc39a1ac172d">IsTagValid</a> (const <a class="el" href="class_wide_string.html">WideString</a> &amp;tag)=0</td></tr><tr class="separator:ad4dce8bae9dbc95f0d24bc39a1ac172d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a4d442bd04247728c59499347d4e9e02e"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a4d442bd04247728c59499347d4e9e02e">IsNmtoken</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;token)=0</td></tr><tr class="separator:a4d442bd04247728c59499347d4e9e02e"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad5363348790dc6719cdc8b90d8c30f5a"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ad5363348790dc6719cdc8b90d8c30f5a">IsValidXMLComment</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;comment)=0</td></tr><tr class="separator:ad5363348790dc6719cdc8b90d8c30f5a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0f4fdf5bb929a91313c3c3ea059bb072"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a0f4fdf5bb929a91313c3c3ea059bb072">IsValidXMLPITarget</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;piTarget)=0</td></tr><tr class="separator:a0f4fdf5bb929a91313c3c3ea059bb072"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a56ee302c07e7c978f521909b44c7cad8"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a56ee302c07e7c978f521909b44c7cad8">IsValidXMLPIData</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;piData)=0</td></tr><tr class="separator:a56ee302c07e7c978f521909b44c7cad8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5b1607f7ead6a7883a96c367fac53f43"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a5b1607f7ead6a7883a96c367fac53f43">IsTaggablePageItem</a> (<a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *item)=0</td></tr><tr class="separator:a5b1607f7ead6a7883a96c367fac53f43"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a3d4ec12341e15a6822113669ff913da5"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a3d4ec12341e15a6822113669ff913da5">FindUnusedTags</a> (<a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;unusedTag)=0</td></tr><tr class="separator:a3d4ec12341e15a6822113669ff913da5"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab0cb41e53dbb61206bbf575b4aa735bc"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_d_type.html">UID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ab0cb41e53dbb61206bbf575b4aa735bc">ImportHREF</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db, const <a class="el" href="class_p_m_string.html">PMString</a> &amp;href, const <a class="el" href="class_i_d_file.html">IDFile</a> *relativeTo, bool16 &amp;useFrame, UIFlags uiFlags=kFullUI)=0</td></tr><tr class="separator:ab0cb41e53dbb61206bbf575b4aa735bc"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a49195fb29d0041542511d38b02b7e42c"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a49195fb29d0041542511d38b02b7e42c">IsElementLocked</a> (const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element)=0</td></tr><tr class="separator:a49195fb29d0041542511d38b02b7e42c"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a280b3c7035ca81cb177502785f086f64"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a280b3c7035ca81cb177502785f086f64">IsStoryLocked</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyRef)=0</td></tr><tr class="separator:a280b3c7035ca81cb177502785f086f64"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad1cd23091ecde2a7439e7e21d06d79f8"><td align="right" class="memItemLeft" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ad1cd23091ecde2a7439e7e21d06d79f8">HasUnlockedStory</a> (<a class="el" href="class_i_data_base.html">IDataBase</a> *db)=0</td></tr><tr class="separator:ad1cd23091ecde2a7439e7e21d06d79f8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ae48479f2983e00385a4ba427dfeecb61"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ae48479f2983e00385a4ba427dfeecb61">LinkElementInTextRange</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, TextIndex start, int32 numChars)=0</td></tr><tr class="separator:ae48479f2983e00385a4ba427dfeecb61"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5cc1b600e07eb3bbe074a89e57911ad7"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_d_type.html">UID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a5cc1b600e07eb3bbe074a89e57911ad7">GetGraphicFrame</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;contentUID)=0</td></tr><tr class="separator:a5cc1b600e07eb3bbe074a89e57911ad7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a7f0db3605e5a69752fc06639876f610d"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a7f0db3605e5a69752fc06639876f610d">IsElementAGraphic</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element) const =0</td></tr><tr class="separator:a7f0db3605e5a69752fc06639876f610d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5922c0294f3dbbd344536a20407da1a3"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a5922c0294f3dbbd344536a20407da1a3">GetActualContent</a> (<a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;contentRef)=0</td></tr><tr class="separator:a5922c0294f3dbbd344536a20407da1a3"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a84e7ce685d73a329525be891d8194a63"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a84e7ce685d73a329525be891d8194a63">ValidateXML</a> (const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;startXMLRef, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_d_t_d_validation_error.html">XMLDTDValidationError</a> &gt; &amp;errors, int32 maxErrors=250, bool16 treatAsRoot=kFalse, bool16 checkHasDTD=kFalse)=0</td></tr><tr class="separator:a84e7ce685d73a329525be891d8194a63"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a7a2254b3b8782f5ba5dd6e238b492eb8"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a7a2254b3b8782f5ba5dd6e238b492eb8">ExportElement</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *element, bool16 includeHeader, <a class="el" href="class_i_x_m_l_access.html">IXMLAccess</a> *access, <a class="el" href="class_i_x_m_l_handler.html">IXMLHandler</a> *exportHandler, const <a class="el" href="class_i_d_file.html">IDFile</a> &amp;sysFile, <a class="el" href="class_i_document.html">IDocument</a> *doc, const <a class="el" href="class_p_m_string.html">PMString</a> &amp;formatName, UIFlags uiFlags) const =0</td></tr><tr class="separator:a7a2254b3b8782f5ba5dd6e238b492eb8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:afc787a006fc986081e301f479160bbd8"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#afc787a006fc986081e301f479160bbd8">ExportDTDToStream</a> (const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;xmlRef, <a class="el" href="class_i_x_m_l_out_stream.html">IXMLOutStream</a> *s, bool16 internalSubsetOnly=kFalse)=0</td></tr><tr class="separator:afc787a006fc986081e301f479160bbd8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af090ab60e56ed4cef8f81af4d3d296a6"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af090ab60e56ed4cef8f81af4d3d296a6">IsExportableInCopyStory</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef)=0</td></tr><tr class="separator:af090ab60e56ed4cef8f81af4d3d296a6"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a2069c1c5fc96c9b0ee2eb03fb4d4e8d6"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a2069c1c5fc96c9b0ee2eb03fb4d4e8d6">FindMissingFile</a> (<a class="el" href="class_p_m_string.html">PMString</a> filename, <a class="el" href="class_i_d_file.html">IDFile</a> &amp;fileToImport)=0</td></tr><tr class="separator:a2069c1c5fc96c9b0ee2eb03fb4d4e8d6"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ac9463ac2b98aa39e6b08c56a07ecb4ad"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#ac9463ac2b98aa39e6b08c56a07ecb4ad">GetImportedRootXMLReference</a> (<a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *importer)=0</td></tr><tr class="separator:ac9463ac2b98aa39e6b08c56a07ecb4ad"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa3a7b8b0853e7c040085dd3d681a8e00"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#aa3a7b8b0853e7c040085dd3d681a8e00">ForEachElement</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *root, <a class="el" href="class_i_x_m_l_utils_1_1_i_x_m_l_callback.html">IXMLCallback</a> *callback)=0</td></tr><tr class="separator:aa3a7b8b0853e7c040085dd3d681a8e00"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af9e5d81695c66ce8109cd9ab4458f89d"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af9e5d81695c66ce8109cd9ab4458f89d">IsParentCellWithType</a> (<a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *childElement, <a class="el" href="class_i_d_type.html">CellType</a> cellType)=0</td></tr><tr class="separator:af9e5d81695c66ce8109cd9ab4458f89d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af1e37cb2d74ee0e51fe23297140d1d98"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#af1e37cb2d74ee0e51fe23297140d1d98">SetShouldDeleteElementOnContentDeletion</a> (const bool16 shouldDelete=kTrue) const =0</td></tr><tr class="separator:af1e37cb2d74ee0e51fe23297140d1d98"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a7b15c9c2c10b34411f01026ff5175be1"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a7b15c9c2c10b34411f01026ff5175be1">ShouldDeleteElementOnContentDeletion</a> () const =0</td></tr><tr class="separator:a7b15c9c2c10b34411f01026ff5175be1"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0011aa6548aaa3501d25c973f6878024"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_x_m_l_utils.html#a0011aa6548aaa3501d25c973f6878024">SetLayoutTag</a> (const <a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;itemList, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;tag, bool16 retag, bool16 allowPresetUI)=0</td></tr><tr class="separator:a0011aa6548aaa3501d25c973f6878024"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>Utilities for traversing and working within the logical structure tree. </div><h2 class="groupheader">Member Enumeration Documentation</h2><a class="anchor" id="aa9fbd364da769c83eed3eb0fc91960ba"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">enum <a class="el" href="class_i_x_m_l_utils.html#aa9fbd364da769c83eed3eb0fc91960ba">IXMLUtils::CalcXMLParent_Result</a></td></tr></table></div><div class="memdoc"><p>Enumeration containing return values for <a class="el" href="class_i_x_m_l_utils.html#a58720d84cfccff86b6eef847b31bb991">CalcXMLParent()</a></div></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a30b2ab3a837572afc9e678785f05d971"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IXMLUtils::AssignTagUID </td><td>(</td><td class="paramtype">const <a class="el" href="class_wide_string.html">WideString</a> &amp;&nbsp;</td><td class="paramname"><em>strTag</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_type.html">UID</a>&nbsp;</td><td class="paramname"><em>colorUID</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_type.html">UID</a> &amp;&nbsp;</td><td class="paramname"><em>tagUID</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Create a new tag (<a class="el" href="class_i_x_m_l_tag.html">IXMLTag</a>) in the tag-list (<a class="el" href="class_i_x_m_l_tag_list.html">IXMLTagList</a>). <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">strTag</td><td>specifies the tag-name to use </td></tr><tr><td class="paramname">db</td><td>identifies the database, into whose tag-list the new tag is inserted </td></tr><tr><td class="paramname">colorUID</td><td>contains the UID of the color to use for the tag (kInvalidUID if you don&#39;t care) </td></tr><tr><td class="paramname">tagUID</td><td>contains the UID of the newly created tag or kInvalidUID if unsuccessful. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="af0c6a3578d9a5696dc226e657c0fa997"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::CalculateStartEndTextIndex </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>beforeChildIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex &amp;&nbsp;</td><td class="paramname"><em>startTextIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex &amp;&nbsp;</td><td class="paramname"><em>endTextIndex</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Calculate the range of text before/after/in between child objects per the XML structure. Used when generating chunks of XML content. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies XML element of interest </td></tr><tr><td class="paramname">beforeChildIndex</td><td>specifies the indicies to be calculated are BEFORE this child (to get the indices after the last child pass the last child index + 1) </td></tr><tr><td class="paramname">startPos</td><td>[OUT] start of text-range before specified child </td></tr><tr><td class="paramname">endPos</td><td>[OUT] end of text-range before specified child </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kFalse if there is no XML content for the specified element before the specified child </dl></div></div><a class="anchor" id="a3c7b0c532f4c7383414423b44cb348b0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::CalcXMLElementsInTextRange </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>iTextModel</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>startTextIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>endTextIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>parentXMLRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>childRefList</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given a text range, calculate a list of top-level XML elements that are fully contained in the range. Elements that are partially inside the range are not included in the list. startTextIndex and endTextIndex must be in the same story thread.<p>[IN] text model of the range @ startTextIndex [IN] TextIndex to start the calculation @ endTextIndex [IN] TextIndex to stop the calculation (INCLUSIVE, this means range of 3,3 is actually one character; 3,2 signifies an insertion position) @ parentXMLRef [OUT] the parent of the elements in chilRefList @ childRefList [OUT] a list of top-level children in the text range </div></div><a class="anchor" id="a58720d84cfccff86b6eef847b31bb991"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IXMLUtils::CalcXMLParent </td><td>(</td><td class="paramtype"><a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>startParentXMLRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32 &amp;&nbsp;</td><td class="paramname"><em>startIndexInParent</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>childRefList</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>endParentXMLRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32 &amp;&nbsp;</td><td class="paramname"><em>endIndexInParent</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>startTextIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>endTextIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>iTextModel</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>useReverseSearch</em> = <code>kTrue</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Perform the element calculations as if the given text range is to be tagged. Given a text range, determine the XML element (given as <a class="el" href="class_x_m_l_reference.html">XMLReference</a>) that should be the parent (along with the child index) of the selection. Also calculates a list of children of the final parent that should become the children of the created element<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">startParentXMLRef</td><td>parent XML element to start the calculation. Receives the XML element that should be the parent of the selection. If the result is not kSuccessCalc, receives the parent of startTextIndex </td></tr><tr><td class="paramname">startIndexInParent</td><td>receives the child index of startParentXMLRef the selection should be inserted as </td></tr><tr><td class="paramname">childRefList</td><td>a list of children of startParentXMLRef that should become children of the new XML element. Valid on return only if returned result code is kSuccessCalc </td></tr><tr><td class="paramname">endParentXMLRef</td><td>if the result is not kSuccessCalc, receives the parent of endTextIndex. Valid on return only if returned result code is not kSuccessCalc </td></tr><tr><td class="paramname">endIndexInParent</td><td>if the result is not kSuccessCalc, receives the child index of endParentXMLRef. Valid on return only if returned result code is not kSuccessCalc </td></tr><tr><td class="paramname">startTextIndex</td><td>TextIndex to start the calculation </td></tr><tr><td class="paramname">endTextIndex</td><td>TextIndex to stop the calculation (INCLUSIVE, this means range of 3,3 is actually one character; 3,2 signifies an insertion position) </td></tr><tr><td class="paramname">iTextModel</td><td>text model of text to insert </td></tr><tr><td class="paramname">useReverseSearch</td><td>Usually, this method searches the child elements in the reverse order, from back to front. This is to optimize for the case of repeated append operations, such as when building XML structure during import using the parsed order to create elements. Reverse search is faster in this case because most of the desired data is at the end of the child list. Set this parameter to kFalse will cause the search to be done in the front to back order. This search order can be faster for cases such as building the structure in the reverse order, where most of the desired data is at the front of the child list </td></tr></table></dl><dl class="section return"><dt>Returns<dd>CalcXMLParent_Result code </dl></div></div><a class="anchor" id="afc787a006fc986081e301f479160bbd8"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::ExportDTDToStream </td><td>(</td><td class="paramtype">const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>xmlRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_x_m_l_out_stream.html">IXMLOutStream</a> *&nbsp;</td><td class="paramname"><em>s</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>internalSubsetOnly</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Export the DTD to the given stream. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">xmlRef</td><td><a class="el" href="class_x_m_l_reference.html">XMLReference</a> of any element in the XML to export the DTD from </td></tr><tr><td class="paramname">s</td><td>stream to export to </td></tr><tr><td class="paramname">internalSubsetOnly</td><td>whether to write internal subset only </td></tr></table></dl></div></div><a class="anchor" id="a7a2254b3b8782f5ba5dd6e238b492eb8"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IXMLUtils::ExportElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>includeHeader</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_x_m_l_access.html">IXMLAccess</a> *&nbsp;</td><td class="paramname"><em>access</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_x_m_l_handler.html">IXMLHandler</a> *&nbsp;</td><td class="paramname"><em>exportHandler</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_d_file.html">IDFile</a> &amp;&nbsp;</td><td class="paramname"><em>sysFile</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>doc</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>formatName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">UIFlags&nbsp;</td><td class="paramname"><em>uiFlags</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Export an XML element and its children to a stream <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies the element to export </td></tr><tr><td class="paramname">includeHeader</td><td>Include the DTD in the XML? </td></tr><tr><td class="paramname">access</td><td>used to navigate and export the sub-elements </td></tr><tr><td class="paramname">exportHandler</td><td>contains the stream to write to </td></tr><tr><td class="paramname">sysFile</td><td>the actual file we are writing to </td></tr><tr><td class="paramname">doc</td><td>document we are writing the XML from </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode Did theexport work? </dl></div></div><a class="anchor" id="a2069c1c5fc96c9b0ee2eb03fb4d4e8d6"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::FindMissingFile </td><td>(</td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="paramname"><em>filename</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_file.html">IDFile</a> &amp;&nbsp;</td><td class="paramname"><em>fileToImport</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Allow the user to find a missing file referenced in the XML. In the server case log an error to the error list <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">filename</td><td>string that describes the file name in the XML </td></tr><tr><td class="paramname">fileToImport</td><td>string that returns the file name that was selected </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 whether the file was found or not </dl></div></div><a class="anchor" id="a3d4ec12341e15a6822113669ff913da5"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::FindUnusedTags </td><td>(</td><td class="paramtype"><a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;&nbsp;</td><td class="paramname"><em>unusedTag</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given an open document, return which are not used to mark-up content in the document. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">unusedTag</td><td>[OUT] list of tags not marking up content in document implied by its database. Note that the database of the <a class="el" href="class_u_i_d_list.html">UIDList</a> supplied should be the database of the document containing the tags that the query is about. </td></tr></table></dl></div></div><a class="anchor" id="aa3a7b8b0853e7c040085dd3d681a8e00"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::ForEachElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>root</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_x_m_l_utils_1_1_i_x_m_l_callback.html">IXMLCallback</a> *&nbsp;</td><td class="paramname"><em>callback</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Iterate a portion of the XML tree, using the supplied element as the root of a sub-tree. Will call into the callback object for each element in the sub-tree. Uses a non-recursive algorithm so it works with deep trees. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">root</td><td>The root of the elements to iterate. </td></tr><tr><td class="paramname">callback</td><td>The object to callback for each element Returns kInvalidXMLReference if no root element is found. </td></tr></table></dl></div></div><a class="anchor" id="a5922c0294f3dbbd344536a20407da1a3"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::GetActualContent </td><td>(</td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>contentRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the taggable content <a class="el" href="class_u_i_d_ref.html">UIDRef</a> that&#39;s associated with the incoming UID. Returns true if the item can be tagged. Returns a valid contentRef if there is content that can be immediately tagged. A return value of kTrue, together with an invalid contentRef shows that item can be tagged if placeholder content can be added.<p>If caller passed in a graphic frame, this method will return the taggable content from the graphic frame. If it is a text frame, will return the story.<p>If its a graphic frame, and it has content, this method will tunnel down to the children to find taggable content. If the frame has content, but the content isn&#39;t taggable, this method would flag an error by returning kFalse<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">contentRef</td><td>[OUT] holds the content item if it can be found </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 indicating success of operation(if kTrue) or failure (kFalse) </dl></div></div><a class="anchor" id="a0aea8cce43e4852ecc0bc154b7eee871"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::GetElementIndices </td><td>(</td><td class="paramtype">const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex *&nbsp;</td><td class="paramname"><em>startPos</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex *&nbsp;</td><td class="paramname"><em>endPos</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Get the positions of the marker characters for the given element returns kTrue if the positions are marker positions; kFalse if content position (i.e. story element which does not have markers) <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies element of interest </td></tr><tr><td class="paramname">startPos</td><td>[OUT] TextIndex where the begin-element marker tag is located in the textflow </td></tr><tr><td class="paramname">endPos</td><td>[OUT] TextIndex where the end-element marker tag is located in the textflow </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if positions are marker positions, kFalse if content positions and the story element does not have markers in it </dl></div></div><a class="anchor" id="a9c75a7bee13926ae774b72c9dad283e0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::GetElementMarkerPositions </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex *&nbsp;</td><td class="paramname"><em>startPos</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex *&nbsp;</td><td class="paramname"><em>endPos</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Get the actual positions of the marker characters for the given element. The values returned are always marker positions in the story that contains the markers, which is not always the content&#39;s story (such as link elements) <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies XML element of interest </td></tr><tr><td class="paramname">startPos</td><td>[OUT] start of text-range tagged by this element </td></tr><tr><td class="paramname">endPos</td><td>[OUT] end of text-range tagged by this element </td></tr></table></dl></div></div><a class="anchor" id="a5cc1b600e07eb3bbe074a89e57911ad7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_d_type.html">UID</a> IXMLUtils::GetGraphicFrame </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>contentUID</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the graphic frame that contains the content. If the content is a text model, it returns the graphic frame that contains the multi-column frame. If the content is a page item, it returns the graphic frame that contains the page item. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">contentUID</td><td>specifies the content item that we&#39;re interested in </td></tr></table></dl><dl class="section return"><dt>Returns<dd>UID of graphic frame containing the content, which can be kInvalidUID if the content isn&#39;t placed into a story yet </dl></div></div><a class="anchor" id="ac9463ac2b98aa39e6b08c56a07ecb4ad"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a> IXMLUtils::GetImportedRootXMLReference </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>importer</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the the root element of the imported XML data. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">importer</td><td>An interface on <a class="el" href="classk_x_m_l_importer_boss.html">kXMLImporterBoss</a>. Must not be nil. </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_x_m_l_reference.html">XMLReference</a> The <a class="el" href="class_x_m_l_reference.html">XMLReference</a> of the roort element. Returns kInvalidXMLReference if no root element is found. </dl></div></div><a class="anchor" id="aacbb5c0b702a2012dd86bc62d3ac8870"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a> IXMLUtils::GetStoryThreadXMLReference </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>textIndex</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the <a class="el" href="class_x_m_l_reference.html">XMLReference</a> corresponding to the given text position&#39;s story thread <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyUIDRef</td><td><a class="el" href="class_u_i_d_ref.html">UIDRef</a> of the story </td></tr><tr><td class="paramname">textIndex</td><td>TextIndex of the text position </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_x_m_l_reference.html">XMLReference</a> of the given text position&#39;s story thread </dl></div></div><a class="anchor" id="a4300b38d141bd5e4fd604d73ccb95d31"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a> IXMLUtils::GetStoryThreadXMLReference </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>textModel</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>textIndex</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the <a class="el" href="class_x_m_l_reference.html">XMLReference</a> corresponding to the given text position&#39;s story thread <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">textModel</td><td>TextModel of the story </td></tr><tr><td class="paramname">textIndex</td><td>TextIndex of the text position </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_x_m_l_reference.html">XMLReference</a> of the given text position&#39;s story thread </dl></div></div><a class="anchor" id="a97522d6b9bd8af49430f17586c4b7e06"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_x_m_l_reference.html">XMLReference</a> IXMLUtils::GetStoryXMLReference </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the <a class="el" href="class_x_m_l_reference.html">XMLReference</a> that corresponds to the story. In the case the story is the backing store (unplaced content), the XML document&#39;s <a class="el" href="class_x_m_l_reference.html">XMLReference</a> is returned <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyRef</td><td>specifies the story of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_x_m_l_reference.html">XMLReference</a> to story corresponding to given <a class="el" href="class_x_m_l_reference.html">XMLReference</a></dl></div></div><a class="anchor" id="ad1cd23091ecde2a7439e7e21d06d79f8"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool IXMLUtils::HasUnlockedStory </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns true if the database contains unlocked stories <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">in</td><td>IDatabase current database </td></tr></table></dl></div></div><a class="anchor" id="ab0cb41e53dbb61206bbf575b4aa735bc"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_d_type.html">UID</a> IXMLUtils::ImportHREF </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>href</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_d_file.html">IDFile</a> *&nbsp;</td><td class="paramname"><em>relativeTo</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16 &amp;&nbsp;</td><td class="paramname"><em>useFrame</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">UIFlags&nbsp;</td><td class="paramname"><em>uiFlags</em> = <code>kFullUI</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Import a page item into the given database using the &#39;href&#39; passed in as the path to the file. Note that this doesn&#39;t imply that the content will be loaded across the wire; it is strictly a path in the local file system at the time of writing. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>database to import the page item into </td></tr><tr><td class="paramname">href</td><td>a string which represents the path to the file you want to import </td></tr><tr><td class="paramname">relativeTo</td><td>if passed in (it can be nil), the href passed in will be used as a relative path with respect to &#39;relativeTo&#39; if &#39;relativeTo&#39; is a directory, the path will stem from it, if &#39;relativeTo&#39; is a file, the path will stem from it&#39;s parent directory </td></tr><tr><td class="paramname">useFrame</td><td>[OUT] parameter </td></tr><tr><td class="paramname">uiFlags</td><td>specifies how much UI to show </td></tr></table></dl><dl class="section return"><dt>Returns<dd>UID of the page item created </dl></div></div><a class="anchor" id="a7f0db3605e5a69752fc06639876f610d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsElementAGraphic </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine if we consider the element to be a graphic element. If it has an href and no content or children, then we consider it a graphic <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies element of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if a graphic element,kFalse otherwise </dl></div></div><a class="anchor" id="a49195fb29d0041542511d38b02b7e42c"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsElementLocked </td><td>(</td><td class="paramtype">const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><pre class="fragment">Checks to see if the content is locked given the element via ITextLockData on given element.

</pre><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies element of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if locked and kFalse otherwise </dl></div></div><a class="anchor" id="af090ab60e56ed4cef8f81af4d3d296a6"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsExportableInCopyStory </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>determine whether the given story is exportable as an InCopy story from XML&#39;s perspective <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyUIDRef</td><td><a class="el" href="class_u_i_d_ref.html">UIDRef</a> of story to export </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if the story is exportable as InCopy story; kFalse otherwise </dl></div></div><a class="anchor" id="a4d442bd04247728c59499347d4e9e02e"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsNmtoken </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>token</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine whether the given token matched XML 1.0 specification&#39;s (REC-xml-20001060) production for [7] Nmtoken <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">token</td><td>token to check </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if the token is a Nmtoken; kFalse otherwise </dl></div></div><a class="anchor" id="af9e5d81695c66ce8109cd9ab4458f89d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsParentCellWithType </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>childElement</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_type.html">CellType</a>&nbsp;</td><td class="paramname"><em>cellType</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Checks whether the Parent of the Passed element is Table-Cell With CellType being equal to the passed CellType like kPageItemContentType, kTextContentType etc <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">childElement</td><td>The element whose Parent we need to check, if parent is not Table-Cell then returns kFalse </td></tr><tr><td class="paramname">cellType</td><td>The cellType of the Parent of element which is Table-Cell is also matched if the Parent is Table-Cell. Returns kTrue if Parent is Table-Cell and CellType also matches the passed cellType. </td></tr></table></dl></div></div><a class="anchor" id="a280b3c7035ca81cb177502785f086f64"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsStoryLocked </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><pre class="fragment">Checks to see if the content is locked given the story

</pre><p> NOTE: now it works for generic page items too, not just stories <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyRef</td><td>specifies story of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if story locked, kFalse otherwise </dl></div></div><a class="anchor" id="a5b1607f7ead6a7883a96c367fac53f43"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsTaggablePageItem </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>item</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine if given boss object could be marked-up. If this item or a child down the hierarchy has an <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> IFace, it is it can be marked-up (is taggable). Alternatively if this item is a graphic frame, it can be marked-up (is taggable). If this item is a group or a guide it cannot be marked-up (is not taggable) <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">item</td><td>interface on boss object (page item) of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if the page item can be marked up, kFalse otherwise </dl></div></div><a class="anchor" id="ad4dce8bae9dbc95f0d24bc39a1ac172d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsTagValid </td><td>(</td><td class="paramtype">const <a class="el" href="class_wide_string.html">WideString</a> &amp;&nbsp;</td><td class="paramname"><em>tag</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Checks to see if a given tag-name would be appropriate as the name for an XML element (not whether tag already exists as that would imply a database). Determines in order; <ol><li> if the tag is empty <li> if there are whitespace characters in the name <li> If there are &#39;illegal&#39; characters; see <a href="http://www.w3c.org/TR/2000/REC-xml-20001006#NT-Name">XML 1.0 specification</a></ol><p>For instance, names for an XML element can only begin with an alphabetic character or an underline, or a colon. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">tag</td><td>name of tag to check </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if can be used for tag-name, kFalse otherwise </dl></div></div><a class="anchor" id="ad5363348790dc6719cdc8b90d8c30f5a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsValidXMLComment </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>comment</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine whether the given comment is a valid XML comment per XML 1.0 specification (REC-xml-20001006), section 2.5 <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">comment</td><td>comment to check </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if the comment is valid; kFalse otherwise </dl></div></div><a class="anchor" id="a56ee302c07e7c978f521909b44c7cad8"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsValidXMLPIData </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>piData</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine whether the given string is a valid XML processing instruction data per XML 1.0 specification (REC-xml-20001006), section 2.6 <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">piData</td><td>PI data to check </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if piData is a valid PI data; kFalse otherwise </dl></div></div><a class="anchor" id="a0f4fdf5bb929a91313c3c3ea059bb072"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::IsValidXMLPITarget </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>piTarget</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine whether the given string is a valid XML processing instruction target per XML 1.0 specification (REC-xml-20001006), section 2.6 <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">piTarget</td><td>PI target to check </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue if piTarget is a valid PI target; kFalse otherwise </dl></div></div><a class="anchor" id="ae48479f2983e00385a4ba427dfeecb61"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::LinkElementInTextRange </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>start</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>numChars</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determines whether there are any link elements in the given text range.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyUIDRef</td><td>specifies story of interest </td></tr><tr><td class="paramname">start</td><td>where to start looking for link elements </td></tr><tr><td class="paramname">numChars</td><td>how many chars forward in the textmodel to search </td></tr></table></dl><dl class="section return"><dt>Returns<dd>kTrue if the text range contains at least one link XML element; kFalse otherwise </dl></div></div><a class="anchor" id="af14c5708effd9849971258810d47bc45"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a>* IXMLUtils::QueryDocElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the XML document element for the given document <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>specifies document of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="aa8c60a9e26319cfa95ce51d8fe6ff15c"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a>* IXMLUtils::QueryDocElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the XML document element for the given database, based on the database&#39; document <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>specifies database of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="aec089e3c7f66ff4dab9712e7a3356063"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a>* IXMLUtils::QueryRootElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>xmlDocElement</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the root element of the given XML document element <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">xmlDocElement</td><td>XML document element of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="a094cbdf3bfdc7a6b7aa7643f93b9debe"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a>* IXMLUtils::QueryRootElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the root element of the given document <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>specifies document of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> interface ptr that has its reference-count incremented to the root XML element </dl></div></div><a class="anchor" id="ae64c8a1cb5914c76f5002bb3aed841e9"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a>* IXMLUtils::QueryRootElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the root element of the given database (based on the db&#39;s document) <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>database from document </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> interface ptr that has its reference-count incremented to the root element </dl></div></div><a class="anchor" id="ac3e8c056a148d86a374e902bf7bf93bd"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_text_model.html">ITextModel</a>* IXMLUtils::QueryTextModel </td><td>(</td><td class="paramtype">const <a class="el" href="class_i_i_d_x_m_l_element.html">IIDXMLElement</a> *&nbsp;</td><td class="paramname"><em>element</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Query for the text model associated with given element. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">element</td><td>specifies element of interest. Note that <code>element-&gt;GetContentItem()</code> should be a valid UID. </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_text_model.html">ITextModel</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="aae40419f5216bfe4081f6e9d649e12df"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a>* IXMLUtils::QueryXMLReferenceData </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>item</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>allowTOP</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given any interface on an arbitrary boss object, determine if there is XML data associated with it&#39;s content. This method checks the contents of frames in the following order; <ol><li> a text on a path frame <li> a text frame <li> a graphic frame </ol><p>It will try to return an <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> given knowledge about the model format.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">item</td><td>specifies the boss object of interest (frame of some kind) </td></tr><tr><td class="paramname">allowTOP</td><td>set to be kTrue if text on path frames are allowable, kFalse otherwise </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> interface ptr that has its reference-count incremented for the content of the frame </dl></div></div><a class="anchor" id="a81e717219e3c7d58fe57bc51bfe6a84c"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a>* IXMLUtils::QueryXMLReferenceData </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>item</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>allowTOP</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Overload of method QueryXMLReferenceData, given a persistent reference rather than an interface ptr. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">item</td><td>specifies frame of interest </td></tr><tr><td class="paramname">allowTOP</td><td>kTrue if text on path frames are allowable, kFalse otherwise </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="a38f9a171407245e272aa9cc3384012c2"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a>* IXMLUtils::QueryXMLReferenceData </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>textIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>allowTOP</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given a text index position, return the <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> associated with the text index. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyUIDRef</td><td><a class="el" href="class_u_i_d_ref.html">UIDRef</a> of the story the text index is in </td></tr><tr><td class="paramname">textIndex</td><td>TextIndex to query <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> for </td></tr><tr><td class="paramname">allowTOP</td><td>kTrue if text on path frames are allowable, kFalse otherwise </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="a80f844ce30f5b06e2cf22babed0c315b"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a>* IXMLUtils::QueryXMLReferenceData </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>textModel</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>textIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>allowTOP</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given a text index position, return the <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> associated with the text index. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">textModel</td><td>TextModel of the story the text index is in </td></tr><tr><td class="paramname">textIndex</td><td>TextIndex to query <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> for </td></tr><tr><td class="paramname">allowTOP</td><td>kTrue if text on path frames are allowable, kFalse otherwise </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="aa6f4933682d7aad7b55164a9b6721b49"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a>* IXMLUtils::QueryXMLReferenceData </td><td>(</td><td class="paramtype">const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>xmlReference</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given a <a class="el" href="class_x_m_l_reference.html">XMLReference</a>, return the <a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> associated with the element&#39;s content, if applicable <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">xmlReference</td><td><a class="el" href="class_x_m_l_reference.html">XMLReference</a> of the element to process </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_reference_data.html">IXMLReferenceData</a> interfaceptr that has its reference-count incremeneted, if the element has such content. nil otherwise </dl></div></div><a class="anchor" id="a44c4c017690d57561ae9b7ba979cc3e1"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_style_to_tag_map.html">IXMLStyleToTagMap</a>* IXMLUtils::QueryXMLStyleToTagMap </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Query for the mapping between paragraph/character styles and tags in the given databse. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>specifies database of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_style_to_tag_map.html">IXMLStyleToTagMap</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="aaa219387c244f4ab1bda6ddcf7238be0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_tag_list.html">IXMLTagList</a>* IXMLUtils::QueryXMLTagList </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Query for the tag-list in the given database. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>database containing tag-list of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_tag_list.html">IXMLTagList</a> interface ptr that has its reference-count incremented </dl></div></div><a class="anchor" id="af36ecf00cd924e8083943b0f82aab801"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_x_m_l_tag_to_style_map.html">IXMLTagToStyleMap</a>* IXMLUtils::QueryXMLTagToStyleMap </td><td>(</td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>db</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Query for the mapping between tag-names and paragraph/character styles in the given database. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">db</td><td>database containing mapping of interest </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_x_m_l_tag_to_style_map.html">IXMLTagToStyleMap</a> interface ptr that has its reference-count incremented, for given database </dl></div></div><a class="anchor" id="a0011aa6548aaa3501d25c973f6878024"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IXMLUtils::SetLayoutTag </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;&nbsp;</td><td class="paramname"><em>itemList</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>tag</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>retag</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>allowPresetUI</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><pre class="fragment">Set the tag for a layout item (page item)

</pre><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">target</td><td>- The target to use when tagging the object </td></tr><tr><td class="paramname">tag</td><td>- The <a class="el" href="class_u_i_d_ref.html">UIDRef</a> of the tag you want to use </td></tr><tr><td class="paramname">retag</td><td>- Whether to retag an existing element with a new tag </td></tr><tr><td class="paramname">allowPresetUI</td><td>- Allow the tagging preset UI to popup </td></tr></table></dl><dl class="section return"><dt>Returns<dd>- Whether the method succeeded or not </dl></div></div><a class="anchor" id="af1e37cb2d74ee0e51fe23297140d1d98"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IXMLUtils::SetShouldDeleteElementOnContentDeletion </td><td>(</td><td class="paramtype">const bool16&nbsp;</td><td class="paramname"><em>shouldDelete</em> = <code>kTrue</code></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Sets the preference to also delete the XML element when its content has been deleted. Default is kFalse. </div></div><a class="anchor" id="a7b15c9c2c10b34411f01026ff5175be1"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IXMLUtils::ShouldDeleteElementOnContentDeletion </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Gets the value for preference to also delete the XML element when its content has been deleted. <dl class="section see"><dt>See Also<dd><a class="el" href="class_i_x_m_l_utils.html#af1e37cb2d74ee0e51fe23297140d1d98">IXMLUtils::SetShouldDeleteElementOnContentDeletion</a>. </dl></div></div><a class="anchor" id="a87d8c9323781f66adb58dd1678fe8714"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IXMLUtils::UpdateAutoAttrib </td><td>(</td><td class="paramtype">const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>ref</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Automatic attributes are at present &#39;href&#39;. If the element associated with the given <a class="el" href="class_x_m_l_reference.html">XMLReference</a> is a graphic item, then at the time of writing (InDesign 2.0) it will automatically get an href attribute added to it. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">ref</td><td></td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="a84e7ce685d73a329525be891d8194a63"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IXMLUtils::ValidateXML </td><td>(</td><td class="paramtype">const <a class="el" href="class_x_m_l_reference.html">XMLReference</a> &amp;&nbsp;</td><td class="paramname"><em>startXMLRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_x_m_l_d_t_d_validation_error.html">XMLDTDValidationError</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>errors</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>maxErrors</em> = <code>250</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>treatAsRoot</em> = <code>kFalse</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>checkHasDTD</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Validate the XML against a DTD. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">startXMLRef</td><td><a class="el" href="class_x_m_l_reference.html">XMLReference</a> of the element to start the validation at. Use the document element to validate the entire XML </td></tr><tr><td class="paramname">errors</td><td>[OUT] receives vector of validation errors found </td></tr></table></dl><dl class="section see"><dt>See Also<dd><a class="el" href="class_x_m_l_d_t_d_validation_error.html">XMLDTDValidationError</a></dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">maxErrors</td><td>maximum number of errors to retrieve. Use -1 to get all the errors </td></tr><tr><td class="paramname">treatAsRoot</td><td>if startXMLRef is not the document element or the root element, whether to check startXMLRef against DOCTYPE root element type. This is used when validating from something other than the root, but still wants to treat the starting element as root </td></tr><tr><td class="paramname">checkHasDTD</td><td>if startXMLRef has no DTD reference, whether it should be flagged as an error. Set this flag to kFalse, and XML without DTD will also &quot;pass&quot; the validation </td></tr></table></dl></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_x_m_l_utils.html">IXMLUtils</a><li class="footer">Generated on Sat Sep 22 2018 10:54:34 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
