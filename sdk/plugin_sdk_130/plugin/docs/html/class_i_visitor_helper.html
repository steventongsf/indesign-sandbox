<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_visitor_helper</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_visitor_helper.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_visitor_helper-members.html">List of all members</a></div><div class="headertitle"><div class="title">IVisitorHelper Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_visitor_helper_8h_source.html">IVisitorHelper.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IVisitorHelper:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_visitor_helper.png" usemap="#IVisitorHelper_map" /><map id="IVisitorHelper_map" name="IVisitorHelper_map"><area alt="IPMUnknown" coords="0,0,165,24" href="class_i_p_m_unknown.html" shape="rect" /><area alt="HierarchyVisitorHelperImpl" coords="0,112,165,136" href="class_hierarchy_visitor_helper_impl.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:aabcefe5e04e7bbeb93930d3832d0ae60"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IVISITORHELPER }</td></tr><tr class="separator:aabcefe5e04e7bbeb93930d3832d0ae60"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a5e3e49b8173fa25fe595c34c6d41f0bf"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_visitor_helper.html#a5e3e49b8173fa25fe595c34c6d41f0bf">Accept</a> (<a class="el" href="class_i_base_visitor.html">IBaseVisitor</a> *theVisitor)=0</td></tr><tr class="separator:a5e3e49b8173fa25fe595c34c6d41f0bf"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:acc0bb00cecdfe46f35d86840535e04c0"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_visitor_helper.html#acc0bb00cecdfe46f35d86840535e04c0">CollectChildren</a> (<a class="el" href="class_i_base_handler.html">IBaseHandler</a> *theHandler)=0</td></tr><tr class="separator:acc0bb00cecdfe46f35d86840535e04c0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a772f8e0f2605cc2156a5075a607bf0c4"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_visitor_helper.html">IVisitorHelper</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_visitor_helper.html#a772f8e0f2605cc2156a5075a607bf0c4">QueryChild</a> (int32 index)=0</td></tr><tr class="separator:a772f8e0f2605cc2156a5075a607bf0c4"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><pre class="fragment">A helper class, used with IBaseVisitor and IBaseHandler, to facilitate accomplishing tasks

while traversing an arbitrary structure of nodes (typically of items on a spread).  IVisitorHelper is

the &quot;glue&quot; that is aggregated to a structure node to enable it to be visited, as well as to hand

control off to a handler routine for accomplishing a given task.



The IVisitorHelper::Accept routine is based on the visitor design pattern from Gamma, et al., in tandem

with the methods of IBaseVisitor.  It is the IVisitorHelper implementation on a given node boss that contains

the knowledge of how links to child nodes are maintained.  For instance, while pageitems are typically

linked by the IHierarchy interface in InDesign, the IVisitorHelper scheme doesn&#39;t require any specific

interface to be supported by nodes; each node&#39;s implementation of IVisitorHelper utilizes the linkage

mechanism native to the node to which it is aggregated.  Because of this, it is not even a requirement that

all nodes in a given structure utilize a common linkage mechanism, in order for the visitor/handler scheme to

operate.



NOTE: Third-party-created pageitems that are not derived from built-in InDesign page item bosses must contain

an IVisitorHelper interface on the page item boss in order for hit-testing to be supported for the item.  

Also, since VisitXXX and HandleXXX routines aren&#39;t defined for these pageitems in IBaseVisitor and IBaseHandler,

these should be provided by custom implementations that are added-in to the kBaseVisitorBoss and kPtrHitTestHandlerBoss

(respectively).  The kPtrHitTestHandlerBoss is the base boss for InDesign hit-testing; several other boss 

classes derive from it.



Sample code for setting up the visitor, handler, and root item&#39;s visitor helper for a hit-testing scenario

&lt;pre&gt;

</pre><p>Assume defined: <a class="el" href="class_p_m_rect.html">PMRect</a> hitRect; // a target rect to hit-test <a class="el" href="class_i_control_view.html">IControlView</a> view; // the current view UIDList* pTheSpreads; // a list of spreads visible in the view ClassID handlerClass; // ClassID of a handler boss that knows how to do hit-testing for each node type <pre class="fragment">AGMGraphicsContext gc(view);

PMMatrix theXForm = gc.GetTransform();

theXForm.Transform(&amp;hitRect);



IDataBase* theDB = pTheSpreads-&gt;GetDataBase();

</pre><p>Create a visitor and the appropriate Handler for what we want to do. InterfacePtr&lt;IBaseVisitor&gt; theVisitor((IBaseVisitor*)::CreateObject(kBaseVisitorBoss, IID_IBASEVISITOR)); InterfacePtr&lt;IBaseHandler&gt; theHandler((IBaseHandler*)::CreateObject(handlerClass, IID_IBASEHANDLER));<p>Load the visitor and handler with setup data. theVisitor-&gt;InitVisitor(theDB, theHandler);<p>Our hit-test handler boss keeps the hit rect on this interface; yours may store other things on add-ins InterfacePtr&lt;IBaseSelectionHandlerData&gt; theHandlerData(theHandler, IID_IBASESELECTIONHANDLERDATA); theHandlerData-&gt;Set(hitRect); Handler boss uses one of its own interfaces for results of the hit-test task InterfacePtr&lt;IUIDListData&gt; theResults(theHandler, IID_IUIDLISTDATA); theResults-&gt;Set( new UIDList( theDB ));<p>loop through the spreads until a hit is found bool16 bDone = kFalse;<p><a class="el" href="class_graphics_data_ptr.html">GraphicsDataPtr</a> gd(&amp;gc); for (int32 i = 0; i &lt; pTheSpreads-&gt;Length() &amp;&amp; !bDone; i++) { InterfacePtr&lt;IShape&gt; spreadShape(pTheSpreads-&gt;GetRef(i), IID_ISHAPE); if (theVisitor &amp;&amp; theHandler &amp;&amp; spreadShape) { <a class="el" href="class_i_base_handler.html">IBaseHandler</a> <em>t = theHandler; <a class="el" href="class_base_hit_test_handler_impl.html">BaseHitTestHandlerImpl</a></em> bhth = reinterpret_cast&lt;BaseHitTestHandlerImpl*&gt;(t); bhth-&gt;InitHandler(gd, spreadShape);<p>Call Accept on the spread with the visitor InterfacePtr&lt;IVisitorHelper&gt; theHelper(spreadShape, IID_IVISITORHELPER); if (theHelper) bDone = theHelper-&gt;Accept(theVisitor); bhth-&gt;TerminateHandler(); } } Upon completion, handler boss might have left interesting data on one of its interfaces. In this example, the hit items are in theResults. The bDone value tells whether it actually found anything. <pre class="fragment">&lt;/pre&gt;

</pre><dl class="section see"><dt>See Also<dd><a class="el" href="class_i_base_visitor.html">IBaseVisitor</a><dd><a class="el" href="class_i_base_handler.html">IBaseHandler</a></dl></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a5e3e49b8173fa25fe595c34c6d41f0bf"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IVisitorHelper::Accept </td><td>(</td><td class="paramtype"><a class="el" href="class_i_base_visitor.html">IBaseVisitor</a> *&nbsp;</td><td class="paramname"><em>theVisitor</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><pre class="fragment">        Initiate traversal for the node.

        The Accept routine&#39;s role is to call the routine in theVisitor appropriate for the node.  For built-in

        nodes in InDesign, this means calling one of the IVisitor::VisitXXX routines.  An Accept routine

        for a custom node &quot;MyNode&quot; might look like the following, assuming a custom IMyNodeVisitor interface has been added-in to

        the kBaseVisitorBoss to pass control to the proper routine in the handler:

        &lt;pre&gt;

bool16 MyNodeVisitorHelperImpl::Accept(IBaseVisitor* theVisitor) 

{

    bool16 bDone = kFalse;

</pre><p> Query the interface added-in to <a class="el" href="classk_base_visitor_boss.html">kBaseVisitorBoss</a> to visit my node InterfacePtr&lt;IMyNodeVisitor&gt; myVisitor(theVisitor, UseDefaultIID()); Call the Visitor without knowing anything about what its handler is going to do if (theVisitor) bDone = myVisitor-&gt;VisitMyNode(this); return bDone; } <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">theVisitor</td><td>IN a pointer to the <a class="el" href="class_i_base_visitor.html">IBaseVisitor</a> that knows how to pass control off to specific visitor routines, depending on the type of node found </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 whether to stop traversal yet or not; kTrue means stop immediately, kFalse means continue </dl><p>Implemented in <a class="el" href="class_hierarchy_visitor_helper_impl.html#a60067f647febdef04f72760a693da2fa">HierarchyVisitorHelperImpl</a>.</div></div><a class="anchor" id="acc0bb00cecdfe46f35d86840535e04c0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IVisitorHelper::CollectChildren </td><td>(</td><td class="paramtype"><a class="el" href="class_i_base_handler.html">IBaseHandler</a> *&nbsp;</td><td class="paramname"><em>theHandler</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Determine how many children this node has, and if necessary, do any allocation or caching needed when individual children are accessed via QueryChild. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">theHandler</td><td>IN pointer to the <a class="el" href="class_i_base_handler.html">IBaseHandler</a> in use for this visitation. This may be useful for interrogating information from the handler &ndash; for instance, the GetHandlerIntersectionRect() routine to determine the target rectangle in a hit-testing task (useful for trivial rejection). </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 the number of children found for this item. </dl><p>Implemented in <a class="el" href="class_hierarchy_visitor_helper_impl.html#ab2c24fdbc225442f198f1d003b4bfef3">HierarchyVisitorHelperImpl</a>.</div></div><a class="anchor" id="a772f8e0f2605cc2156a5075a607bf0c4"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_visitor_helper.html">IVisitorHelper</a>* IVisitorHelper::QueryChild </td><td>(</td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>index</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Query for a specific child of this node. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">index</td><td>IN the index of the node desired (zero-based) </td></tr></table></dl><dl class="section return"><dt>Returns<dd>an <a class="el" href="class_i_visitor_helper.html">IVisitorHelper</a> pointer to the child node </dl><p>Implemented in <a class="el" href="class_hierarchy_visitor_helper_impl.html#a884099f5f45b30bf44965086f9ece7c0">HierarchyVisitorHelperImpl</a>.</div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_visitor_helper.html">IVisitorHelper</a><li class="footer">Generated on Sat Sep 22 2018 10:54:32 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
