<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_drag_drop_text_utils</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_drag_drop_text_utils.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_drag_drop_text_utils-members.html">List of all members</a></div><div class="headertitle"><div class="title">IDragDropTextUtils Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_drag_drop_text_utils_8h_source.html">IDragDropTextUtils.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IDragDropTextUtils:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_drag_drop_text_utils.png" usemap="#IDragDropTextUtils_map" /><map id="IDragDropTextUtils_map" name="IDragDropTextUtils_map"><area alt="IPMUnknown" coords="0,0,117,24" href="class_i_p_m_unknown.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a55e5ff542230f4ca5920f122391a79c7"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IDRAGDROPTEXTUTILS }</td></tr><tr class="separator:a55e5ff542230f4ca5920f122391a79c7"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:ab6c7ddcca910e129f58d46d40981d4bc"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#ab6c7ddcca910e129f58d46d40981d4bc">StartTextDrag</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *view, <a class="el" href="class_i_drag_drop_source.html">IDragDropSource</a> *dragSource, <a class="el" href="class_i_event.html">IEvent</a> *theEvent)=0</td></tr><tr class="separator:ab6c7ddcca910e129f58d46d40981d4bc"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aeb593b92570991acbd20ecba45ef89bc"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_parcel.html">IParcel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#aeb593b92570991acbd20ecba45ef89bc">QueryTextParcelAtPoint</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *view, const <a class="el" href="struct_sys_point.html">SysPoint</a> mousePt, const <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *hitObj, const <a class="el" href="class_i_parcel.html">IParcel</a> *previousParcel, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, <a class="el" href="class_range_data.html">RangeData</a> &amp;range, <a class="el" href="class_p_m_real.html">PMReal</a> *hitIndex=nil, <a class="el" href="class_p_m_real.html">PMReal</a> *adjustedHitIndex=nil)=0</td></tr><tr class="separator:aeb593b92570991acbd20ecba45ef89bc"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a01b6ecd10fb432e598fb5d3ef0413ef0"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#a01b6ecd10fb432e598fb5d3ef0413ef0">DrawCaretAtDropLocation</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *view, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, <a class="el" href="class_range_data.html">RangeData</a> &amp;range, bool16 flushDrawing=kTrue)=0</td></tr><tr class="separator:a01b6ecd10fb432e598fb5d3ef0413ef0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa567488b5d0446adf47fb07be5ab41d7"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#aa567488b5d0446adf47fb07be5ab41d7">ProcessDragDropTextCommand</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *view, <a class="el" href="class_i_drag_drop_controller.html">IDragDropController</a> *controller, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, <a class="el" href="class_range_data.html">RangeData</a> &amp;range, <a class="el" href="class_drag_drop.html#a100099f315d5a67434a86215fa6fb46d">DragDrop::eCommandType</a> type, bool16 ignoreAttributes=kFalse)=0</td></tr><tr class="separator:aa567488b5d0446adf47fb07be5ab41d7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a481dac6a336ca9054806045e91a1cbc6"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#a481dac6a336ca9054806045e91a1cbc6">PrepareForTextFrameDrop</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *view, <a class="el" href="class_i_drag_drop_controller.html">IDragDropController</a> *controller, <a class="el" href="class_p_m_point.html">PMPoint</a> &amp;dropPoint, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;parent)=0</td></tr><tr class="separator:a481dac6a336ca9054806045e91a1cbc6"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a78fcd1b2a6403480d76fafbe9ee2197d"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#a78fcd1b2a6403480d76fafbe9ee2197d">MakeFrame</a> (const <a class="el" href="class_p_m_point.html">PBPMPoint</a> &amp;location, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;parent, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyUIDRef, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;createdFrame)=0</td></tr><tr class="separator:a78fcd1b2a6403480d76fafbe9ee2197d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab5c5b4cf7eae53972a92e4f9ffdc0239"><td align="right" class="memItemLeft" valign="top">virtual ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#ab5c5b4cf7eae53972a92e4f9ffdc0239">SendDragDropTextSignal</a> (<a class="el" href="class_i_d_type.html">ServiceID</a> id, <a class="el" href="class_i_control_view.html">IControlView</a> *sourceView, <a class="el" href="class_i_control_view.html">IControlView</a> *destinationView, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;sourceStoryRef, <a class="el" href="class_range_data.html">RangeData</a> &amp;sourceRange, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;destinationStoryRef, <a class="el" href="class_range_data.html">RangeData</a> &amp;destinationRange, <a class="el" href="class_range_data.html">RangeData</a> &amp;droppedRange, <a class="el" href="class_drag_drop.html#a100099f315d5a67434a86215fa6fb46d">DragDrop::eCommandType</a> type, <a class="el" href="class_i_data_exchange_handler.html">IDataExchangeHandler</a> *handler)=0</td></tr><tr class="separator:ab5c5b4cf7eae53972a92e4f9ffdc0239"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aad683bb384dd73d30398b75bfeecf2e0"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_command.html">ICommand</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_drag_drop_text_utils.html#aad683bb384dd73d30398b75bfeecf2e0">MakeNewTextFrameCmdForDrop</a> (<a class="el" href="class_i_layout_control_data.html">ILayoutControlData</a> *layoutData, <a class="el" href="class_i_data_exchange_handler.html">IDataExchangeHandler</a> *texthandler, const bool16 ignoreAttributes)=0</td></tr><tr class="separator:aad683bb384dd73d30398b75bfeecf2e0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>Utilities for use for dealing with drag and drop of text. </div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a01b6ecd10fb432e598fb5d3ef0413ef0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IDragDropTextUtils::DrawCaretAtDropLocation </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>range</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>flushDrawing</em> = <code>kTrue</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Use the range data (length of 0) to draw a caret at the story position in order to give user feedback about drop location. <dl class="section see"><dt>See Also<dd><a class="el" href="class_i_drag_drop_text_utils.html#aeb593b92570991acbd20ecba45ef89bc">QueryTextParcelAtPoint</a>. </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">view</td><td>IN pointer to the control view under the mouse </td></tr><tr><td class="paramname">storyUIDRef</td><td>IN Reference to the story containing the <a class="el" href="class_range_data.html">RangeData</a></td></tr><tr><td class="paramname">range</td><td>IN text range at drop location (length of 0) </td></tr><tr><td class="paramname">flushDrawing</td><td>IN whether to force flush the drawing </td></tr></table></dl></div></div><a class="anchor" id="a78fcd1b2a6403480d76fafbe9ee2197d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IDragDropTextUtils::MakeFrame </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_point.html">PBPMPoint</a> &amp;&nbsp;</td><td class="paramname"><em>location</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>parent</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>createdFrame</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Process command to create a new text frame or frame grid based on the passed in storyUIDRef parameter. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">location</td><td>Where the text frame should be created, in pasteboard coordinates. </td></tr><tr><td class="paramname">parent</td><td>Where in the hierarchy to put the text frame (typically a spread layer) </td></tr><tr><td class="paramname">storyUIDRef</td><td>The source story uid ref (may be kInvalidUIDRef) </td></tr><tr><td class="paramname">createdFrame</td><td>OUT parameter. The created text frame or frame grid based on the passed in storyUIDRef parameter) and it could be UIDRef(nil, kInvalidUID) if we fail to create. </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_command.html">ICommand</a> The command to create the text frame (<a class="el" href="classk_create_multi_column_item_cmd_boss.html">kCreateMultiColumnItemCmdBoss</a>). </dl></div></div><a class="anchor" id="aad683bb384dd73d30398b75bfeecf2e0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_command.html">ICommand</a>* IDragDropTextUtils::MakeNewTextFrameCmdForDrop </td><td>(</td><td class="paramtype"><a class="el" href="class_i_layout_control_data.html">ILayoutControlData</a> *&nbsp;</td><td class="paramname"><em>layoutData</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_data_exchange_handler.html">IDataExchangeHandler</a> *&nbsp;</td><td class="paramname"><em>texthandler</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const bool16&nbsp;</td><td class="paramname"><em>ignoreAttributes</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Create a new-text-frame command, to hold raw text dragged onto a layout. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">layoutData</td><td>IN Pointer to <a class="el" href="class_i_layout_control_data.html">ILayoutControlData</a> for layout view. </td></tr><tr><td class="paramname">texthandler</td><td>IN <a class="el" href="class_i_data_exchange_handler.html">IDataExchangeHandler</a> for the drop. </td></tr><tr><td class="paramname">ignoreAttributes</td><td>IN Ignore the attributes of the source. </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_command.html">ICommand</a> pointer for the command. </dl></div></div><a class="anchor" id="a481dac6a336ca9054806045e91a1cbc6"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IDragDropTextUtils::PrepareForTextFrameDrop </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_drag_drop_controller.html">IDragDropController</a> *&nbsp;</td><td class="paramname"><em>controller</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_point.html">PMPoint</a> &amp;&nbsp;</td><td class="paramname"><em>dropPoint</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>parent</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Check to see if we can create a text frame at this location (checks for locked layers). <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">view</td><td>IN What view to drop in. </td></tr><tr><td class="paramname">controller</td><td>IN The drag and drop controller </td></tr><tr><td class="paramname">dropPoint</td><td>OUT The dropped point from the controller </td></tr><tr><td class="paramname">parent</td><td>OUT Where in the hierarchy to put the text frame (typically a spread layer). </td></tr></table></dl><dl class="section return"><dt>Returns<dd>kSuccess if you can create a text frame in this view, an error code otherwise </dl></div></div><a class="anchor" id="aa567488b5d0446adf47fb07be5ab41d7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IDragDropTextUtils::ProcessDragDropTextCommand </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_drag_drop_controller.html">IDragDropController</a> *&nbsp;</td><td class="paramname"><em>controller</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>range</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_drag_drop.html#a100099f315d5a67434a86215fa6fb46d">DragDrop::eCommandType</a>&nbsp;</td><td class="paramname"><em>type</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>ignoreAttributes</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Process commands to do text drag and drop. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">view</td><td>IN the control view for the drop (may be nil, used to bring window to front) </td></tr><tr><td class="paramname">controller</td><td>IN the drag and drop controller </td></tr><tr><td class="paramname">storyUIDRef</td><td>IN Reference to the story to drop into (the destination) </td></tr><tr><td class="paramname">range</td><td>IN text range at hit location (length of 0) (the destination) </td></tr><tr><td class="paramname">type</td><td>IN an enum of type <a class="el" href="class_drag_drop.html#a100099f315d5a67434a86215fa6fb46d">DragDrop::eCommandType</a>. kDragMove for moving text, otherwise use kDrop to copy. </td></tr><tr><td class="paramname">ignoreAttributes</td><td>IN Ignore the attributes on drop, default to kFalse </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode the result of processing the drag and drop command operation. </dl></div></div><a class="anchor" id="aeb593b92570991acbd20ecba45ef89bc"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_parcel.html">IParcel</a>* IDragDropTextUtils::QueryTextParcelAtPoint </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="struct_sys_point.html">SysPoint</a>&nbsp;</td><td class="paramname"><em>mousePt</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>hitObj</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_parcel.html">IParcel</a> *&nbsp;</td><td class="paramname"><em>previousParcel</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>range</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a> *&nbsp;</td><td class="paramname"><em>hitIndex</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a> *&nbsp;</td><td class="paramname"><em>adjustedHitIndex</em> = <code>nil</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Utility method that encapsulates using the target object (hitObj) and uses its <a class="el" href="class_i_drag_drop_text_helper.html">IDragDropTextHelper</a> interface to return a parcel, story ref, and text range at the hit moust point. <dl class="section see"><dt>See Also<dd>QueryParcelFromHitObject <dd> QueryStoryThreadFromHitObject <dd> HitTestStoryThread <dd> AdjustRangeFromHitTest </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">view</td><td>IN pointer to the control view under the mouse </td></tr><tr><td class="paramname">mousePt</td><td>IN location of current mouse position </td></tr><tr><td class="paramname">hitObj</td><td>IN an <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> pointer from a frame from hittesting at the mousePt. May be nil. </td></tr><tr><td class="paramname">previousParcel</td><td>IN an <a class="el" href="class_i_parcel.html">IParcel</a> interface from a possible previous hit. May be nil, and will be nil initially. </td></tr><tr><td class="paramname">storyUIDRef</td><td>OUT Reference to the story containing the returned <a class="el" href="class_range_data.html">RangeData</a>. kInvalidUIDRef if no hit. </td></tr><tr><td class="paramname">range</td><td>OUT The hit range (length of 0). This is a model range. </td></tr><tr><td class="paramname">hitIndex</td><td>OUT the model text index that was hit, may be nil. </td></tr><tr><td class="paramname">adjustedHitIndex</td><td>OUT the adjusted model text index (rounded). May be nil. </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_i_parcel.html">IParcel</a> Return a parcel at the passed in point. May return nil and still be considered a hit (so storyUIDRef and range would still be filled in for return). Defaults to kTrue. </dl></div></div><a class="anchor" id="ab5c5b4cf7eae53972a92e4f9ffdc0239"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual ErrorCode IDragDropTextUtils::SendDragDropTextSignal </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_type.html">ServiceID</a>&nbsp;</td><td class="paramname"><em>id</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>sourceView</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>destinationView</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>sourceStoryRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>sourceRange</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>destinationStoryRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>destinationRange</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_range_data.html">RangeData</a> &amp;&nbsp;</td><td class="paramname"><em>droppedRange</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_drag_drop.html#a100099f315d5a67434a86215fa6fb46d">DragDrop::eCommandType</a>&nbsp;</td><td class="paramname"><em>type</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_data_exchange_handler.html">IDataExchangeHandler</a> *&nbsp;</td><td class="paramname"><em>handler</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Signal all drag drop text responders that a drag text event has just occurred. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">id,a</td><td>service id for what signal is being sent. Must be one of: kBeforeDragTextSignalResponderService - Just before we add text drag content to drag controller. Responder may want to adjust source range (e.g. a partially selected hyperlink). Responder may set global error code to display an alert. kBeforeDropTextSignalResponderService - Just before we create a command to do the drag/drop operation. Responder may set global error code (e.g. some kind of illegal drop that will display an error alert). kAfterDropTextSignalResponderService - Just after the drag/drop command has executed. Responder may want to do extra adjustment (e.g. smart cut/paste to insert/delete extra spaces) </td></tr><tr><td class="paramname">sourceView</td><td>IN pointer to the control view for the source for drag/drop operation. </td></tr><tr><td class="paramname">destinationView</td><td>IN pointer to the control view for the destination for drag/drop operation. May be same as source. May be nil for kBeforeDropTextSignalResponderService signal. </td></tr><tr><td class="paramname">sourceStoryRef</td><td>IN the source story that is being dragged. </td></tr><tr><td class="paramname">sourceRange</td><td>IN/OUT the source text range that is being dragged. May be modified by responder, and may even have zero length after the drop. </td></tr><tr><td class="paramname">destinationStoryRef</td><td>IN the destination story that is being dropped. Will be kInvalidUIDRef for kBeforeDragTextSignalResponderService signal. </td></tr><tr><td class="paramname">destinationRange</td><td>IN/OUT the destination range for the caret drop location (length of zero) that is being dropped. Will be RangeData(0,0,RangeData::kLeanForward)) for kBeforeDragTextSignalResponderService signal. May be modified by responder. </td></tr><tr><td class="paramname">droppedRange</td><td>IN/OUT the dropped range for the drag and drop operation. Will be the length of the sourceRange. This range is used to select the text after the drop. May be modified by responder. </td></tr><tr><td class="paramname">handler</td><td>IN the data exchange handler used for the text drag drop operation. Gives responders a place to access stored data. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>error code returned by the responders. First error will terminate the rest of the responders, abort the drag/drop operation. Note: An alert will be displayed (if there is a string corresponding to the error code). </dl></div></div><a class="anchor" id="ab6c7ddcca910e129f58d46d40981d4bc"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IDragDropTextUtils::StartTextDrag </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_drag_drop_source.html">IDragDropSource</a> *&nbsp;</td><td class="paramname"><em>dragSource</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_event.html">IEvent</a> *&nbsp;</td><td class="paramname"><em>theEvent</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Description: Try to start up a text drag operation with the given view, drag drop source, and event. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">view</td><td>IN pointer to the control view under the mouse </td></tr><tr><td class="paramname">dragSource</td><td>IN the drag source to ask if it WillDrag </td></tr><tr><td class="paramname">theEvent</td><td>IN the event that initiated this query. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>bool16 kTrue / kFalse. If returns kTrue, need to return true from tracker or event handler. Drag has been started. Returns kFalse if drag has not be started up. </dl></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_drag_drop_text_utils.html">IDragDropTextUtils</a><li class="footer">Generated on Sat Sep 22 2018 10:54:10 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
