<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_inval_handler</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_inval_handler.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_inval_handler-members.html">List of all members</a></div><div class="headertitle"><div class="title">IInvalHandler Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_inval_handler_8h_source.html">IInvalHandler.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IInvalHandler:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_inval_handler.png" usemap="#IInvalHandler_map" /><map id="IInvalHandler_map" name="IInvalHandler_map"><area alt="GTTxtEdtInvalHandler" coords="0,56,134,80" href="class_g_t_txt_edt_inval_handler.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a1cfdebee751a72899a025dc5a98a64a3"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IINVALHANDLER }</td></tr><tr class="separator:a1cfdebee751a72899a025dc5a98a64a3"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a920ba154aafffdd12518c73998d6dcf4"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#a920ba154aafffdd12518c73998d6dcf4">IInvalHandler</a> ()</td></tr><tr class="separator:a920ba154aafffdd12518c73998d6dcf4"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af1d30b3427642ea1dea64896a44f0970"><td align="right" class="memItemLeft" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#af1d30b3427642ea1dea64896a44f0970">~IInvalHandler</a> ()</td></tr><tr class="separator:af1d30b3427642ea1dea64896a44f0970"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a82f5374485ae494dd77aab7b7a5a3115"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_inval_cookie.html">IInvalCookie</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#a82f5374485ae494dd77aab7b7a5a3115">EndCollectingInvals</a> ()=0</td></tr><tr class="separator:a82f5374485ae494dd77aab7b7a5a3115"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a1e5113c4d0ea3341207b9828b6f1a5e3"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_d_type.html">InvalHandlerID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#a1e5113c4d0ea3341207b9828b6f1a5e3">GetID</a> () const =0</td></tr><tr class="separator:a1e5113c4d0ea3341207b9828b6f1a5e3"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa590b18bcc2e8b1c4002de0f530fb855"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#aa590b18bcc2e8b1c4002de0f530fb855">BeforeRevert_InvalAll</a> ()=0</td></tr><tr class="separator:aa590b18bcc2e8b1c4002de0f530fb855"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad125f3c106217236a39d66e68929dee2"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_inval_handler.html#ad125f3c106217236a39d66e68929dee2">AfterRevert_InvalAll</a> ()=0</td></tr><tr class="separator:ad125f3c106217236a39d66e68929dee2"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>An inval handler is responsible for monitoring changes to a particular &#39;topic&#39; in the database during an undoable database transaction and scheduling changes (invals) to the topic of interest to occur at undo and redo time.<p>Inval handlers are used to force updates (invals) at undo and redo that cannot be forced by restoring the state of interfaces (via snapshotting). Also inval handlers should be used where ever invals cannot be delayed at undo and redo (and therefore lazy notifications cannot help).<p>For example, consider an observer that attaches to a spread (see <a class="el" href="classk_spread_boss.html">kSpreadBoss</a>). When a spread is created, the observer gets attached to the new spread. If the creation of the spread is undone this observer must be detached before the undo takes place. If the creation of the spread is redone the observer must be re-attached after the redo takes place. Inval handlers allow for this.<p>In order for an inval handler to get notified from the database regarding undoable transactions it must be attached to the database using <a class="el" href="class_d_b_utils.html#ae249e149f270864b6168c3a0963cb19e">DBUtils::AttachInvalHandler</a> which takes an inval handler id. <a class="el" href="class_d_b_utils.html#a07bc0f662e354685fd8b7c5935c85bf4">DBUtils::DetachInvalHandler</a> detaches the inval handler from the database. <a class="el" href="class_d_b_utils.html#a1a61c18625a448953cf1ec834a01cc84">DBUtils::GetInvalHandler</a> looks up the first inval handler attached to the database with a specific inval handler type id.<p>When an inval handler is attached to a database it can be in one of two states: &quot;collecting invals&quot; or &quot;not collection invals&quot;. Its intial state is &quot;not collecting invals&quot;. When in &quot;not collecting invals&quot;, if a change to the topic of interest takes place, in order to switch to &quot;collecting invals&quot;, the inval handler must call <a class="el" href="class_d_b_utils.html#a7c40a2bc700e1a6eaf87cb3935460e34">DBUtils::StartCollectingInvals</a>. This call returns kTrue if there is an ongoing undoable transaction in the database and kFalse otherwise (e.g. we are in the middle of undoing). If this call returns kTrue, the inval handler switches to &quot;collecting invals&quot; otherwise it remains in &quot;not collection invals&quot;.<p>While in &quot;collecting invals&quot;, the inval handler keeps collecting information about subsequent changes to the topic until the undoable transaction ends. At end of transaction, the inval handler is notified by the database via its EndCollectingInvals function. At this point the inval handler switches back to &quot;not collection invals&quot;.<p>It must be clear that using this scheme, changes to the inval handler&#39;s topic that occur outside of an undoable transaction never get tracked down. Those that occur inside an undoable transaction do.<p>The next subject of discussion is inval cookies. An inval cookie is an object that implements a set of changes (invals) that occur at undo and redo. At end of collecting of invals, the inval handler must generate a inval cookie that implements the changes that it wants operated at undo and redo. The implementation of EndCollectingInvals is the vehicle for constructing the cookie and handing it back to the database.<p>The inval cookie generated by the inval handler is kept in the change history of the database. When the transaction is undone or redone, the inval cookie is invoked to perform the changes that the inval handler had scheduled to occur at undo and redo when it created the cookie.<dl class="section see"><dt>See Also<dd><a class="el" href="class_d_b_utils.html#ae249e149f270864b6168c3a0963cb19e">DBUtils::AttachInvalHandler</a><dd><a class="el" href="class_d_b_utils.html#a7c40a2bc700e1a6eaf87cb3935460e34">DBUtils::StartCollectingInvals</a><dd><a class="el" href="class_i_inval_cookie.html">IInvalCookie</a><dd><a class="el" href="class_d_b_utils.html#a07bc0f662e354685fd8b7c5935c85bf4">DBUtils::DetachInvalHandler</a></dl></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2><a class="anchor" id="a920ba154aafffdd12518c73998d6dcf4"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">IInvalHandler::IInvalHandler </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Constructor. </div></div><a class="anchor" id="af1d30b3427642ea1dea64896a44f0970"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual IInvalHandler::~IInvalHandler </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span></td></tr></table></div><div class="memdoc"><p>Virtual destructor. </div></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="ad125f3c106217236a39d66e68929dee2"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IInvalHandler::AfterRevert_InvalAll </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Invalidate all after undo/redo; see <a class="el" href="class_i_inval_handler.html#aa590b18bcc2e8b1c4002de0f530fb855">IInvalHandler::BeforeRevert_InvalAll</a> for further documentation. <p>Implemented in <a class="el" href="class_g_t_txt_edt_inval_handler.html#a7321a8ab66664fbb942eea9b35c4faca">GTTxtEdtInvalHandler</a>.</div></div><a class="anchor" id="aa590b18bcc2e8b1c4002de0f530fb855"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IInvalHandler::BeforeRevert_InvalAll </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Invalidate all before undo/redo; called by the database at undo and redo of a transaction that took place before the inval handler was attached.<p>It can happen that the inval handler gets attached by the client after changes to the topic of interest have already been made in one or more undoable transactions. Because of this late attachment, no inval cookies were generated for these transactions. Never the less, the database gives the inval handler a chance to force invals to occur at undo and redo of these transactions (and all other transactions that occurred before the attachment of the inval handler). Typically, the inval handler has to invalidate &quot;all&quot; because it has no trace of what happened during the undoable transaction. <p>Implemented in <a class="el" href="class_g_t_txt_edt_inval_handler.html#a0b46cad2fb956589fe261d110f25172b">GTTxtEdtInvalHandler</a>.</div></div><a class="anchor" id="a82f5374485ae494dd77aab7b7a5a3115"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_inval_cookie.html">IInvalCookie</a>* IInvalHandler::EndCollectingInvals </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Called by the database at end of undoable transaction if the the inval handler is currently collecting invals.<p>At end of collecting of invals, the inval handler creates an inval cookie that implements the changes required at undo and redo. EndCollectingInvals is the vehicle for constructing the cookie and handing it back to the database which stores the cookie in its change history.<p>THE DATABASE WILL TAKE OWNERSHIP OF THE INVAL COOKIE. Therefore, the inval handler should not keep any reference to this inval cookie after returning from this function.<dl class="section return"><dt>Returns<dd>inval cookie instance to be called at undo and redo </dl><p>Implemented in <a class="el" href="class_g_t_txt_edt_inval_handler.html#aacad1e716efaddf193f56be2e40cf809">GTTxtEdtInvalHandler</a>.</div></div><a class="anchor" id="a1e5113c4d0ea3341207b9828b6f1a5e3"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_d_type.html">InvalHandlerID</a> IInvalHandler::GetID </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the ID of the inval handler type. Each inval handler type has a unique ID keyed from the plug-in prefix. We allow multiple instances of inval handlers with the same ID to be attached to a database. <dl class="section return"><dt>Returns<dd>InvalHandlerID </dl><p>Implemented in <a class="el" href="class_g_t_txt_edt_inval_handler.html#ac316bf3b0896127696c6b761b05df038">GTTxtEdtInvalHandler</a>.</div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_inval_handler.html">IInvalHandler</a><li class="footer">Generated on Sat Sep 22 2018 10:54:18 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
