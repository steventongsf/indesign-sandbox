<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_error_string_service</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_error_string_service.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_error_string_service-members.html">List of all members</a></div><div class="headertitle"><div class="title">IErrorStringService Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_error_string_service_8h_source.html">IErrorStringService.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IErrorStringService:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_error_string_service.png" usemap="#IErrorStringService_map" /><map id="IErrorStringService_map" name="IErrorStringService_map"><area alt="IPMUnknown" coords="0,0,225,24" href="class_i_p_m_unknown.html" shape="rect" /><area alt="CPMUnknown&lt; IErrorStringService &gt;" coords="0,112,225,136" href="class_c_p_m_unknown.html" shape="rect" /><area alt="CErrorStringService" coords="0,168,225,192" href="class_c_error_string_service.html" shape="rect" /><area alt="BPIErrorStringService" coords="235,224,460,248" href="class_b_p_i_error_string_service.html" shape="rect" /><area alt="BscShpErrorStringService" coords="235,280,460,304" href="class_bsc_shp_error_string_service.html" shape="rect" /><area alt="BscTAErrorStringService" coords="235,336,460,360" href="class_bsc_t_a_error_string_service.html" shape="rect" /><area alt="CdlChartErrorStringService" coords="235,392,460,416" href="class_cdl_chart_error_string_service.html" shape="rect" /><area alt="CHLErrorStringService" coords="235,448,460,472" href="class_c_h_l_error_string_service.html" shape="rect" /><area alt="DataUpdaterErrorStringService" coords="235,504,460,528" href="class_data_updater_error_string_service.html" shape="rect" /><area alt="FrmLblErrorStringService" coords="235,560,460,584" href="class_frm_lbl_error_string_service.html" shape="rect" /><area alt="PnlTrvErrorStringService" coords="235,616,460,640" href="class_pnl_trv_error_string_service.html" shape="rect" /><area alt="PstLstErrorStringService" coords="235,672,460,696" href="class_pst_lst_error_string_service.html" shape="rect" /><area alt="SnapErrorStringService" coords="235,728,460,752" href="class_snap_error_string_service.html" shape="rect" /><area alt="SnipRunErrorStringService" coords="235,784,460,808" href="class_snip_run_error_string_service.html" shape="rect" /><area alt="TranFxErrorStringService" coords="235,840,460,864" href="class_tran_fx_error_string_service.html" shape="rect" /><area alt="XCatHndErrorStringService" coords="235,896,460,920" href="class_x_cat_hnd_error_string_service.html" shape="rect" /><area alt="XDocBkErrorStringService" coords="235,952,460,976" href="class_x_doc_bk_error_string_service.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a15e11951eb920b738e7a9eddc9e28073"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IERRORSTRINGSERVICE }</td></tr><tr class="separator:a15e11951eb920b738e7a9eddc9e28073"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:ac8224495e1eea47fc5833dfc6228d82e"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_error_string_service.html#ac8224495e1eea47fc5833dfc6228d82e">HasUserErrorString</a> (ErrorCode errCode, <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *errInfo) const =0</td></tr><tr class="separator:ac8224495e1eea47fc5833dfc6228d82e"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad610f86ca6268acc8657df825889176b"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_error_string_service.html#ad610f86ca6268acc8657df825889176b">GetUserErrorString</a> (ErrorCode errCode, <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *errInfo) const =0</td></tr><tr class="separator:ad610f86ca6268acc8657df825889176b"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><pre class="fragment">Interface which translates error codes based on the developer prefix of a plugin

into error strings (and for later versions a detailed error description).



This class is the hook for any plug-in that wishes to have a resource-based mapping

between error codes and error strings.



Here&#39;s how you would set up the mapping. First, define a boss in your plug-in that

provides an error string service, for instance:



&lt;pre&gt;

</pre><p> Class { kFooErrorStringServiceBoss, kInvalidClass, { IID_IK2SERVICEPROVIDER, kErrorStringProviderImpl, IID_IERRORSTRINGSERVICE, kFooErrorStringServiceImpl, } } <p>Then you need to provide an implementation of the error string service interface. Here&#39;s an example of what that might look like:<pre>

#include &quot;CErrorStringService.h&quot;</pre><pre>class FooErrorStringService : public <a class="el" href="class_c_error_string_service.html">CErrorStringService</a>

{

public:

    FooErrorStringService(IPMUnknown * boss) :

    : CErrorStringService(boss, kFooPluginID, kFooErrorStringTableRsrcID)

};</pre><pre>    </pre><p>Then you need to define the error codes that you want to map to error strings in your ID.h file. For instance: <pre>

</pre> <pre class="fragment">Lastly, you need to have a UserErrorTable resource that provides the

mapping between an error code and its associated string:



&lt;pre&gt;

</pre><p> resource UserErrorTable( kFooErrorStringTableRsrcID ) { { err // error string kFooAwfulHorribleError, &quot;Oh No! Something awful has happened!&quot;, kFooEvenWorseError, &quot;Oh Dear! Please don&#39;t do that&quot;, } }; <p>Note that the string provided in the UserErrorTable is not localized. To localize it, you can provide a localization in the localized string files, then it will be automatically translated for the current language.<p>Once you&#39;ve done all this, then when you set the error code (see <a class="el" href="class_error_utils.html#ae603b63520be78e0d9875cc99e9bfeca">ErrorUtils::PMSetGlobalErrorCode</a>), you can skip passing a string along, but when you (or anyone else) later request the string, it will be there. The advantage to this is if you set the error code the same way in multiple places, you insure that the error string will be the same no matter where it gets set from.<dl class="section see"><dt>See Also<dd><a class="el" href="class_i_k2_service_provider.html">IK2ServiceProvider</a>, <a class="el" href="class_c_error_string_service.html">CErrorStringService</a>, <a class="el" href="class_error_utils.html">ErrorUtils</a></dl></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="ad610f86ca6268acc8657df825889176b"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_p_m_string.html">PMString</a> IErrorStringService::GetUserErrorString </td><td>(</td><td class="paramtype">ErrorCode&nbsp;</td><td class="paramname"><em>errCode</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>errInfo</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Return the string associated with the error code. If there isn&#39;t one return an empty string. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">errCode</td><td>the error code we&#39;re looking up </td></tr><tr><td class="paramname">errInfo</td><td>whatever errInfo is currently in the error state </td></tr></table></dl><dl class="section return"><dt>Returns<dd><a class="el" href="class_p_m_string.html">PMString</a> the user string for errCode, kFalse otherwise </dl><p>Implemented in <a class="el" href="class_c_error_string_service.html#a7988df44a80a5d752789e4bb3adf181b">CErrorStringService</a>.</div></div><a class="anchor" id="ac8224495e1eea47fc5833dfc6228d82e"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IErrorStringService::HasUserErrorString </td><td>(</td><td class="paramtype">ErrorCode&nbsp;</td><td class="paramname"><em>errCode</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>errInfo</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>See if the service provider has a string for errCode. When searching for an error string, the application may iterate over all the services asking for a string. A quick check to see if it is even your prefix is advised. It could be that it is your error, yet you don&#39;t have a string for it, then return kFalse. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">errCode</td><td>the error code we&#39;re looking up </td></tr><tr><td class="paramname">errInfo</td><td>whatever errInfo is currently in the error state </td></tr></table></dl><dl class="section return"><dt>Returns<dd>kTrue if the service supplies a string for errCode, kFalse otherwise </dl><p>Implemented in <a class="el" href="class_c_error_string_service.html#a1ec582a8dc4bdd6aba5615c1081b890d">CErrorStringService</a>.</div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_error_string_service.html">IErrorStringService</a><li class="footer">Generated on Sat Sep 22 2018 10:54:13 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
