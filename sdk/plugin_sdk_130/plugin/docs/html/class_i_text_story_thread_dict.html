<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_text_story_thread_dict</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_text_story_thread_dict.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_text_story_thread_dict-members.html">List of all members</a></div><div class="headertitle"><div class="title">ITextStoryThreadDict Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_text_story_thread_dict_8h_source.html">ITextStoryThreadDict.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for ITextStoryThreadDict:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_text_story_thread_dict.png" usemap="#ITextStoryThreadDict_map" /><map id="ITextStoryThreadDict_map" name="ITextStoryThreadDict_map"><area alt="IPMUnknown" coords="0,0,233,24" href="class_i_p_m_unknown.html" shape="rect" /><area alt="CPMUnknown&lt; ITextStoryThreadDict &gt;" coords="0,112,233,136" href="class_c_p_m_unknown.html" shape="rect" /><area alt="HidTxtStoryThreadDict" coords="0,168,233,192" href="class_hid_txt_story_thread_dict.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a8977e5f927558be428c9eec4e649f223"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_ITEXTSTORYTHREADDICT }</td></tr><tr class="separator:a8977e5f927558be428c9eec4e649f223"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a22798fb2c90de956d2463a359e8ce748"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_text_story_thread_dict.html#a22798fb2c90de956d2463a359e8ce748">QueryThread</a> (uint32 key) const =0</td></tr><tr class="separator:a22798fb2c90de956d2463a359e8ce748"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a114c37e7422c2b13df37c3bc2cbee372"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_text_1_1_story_range.html">Text::StoryRange</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_text_story_thread_dict.html#a114c37e7422c2b13df37c3bc2cbee372">GetAnchorTextRange</a> (bool16 *wasAnchored=nil) const =0</td></tr><tr class="separator:a114c37e7422c2b13df37c3bc2cbee372"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a7e98d554f6f3b5fd59ecc94cfc5c8a5a"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_text_1_1_story_range.html">Text::StoryRange</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_text_story_thread_dict.html#a7e98d554f6f3b5fd59ecc94cfc5c8a5a">GetThreadBlockTextRange</a> () const =0</td></tr><tr class="separator:a7e98d554f6f3b5fd59ecc94cfc5c8a5a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9bf2636b8a0ac6d703d57dde9f900999"><td align="right" class="memItemLeft" valign="top">virtual uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_text_story_thread_dict.html#a9bf2636b8a0ac6d703d57dde9f900999">GetFirstKey</a> ()=0</td></tr><tr class="separator:a9bf2636b8a0ac6d703d57dde9f900999"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab5b7fd4316ba0357f576e07f6c9bc992"><td align="right" class="memItemLeft" valign="top">virtual uint32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_text_story_thread_dict.html#ab5b7fd4316ba0357f576e07f6c9bc992">GetNextKey</a> ()=0</td></tr><tr class="separator:ab5b7fd4316ba0357f576e07f6c9bc992"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>The <a class="el" href="class_i_text_story_thread_dict.html">ITextStoryThreadDict</a> is responsible for managing one or more ITextStoryThreads within a given <a class="el" href="class_i_text_model.html">ITextModel</a>. All the ITextStoryThreads managed by a single dictionary are stored contiguously within the <a class="el" href="class_i_text_model.html">ITextModel</a>.<p>All ITextStoryThreads managed in this way share the same dictionar (see <a class="el" href="class_i_text_story_thread.html#a39b8cdaaad70477159b65dbeae59c700">ITextStoryThread::GetDictUID()</a>) but are uniquely identified within the managing dictionary by a uint32 whose mapping is defined only the dictionary.<p>The key value is expected to be the same throughout the life of the <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a>. The addition or removal of other ITextStoryThreads in the same dictionary must change the keys of the remaining ITextStoryThreads.<p>A <a class="el" href="class_i_text_story_thread_dict.html">ITextStoryThreadDict</a> can be anchored or not. Examples of dictionaries which are anchored are Notes, Tables and Footnotes. Examples of unanchored dictionaries are Text Macros. All unanchored dictionaries should return an anchor position of the last carriage return of the primary story thread.<p>Every <a class="el" href="class_i_text_model.html">ITextModel</a> boss implements an <a class="el" href="class_i_text_story_thread_dict.html">ITextStoryThreadDict</a> which is responsible for managing the primary story thread. This dictionary is not anchored with its thread block text range starting at zero and ending at the end of the primary story thread. Unlike all other unanchored dictionaries, this dictionary returns an anchor position of zero.<p>The location of the dictionary&#39;s thread block is determined by the location of the dictionary&#39;s anchor relative to other dictionaries in the same and other thread blocks. Determining this relative location is the job of the <a class="el" href="class_i_text_story_thread_dict_hier.html">ITextStoryThreadDictHier</a>.<dl class="section see"><dt>See Also<dd><a class="el" href="class_i_text_story_thread_dict_hier.html">ITextStoryThreadDictHier</a><dd><a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a><dd><a class="el" href="class_i_text_model.html">ITextModel</a></dl></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a114c37e7422c2b13df37c3bc2cbee372"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_text_1_1_story_range.html">Text::StoryRange</a> ITextStoryThreadDict::GetAnchorTextRange </td><td>(</td><td class="paramtype">bool16 *&nbsp;</td><td class="paramname"><em>wasAnchored</em> = <code>nil</code></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the current StoryRange where the dictionary is anchored into the <a class="el" href="class_i_text_model.html">ITextModel</a>. Implementations that are not anchored should return the TextIndex of the last carriage return in the primary story thread. The <a class="el" href="class_i_text_model.html">ITextModel</a>, which implements the primary story thread, will return an anchor position of zero. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">wasAnchored</td><td>Optional parameter which will be set to kTrue if the dictionary is anchored, kFalse otherwise. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>StoryRange where the dictionary is anchored in the <a class="el" href="class_i_text_model.html">ITextModel</a>. </dl><p>Implemented in <a class="el" href="class_hid_txt_story_thread_dict.html#a8b41f2f36f2810b319603852c8855753">HidTxtStoryThreadDict</a>.</div></div><a class="anchor" id="a9bf2636b8a0ac6d703d57dde9f900999"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual uint32 ITextStoryThreadDict::GetFirstKey </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>When whole ITextStoryThreads are pasted into the <a class="el" href="class_i_text_model.html">ITextModel</a> the StoryThread <a class="el" href="class_strand.html">Strand</a> provides a hook to allow these ITextStoryThreads to switch owners. This occurs, for example, if the ITextStoryThreads from one table were deleted and pasted into a different table. The assumption is that the manager of this operation will ensure that reference conversion occurs on the UIDs in the ITextStoryThreads but there is no way to fix up the Keys. The iteration that is implied by this operation is setup by the code managing the copy and the StoryThread <a class="el" href="class_strand.html">Strand</a> will call <a class="el" href="class_i_text_story_thread_dict.html#a9bf2636b8a0ac6d703d57dde9f900999">GetFirstKey()</a> on the first <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a> pasted and then will call <a class="el" href="class_i_text_story_thread_dict.html#ab5b7fd4316ba0357f576e07f6c9bc992">GetNextKey()</a> repeatedly for each remaining <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a> copied. <dl class="section return"><dt>Returns<dd>The first key for the converting range. </dl><p>Implemented in <a class="el" href="class_hid_txt_story_thread_dict.html#a92d9a59bd5aeb46fda0d5e9c7266c8fd">HidTxtStoryThreadDict</a>.</div></div><a class="anchor" id="ab5b7fd4316ba0357f576e07f6c9bc992"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual uint32 ITextStoryThreadDict::GetNextKey </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the next key during the paste operation. <dl class="section return"><dt>Returns<dd>The first key for the converting range. </dl><p>Implemented in <a class="el" href="class_hid_txt_story_thread_dict.html#a8078493f85ac69073cefdac179e27d93">HidTxtStoryThreadDict</a>.</div></div><a class="anchor" id="a7e98d554f6f3b5fd59ecc94cfc5c8a5a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_text_1_1_story_range.html">Text::StoryRange</a> ITextStoryThreadDict::GetThreadBlockTextRange </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the current StoryRange where the dictionary maintains its block of ITextStoryThreads. Although unusual, a dictionary which does not currently have any ITextStoryThreads in the ITextmodel must return StoryRange(kInvalidTextIndex, kInvalidTextIndex). <dl class="section return"><dt>Returns<dd>StoryRange of text spanned by the threads of the dictionary </dl><p>Implemented in <a class="el" href="class_hid_txt_story_thread_dict.html#a1ab5dfa9e65805dfbf9730ffc64a1420">HidTxtStoryThreadDict</a>.</div></div><a class="anchor" id="a22798fb2c90de956d2463a359e8ce748"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a>* ITextStoryThreadDict::QueryThread </td><td>(</td><td class="paramtype">uint32&nbsp;</td><td class="paramname"><em>key</em></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Instantiate the <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a> with the given key. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">key</td><td>Private unique key that identifies which <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a> to instantiate </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Pointer to <a class="el" href="class_i_text_story_thread.html">ITextStoryThread</a></dl><p>Implemented in <a class="el" href="class_hid_txt_story_thread_dict.html#affc5970bf95d9392e03de123101eabf6">HidTxtStoryThreadDict</a>.</div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_text_story_thread_dict.html">ITextStoryThreadDict</a><li class="footer">Generated on Sat Sep 22 2018 10:54:31 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
