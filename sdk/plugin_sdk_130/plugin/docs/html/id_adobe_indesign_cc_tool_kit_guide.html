<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>id_adobe_indesign_cc_tool_kit_guide</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li class="current"><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('id_adobe_indesign_cc_tool_kit_guide.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="headertitle"><div class="title">Tool Kit Guide (ITK) </div></div></div><div class="contents"><div class="textblock"><p>The Adobe InDesign Tool Kit (ITK) consists of several tools. This document includes the following:<ul><li>Chapter 1, <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_action_automation_tool_for_black-box_testing">Action Automation Tool for Black-box Testing</a>: How to use this tool for the testing of Adobe&reg; InDesign&reg; plug-ins.<li>Chapter 2, <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extending_the_action_automation_tool">Extending the Action Automation Tool</a>: How to extend the AAT by adding actions and widgets for your specific QA requirements.<li>Chapter 3, <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_diagnostic_logger">Diagnostic Logger</a>: The installation, use, and design of the Diagnostic Logger tool.<li>Chapter 4, <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_symbol_resolver">Symbol Resolver</a>: How to use the Adobe&reg; InDesign&reg; symbol files provided in the ITK.</ul><p><b>Notation</b><p>This document uses the following notation for path names:<table class="doxtable"><tr><th>Notation </th><th>Meaning </th></tr><tr><td>&lt;InDesign&gt; </td><td>The installation directory for Adobe InDesign. By default, this is <br /><br /> Mac OS: /Applications/Adobe InDesign CC 2019/ <br /> Windows: C:\Program Files\Adobe\Adobe InDesign CC 2019\ <br /><dl class="section note"><dt>Note<dd>For InCopy or InDesign Server, substitute the appropriate application directory wherever &lt;InDesign&gt; appears. </dl></td></tr><tr><td>&lt;ITK&gt; </td><td>The directory containing the Adobe InDesign Tool Kit. </td></tr><tr><td>&lt;SDK&gt; </td><td>The directory containing the Adobe InDesign SDK. </td></tr><tr><td>&lt;username&gt; </td><td>In a path, the user&#39;s name. </td></tr><tr><td>&lt;locale&gt; </td><td>in a path, the locale, such as en_US/. </td></tr><tr><td>&lt;version&gt; </td><td>In a path, the current version number of the product release; for example, 9.0. </td></tr></table><h1><a class="anchor" id="id_action_automation_tool_for_black-box_testing"></a> Action Automation Tool for Black-box Testing</h1><p>This chapter describes how to use the Action Automation Tool (AAT) for black-box testing of Adobe&reg; InDesign&reg; plug-ins. The AAT editor allows you to create test sequences (action sessions) through its user interface, save them as XML (Session Files), and run them arbitrarily many times. It is a standard part of the debug build of InDesign and also can be used in the release build. AAT requires no deep programming knowledge to assemble test sequences.<p>The target audience for this chapter is anyone responsible for devising black-box tests for InDesign plug-ins. We do not assume that you have programmed in high-level language or written scripts, although that background makes learning the AAT easier, because it involves some basic programming concepts. We do assume that you are responsible in some way for black-box testing of code written for InDesign.<p>This chapter is organized as a series of procedures that take you through the major features of the AAT and gives you practical experience using the tool to write tests.<h2><a class="anchor" id="id_terminology"></a> Terminology</h2><p>The following key concepts related to the AAT are introduced in this chapter:<ul><li>Action - A single command or instruction; a test step.<li>Action Automation Editor - The dialog used for assembling and editing action sequences; a test-case editor.<li>Action sequence - A container for the actions in the Sequencer portion of the Action Automation Editor. An action sequence can have other action sequences nested in it, allowing actions to be organized into logical groupings. An action sequence executes the actions and sequences it contains in order, from top to bottom or using loops.<li>Action session - A set of actions and action sequences; a test case.<li>Item editor - The dialog that appears after double-clicking an action in a sequence. The dialog contains parameters of the action that can be viewed or edited, like bounds.<li>Sequencer - The area of the Action Automation Editor where you add, remove, or re-arrange actions and action sequences during your action session. The right-hand panel in the Action Automation Editor.<li>Session file - An action session that was saved as an XML file. Each session file contains at least one action sequence. Metadata can be included with the session file.<li>Source components - The actions and containers that you can use in an action session. Source components are displayed in a tree view in the left-hand panel of the Action Automation Editor.</ul><h2><a class="anchor" id="id_installation"></a> Installation</h2><h3><a class="anchor" id="id_overview"></a> Overview</h3><p>To work with the AAT, you must have the required assets (libraries, plug-ins, data files, etc.) in the correct places. This section describes how to install these assets.<p>To install the AAT, you must do the following:<ol type="1"><li>Move the shared libraries from &lt;ITK&gt;/build/win/&lt;debug|debug64|release|releasex64&gt;/ (Windows&reg;) or &lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/ packagefolder/contents/macos (Mac OS&reg;) to the correct location as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_shared_libraries">Shared libraries</a>.<li>Move the plug-ins from &lt;ITK&gt;/build/win/&lt;debug|debug64|release|releasex64&gt;/ (Windows&reg;) or &lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos (Mac OS&reg;) to a folder from which they can be loaded as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_plugins">Plug-ins</a>.<li>Move the data files from &lt;ITK&gt;/build/qa to a &quot;qa&quot; folder in the correct location relative to the installed executable (for example, InDesign.exe or /InDesign &lt;version&gt;.app/Contents/MacOS/) as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_required_data_files">Required data files</a>.</ol><h3><a class="anchor" id="id_shared_libraries"></a> Shared libraries</h3><p>Some shared libraries must be in the same folder as the other shared libraries on which InDesign depends; for example, for the release build, DataBase.dll on Windows&reg; and DataBaseLib.dylib on Mac OS&reg;. These libraries are in folders named as follows:<ul><li>Windows: <div class="fragment"><div class="line">&lt;ITK&gt;/build/win/&lt;debug&acirc;&#148;&#130;debugx64|release|releasex64&gt;/</div></div><li>Mac OS: <div class="fragment"><div class="line">&lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos</div></div></ul><p>The following table lists the shared libraries required for AAT to function with the release/debug applications.<table class="doxtable"><tr><th>Windows </th><th>Mac OS </th></tr><tr><td>TestLib.dll </td><td>TestLib.dylib </td></tr><tr><td>AATLib.dll </td><td>AATLib.dylib </td></tr><tr><td>TestUILib.dll </td><td>TestUILib.dylib </td></tr></table><p>It is possible that these libraries are part of a debug build that you already have. On Mac OS, if you Ctrl-right-mouse-click the InDesign executable and View Package Contents, you can inspect the packaged components to see whether the libraries already are included: <div class="image"><img alt="itk-guide-1.gif" src="itk-guide-1.gif" /></div><p>Move the shared libraries to the following folders:<ul><li>Windows: The same folder as the executable: &lt;InDesign&gt;.<li>Mac OS: The same folder as other libraries required by InDesign, such as DataBaseLib.dylib. They are in a folder named something like this: &lt;InDesign&gt;/contents/macos/</ul><h3><a class="anchor" id="id_plugins"></a> Plug-ins</h3><p>To use the AAT, some Adobe QA plug-ins must be loaded. The minimum set for AAT to function is shown in the following table.<table class="doxtable"><tr><th>Windows </th><th>Mac OS </th></tr><tr><td>AutoUI.apln </td><td>AutoUI.InDesignPlugin </td></tr><tr><td>AATArch.apln </td><td>AATArch.InDesignPlugin </td></tr><tr><td>AATArchUI.apln </td><td>AATArchUI.InDesignPlugin </td></tr><tr><td>QAMenu.apln </td><td>QAMenu.InDesignPlugin </td></tr><tr><td>QAScript.apln </td><td>QAScript.InDesignPlugin </td></tr><tr><td>QAScriptTestSuite.apln </td><td>QAScriptTestSuite.InDesignPlugin </td></tr><tr><td>QAXMLParser.apln </td><td>QAXMLParser.InDesignPlugin </td></tr><tr><td>Snapshotting.apln </td><td>Snapshotting.InDesignPlugin </td></tr><tr><td>TestLibPlugin.apln </td><td>TestLibPlugin.InDesignPlugin </td></tr><tr><td>TestUILibPlugin.apln </td><td>TestUILibPlugin.InDesignPlugin </td></tr></table><p>These plug-ins may be part of a debug build that you already have. They are not normally part of a release build. Binaries of these plug-ins are in the ITK folders named as follows:<ul><li>Windows: <div class="fragment"><div class="line">&lt;ITK&gt;/build/win/&lt;debug|debugx64|release|releasex64&gt;/testing</div></div><li>Mac OS: <div class="fragment"><div class="line">&lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos/testing</div></div></ul><p>To load these plug-ins, use one of the following techniques:<ul><li>Move the testing folder to a location where the plug-ins would be loaded by the application; for example, the application install folder.<li>Mac OS only: Create an alias to the testing folder, and move the alias under the plug-ins folder.<li>Windows only: Use PluginConfig.txt to ensure the testing plug-ins load.</ul><p>If there are no Testing or QA menus in the application, this is one symptom that you are missing the required testing plug-ins. In that case, check your configuration to ensure that these plug-ins load.<h3><a class="anchor" id="id_required_data_files"></a> Required data files</h3><p>Some data files must be present to use AAT. The expectation is that there is a QA folder that is a peer of the &lt;InDesign&gt; folder. The required data files are in the following folder:<div class="fragment"><div class="line">&lt;ITK&gt;/build/qa/aat/</div></div><p>The folders containing required data files are as follows:<div class="fragment"><div class="line">qa/aat/requiredqa/aat/test cases/libraryqa/aat/test cases/acquisition_testing</div></div><p>On Windows, if the application is installed into the following, defaInDesign CC 2014n:<div class="fragment"><div class="line">C:\Program Files\Adobe\InDesign CC\</div></div><p>you would place the QA folder from the InDesign Tool Kit in the following location:<div class="fragment"><div class="line">C:\Program Files\Adobe\QA\</div></div><p>On Mac OS, the same rule applies: The QA folder should be a peer of the &lt;InDesign&gt; folder. If you run the application at least once with the shared libraries and plug-ins required to run AAT, the QA folder is created for you in the required location.<p>If you receive asserts in debug when trying to bring up the Action Automation Editor, this is one symptom of missing these AAT data files. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_launching_the_action_automation_editor">Launching the Action Automation Editor</a>.<p><b>Acquire palettes for user-interface extension</b><p>If you bring up the Action Automation Editor now, there is nothing under the Loaded UI Extensions node of the Source Components. You can populate the UI Extensions node by creating a new document and executing GetAllPalettes.xml using either of the following methods:<ul><li>Select QA &gt; Action Automation Tool &gt; Run Session File. In the file-selection dialog, navigate to qa/aat/test cases/acquisition_testing/GetAllPalettes.xml. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_executing_a_single_session_file">Executing a single session file</a>.<li>In the Action Automation Editor, click Load Session File... to load GetAllPalettes.xml session, then click the Execute... button.</ul><p>Both execute the GetAllPalettes.xml session file and acquire all palettes in their default state with document open. These acquired palettes are loaded into the Action Automation Editor as a Preloaded Palette UI Library, for your convenience later. For more information, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_using_a_preloaded_palette_user_interface_library">Using a preloaded palette user-interface library</a>.<h2><a class="anchor" id="id_about_the_examples"></a> About the examples</h2><p>The &lt;ITK&gt;/source/itksamples/aatexamples/ folder contains subfolders with sample AAT session files and related assets. Familiarize yourself with the organization of this folder before working through the examples. The subfolders include the following:<ul><li>examplefiles - This contains most of the sample scripts referred to in this chapter.<li>extend-library - This contains sample scripts to extend the session file library. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extending_the_session_file_library">Extending the Session File Library</a>.<li>examplefiles-errors - This contains sample scripts that deliberately cause error reports. See &quot;Creating custom error messages&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_log_files">Log Files</a>.<li>acquire-ui - This contains sample scripts for capturing user-interface components and sample dialog descriptions. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_working_with_user_interface_extensions">Working with user-interface extensions</a>.</ul><p>We recommend that you back up the aatexamples/ folder before working through the procedures in this chapter, to avoid inadvertently overwriting or changing session files on which other procedures depend.<h2><a class="anchor" id="id_introduction_to_action_automation"></a> Introduction to Action Automation</h2><p>This chapter is structured as a set of procedures using the AAT. Completed examples of each procedure are provided; in some cases, these are starting points for other procedures.<h3><a class="anchor" id=""></a></h3><p>Test scripts can be expressed as a sequence of actions, regardless of whether they are intended for testing code in the Print, Text, or XML subsystems. Actions are the building blocks of test cases and bug specifications: They comprise the repeatable keystrokes or menu selections necessary to create a test case that you are trying to validate or find a defect that you are trying to reproduce.<p>Do not confuse an action in the sense we use it here with the low-level API concept of an operation identified by an ActionID. An action in the sense used in describing the AAT need not be associated with a particular ActionID, although it can be.<p>Often, test cases contain implicit actions that may seem obvious to the writer of the test script but ambiguous to someone else running that script. For example, take the test case &quot;Draw a one inch by one inch square.&quot; Several implicit steps must happen before the first step can be executed: The user needs to launch the application, create a new document, select a page of that document, decide whether to create the square with a tool or bring up a dialog, and determine the coordinates on the page where the square will be drawn.<p>Including the implicit steps in a test case would be useful for anyone trying to run this test case. Hence, an ideal test script explicitly states each step necessary to complete a given case.<p>Actions are the building blocks of the AAT. Explicit automated actions yield a test case. In essence, actions are single events assembled to consistently reproduce a given test case.<h3><a class="anchor" id=""></a></h3><p>Stored externally as XML-based files, action sessions (that is, test cases) have the advantage of being portable, flexible, and straightforward to use as a tool for automating most test scripts. Action sessions can be devised with little programming knowledge. As long as you understand the fundamentals of good test-case creation (for example, making each action explicit), you can automate your test scripts, converting repetitive testing tasks into scripts that can be run automatically, with failures logged to an external text log for straightforward bug reporting.<p>Action sessions have several uses. For example, testers can include action sessions with most bug reports, to ensure reproducibility by engineers. Action sessions can be used to create test files, to test legacy functionality, or to create test environments for manual testing. Also, it is relatively straightforward to carry out regression testing for bugs if an action session exists for the bug steps. The session files are cross-platform, meaning that, once you define an action session on one platform (say, Windows), you can run it on another (say, Mac OS) by transferring the session file from one platform to another, without having to recompile (for example, if you were writing white-box test code).<h2><a class="anchor" id="id_building_a_test"></a> Building a test</h2><p>This section familiarizes you with the main components of the AAT and allows you to create a session file containing a set of test steps. It covers how to do the following:<ul><li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_launching_the_action_automation_editor">Launching the Action Automation Editor</a>.<li>Building an action session to create a new document.<li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_editing_actions_in_the_item_editor">Editing actions in the Item Editor</a>.</ul><h3><a class="anchor" id="id_launching_the_action_automation_editor"></a> Launching the Action Automation Editor</h3><p>There are some prerequisites for working with the AAT in the release build, like ensuring that the testing plug-ins load; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installation">Installation</a>. In the debug build, the AAT should be configured correctly by default.<p>To open the Action Automation Editor window:<ol type="1"><li>Launch an InDesign build that is configured to work with AAT. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installation">Installation</a>.<li>Choose QA &gt; Action Automation Tool &gt; Action Automation Editor. A dialog should appear: <div class="image"><img alt="itk-guide-2.gif" src="itk-guide-2.gif" /></div></ol><h3><a class="anchor" id="id_using_the_action_automation_editor"></a> Using the Action Automation Editor</h3><p>As shown in the preceding figure, the Action Automation Editor is divided into two columns:<ul><li>The Source Components column contains a tree of actions and supporting components (for example, loops) from which you build tests. You can consider the Source Components to be your test case tools containing both actions and ways to execute them.<li>The Sequencer column contains the actions and components that you choose from Source Components, listed in the order in which they will be executed. This window displays a view of the action session as you build it.</ul><p>The Action Automation Editor is the main interface for building and executing action sequences to automate your test:<ul><li>To load an existing session file, click the Load Session File... button.<li>To start with a new session file, click the Clear Sequencer button.<li>To change a Session file, add, remove, duplicate, or replace actions with actions from the Source Components column.<li>To change the parameters of an action, double-click an action in the Sequencer column, or select an action and click Edit, to bring up the Item Editor (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_item_editor">Item Editor</a>).<li>To add an action to an action sequence, double-click an action in the Source Components column.<li>To bring up a dialog to search for an action, right-click within the Source Components column.<li>To bring up a dialog to search for an action or turn comments on/off for selected actions, right-click within the Sequencer column.<li>To load acquired palettes and dialogs, click the Extend UI... button.<li>To add your saved action sequences to the session library, click Extend library....<li>To save and execute the contents of the Sequencer column, then close the dialog, use the buttons at the bottom of the Action Automation Editor dialog.</ul><dl class="section note"><dt>Note<dd>When you click the Execute button, you are asked whether you want to save before executing the session file; however, you do not have to save before executing new scripts. This allows you try the script without changing your saved scripts.</dl><h3><a class="anchor" id="id_building_an_action_session_to_create_a_new_document"></a> Building an action session to create a new document</h3><p>To construct an action sequence to create a new document:<ol type="1"><li>Notice that the session file starts with a default action sequence in the Sequencer. To add any actions, you must have at least one sequence in the session: <div class="image"><img alt="itk-guide-3.gif" src="itk-guide-3.gif" /></div><li>In the Source Components panel, navigate to Actions &gt; Doc Actions &gt; New Doc and either double-click the New Doc item in the tree view or click the Add button while New Doc is selected. The New Doc action is added to the action sequence on the right-hand, Sequencer panel: <div class="image"><img alt="itk-guide-4.gif" src="itk-guide-4.gif" /></div><li>Click the Save button, and save the XML file to any location. Action session files are saved in an XML-based format and can be viewed in any Web browser or text editor. Also, they work across platforms and can be shared with other testers.<li>Click the Execute button. A new document is created.</ol><h3><a class="anchor" id="id_item_editor"></a> Item Editor</h3><p>Any action in your sequence has a set of parameters; you can either specify these explicitly or accept the defaults. To specify them, you must edit the action in the Item Editor. The Item Editor is accessible by double-clicking the action in your sequence or selecting the action and clicking the Edit button. This brings up the Item Editor modal dialog, which is split into two panes: a Parameters panel on the left and a panel on the right where you can specify the value of the parameter selected: <div class="image"><img alt="itk-guide-5.gif" src="itk-guide-5.gif" /></div><p>Parameters are settings that apply to the action you are editing. For example, when creating a new document with a New Doc action, there is a Landscape parameter that can take the value Yes or No; Yes creates a document in Landscape orientation, and No creates a document in Portrait orientation. The preceding figure shows parameterizing the number of pages in the new document created for a New Doc action.<p>Most parameters can be specified using variables. Variables can be set before executing an action as Input and can be set during execution as Output variables (See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_input_and_output_variables">Input and output variables</a>). You can set the variable name and value in the right pane of the Item Editor dialog. New values are updated after you close the item editor and bring it up again next time.<p>The set of the parameters varies according to the actions. Some parameters are used in most actions, such as Comments, Comment Out, Break, Action Descriptions, Validation level, Abort on error, etc. Other parameters are specific to the actions. The following table lists some of the most common action parameters that may be useful when you construct your AAT sessions.<table class="doxtable"><tr><th>Parameter </th><th>Descriptions </th></tr><tr><td>Abort on error </td><td>See &quot;Abort on error&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_debugging_and_fixing_action_sessions">Debugging and fixing action sessions</a>. </td></tr><tr><td>Action Descriptions </td><td>Describes the action. Usually includes the purpose, pre-conditions, etc. of the action. </td></tr><tr><td>Bounds </td><td>Commonly used for actions that create page items. </td></tr><tr><td>Break </td><td>If Yes, AAT stops at this action. Used for debugging. See &quot;Break&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_debugging_and_fixing_action_sessions">Debugging and fixing action sessions</a>. </td></tr><tr><td>Comment Out </td><td>If Yes, this action is commented out and is therefore not executed. </td></tr><tr><td>File </td><td>Commonly used in actions that involve files, like open, place, import, and export, as well as acquisition actions to store an acquired user interface. </td></tr></table><h3><a class="anchor" id="id_editing_actions_in_the_item_editor"></a> Editing actions in the Item Editor</h3><p>In the following steps, we take the sequence from <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_building_an_action_session_to_create_a_new_document">Building an action session to create a new document</a> and modify it to create a four-page document:<ol type="1"><li>Select the New Doc action and open the item editor for that action using one of the two methods described above.<li>Click the Num Pages parameter and enter &quot;4&quot; in the Value text field. Click OK.<li>Click the Execute button. You are prompted with an alert to save changes. Whenever you have unsaved changes in an action sequence and you click Execute, you are prompted to save. If you click No, your changes are not saved to a session file.<li>Click Save, and watch the sequence execute.</ol><p>You should now see a four-page document created.<h3><a class="anchor" id="id_practice_creating_a_document"></a> Practice creating a document</h3><p>Create a session that generates the following document, using what you know so far about action sessions:<ol type="1"><li>Using the Action Automation Editor, create a new 10-page tabloid document with master text frames turned on. Hint: See the Page Size parameter on the New Doc action and Master Text Frame.<li>Save the action session to a convenient location. Dismiss the Action Automation Editor dialog.<li>Verify the results by choosing File &gt; Document Set-up. Save the InDesign document to a convenient location as doc-with-master-text-frame.indd, by choosing File &gt; Save As. This script is in the examplefiles folder, in doc-with-master-text-frame.xml.</ol><h2><a class="anchor" id="id_loading_and_editing_test_cases"></a> Loading and editing test cases</h2><p>This section familiarizes you with the concept of a session file, which is where an action sequence is stored.<h3><a class="anchor" id="id_loading_action_sessions_from_a_session_file"></a> Loading action sessions from a session file</h3><p>Saved session files can be loaded into the Sequencer using the Load Session File... button. This button brings up a file-open dialog, which you can use to choose the XML session file you want to execute:<ol type="1"><li>Open the Action Automation Editor.<li>Click the Load Session File... button.<li>Open apply-swatch-to-box.xml in the examplefiles folder.</ol><p>When you load a session file, it replaces the contents of the Sequencer. If you have unsaved changes in your current Action Session, clicking the Load Session File... button prompts you to save changes.<p>Opening session files from a shared network drive can lead to contention with other testers. If you open from a shared network drive, save the session as a new file locally, to avoid potential conflicts. Also, when the application is open, be careful about deleting session files that you opened previously with the Action Automation Editor.<h3><a class="anchor" id="id_executing_a_single_session_file"></a> Executing a single session file</h3><p>Loading a session file displays the contents of the session file and allows you to run and/or edit it however you choose. If editing the session file is unnecessary and you want to run the session file directly:<ol type="1"><li>Close the Action Automation Editor window, if it is open.<li>Choose QA &gt; Action Automation Tool &gt; Run Session File. When a file-selection dialog appears, select the apply-swatch-to-box.xml file in the examplefiles folder.</ol><p>This executes the session file named apply-swatch-to-box.xml without having to open the Action Automation Editor.<h3><a class="anchor" id="id_executing_multiple_session_files"></a> Executing multiple session files</h3><p>To run several session files at once:<ol type="1"><li>Close the Action Automation Editor, if it is open.<li>Make sure the pointer tool is selected.<li>Choose QA &gt; Action Automation Tool &gt; Run All Session Files In Directory. Select the test-subset folder, in the examplefiles folder.</ol><p>This runs all session files in the folder.<p>To run a subset of tests, create a folder for that set of Action Session files, and use the Run All Session Files in Directory command. There is no Cmd/Ctrl selection to allow selection of multiple files from a file list.<h3><a class="anchor" id="id_editing_an_action_session"></a> Editing an action session</h3><ol type="1"><li>Load apply-swatch-to-box.xml (in the examplefiles folder) into the Action Automation Editor. Execute the session, and notice the results in layout view.<li>Expand the Action Sequence named Apply Swatch To Box, and select Create Rectangle by single-clicking. (Do not double-click the item, or you will open the Item Editor for this action. If you do open the Item Editor, dismiss it without making changes and continue.)<li>In the Source Components tree view, choose Actions &gt; PageItem Actions, select Create Regular Polygon, and click the Replace button. This replaces the rectangle action with the polygon action in the Sequencer panel: <div class="image"><img alt="itk-guide-6.gif" src="itk-guide-6.gif" /></div><li>Add an action to create an oval from PageItem Actions beneath the polygon action.<li>In the Sequencer panel, click and drag the Create Oval item above the Create Polygon item.<li>Save the session file to a convenient location, and execute it. The edits made in steps 3 and 4 are reflected in the document that is created. The script up to this point is in the examplefiles folder, named apply-swatch-to-poly.xml.<li>In the Sequencer, select Create Oval and click the Remove button below it. Save to a convenient location, and execute. The oval is no longer created. The script completed up to this point remains in the examplefiles folder, named apply-swatch-to-poly-oval.xml.</ol><h3><a class="anchor" id="id_creating_and_applying_swatches"></a> Creating and applying swatches</h3><p>See whether you can adapt the session file (apply-swatch-to-poly.xml) created in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_editing_an_action_session">Editing an action session</a>&quot; Editing an action session&quot; to do the following:<ol type="1"><li>Change the New Swatch action in the session to 100% Cyan and 0% for the others. Hint: See the Color Value 1, 2, ... parameter of the New Swatch action.<li>Change the New Swatch action name to MyCyan.<li>Create a new spot color (C=0, M=100, Y=100, K=0) with the name MySpot. Hint: Add a New Swatch action, see the Is Spot parameter of the New Swatch action, and turn off Use Values for Name.<li>Create a 10-sided polygon with a 10% inset. Hint: See the Number of Sides and Inset parameters on the Create Regular Polygon action.<li>Apply MyCyan to the fill and MySpot to the stroke.</ol><p>Save the session file to a convenient location, and execute it. After you execute the action sequence, zoom in to verify that the polygon&#39;s stroke is now red. For one implementation of the procedure above, see the session file apply-spot-to-poly.xml in the examplefiles folder.<h2><a class="anchor" id="id_organizing_and_reusing_action_sessions"></a> Organizing and reusing action sessions</h2><p>This section examines nesting of action sequences, adding your own session files to the existing library, and running one session file from within another.<h3><a class="anchor" id="id_nesting_action_sequences"></a> Nesting action sequences</h3><p>One main goal when automating testing is to create reusable, flexible components. When designing session files, create small sequences of actions; this increases the likelihood that you can reuse the sequences in other session files and makes it easier to isolate problems. Execute one sequence and verify that it works before adding another sequence to your session file.<p>Up to this point, we have considered action sequences that consist of one action sequence containing a set of actions. You can nest action sequences within one another, to structure your test code and make it modular. The benefits of modularizing test sequences in this way are equivalent to modularizing program code; the tests become easier to read, and you can use the name of the action sequence to indicate the intent of a block of test actions.<h3><a class="anchor" id="id_session_file_library"></a> Session File Library</h3><p>The Session File Library can be found in the Source Components tree view, as a peer of the Actions node you already used. The Session File Library allows you to access common action sequences as shown in the following figure; it lists all default session files and the session files you added. The named action sequences within each session file are displayed in the tree view as children of each session file item in the library: <div class="image"><img alt="itk-guide-7.gif" src="itk-guide-7.gif" /></div><p>You should add session files that you use frequently. For example, if you realize that you are always adding the same set-up actions to every new session file you create, save those set-up actions as a session file and add it to your library.<h3><a class="anchor" id="id_extending_the_session_file_library"></a> Extending the Session File Library</h3><p>The following figure shows adding to the Session File Library: <div class="image"><img alt="itk-guide-8.gif" src="itk-guide-8.gif" /></div><p>When you add a sequence from the Session File Library, the sequence is no longer connected to the action sequence stored in the Library; that is, you are adding the individual actions in the session file from the Library to your current action session, rather than creating a reference to a shared session file. If you update the sequence in the session file stored in the Library, it does not update in other session files in which you have used that sequence. You must edit each instance of the sequence in each separate session file. This means that the Library is not a universal panacea to creating tests; you should ensure that the session files in the Library are correct and stable before using them widely.<p>In the following steps, we add an existing session file to the Session File Library:<ol type="1"><li>Launch the Action Automation Editor, clear the Sequencer, and click Extend Library.<li>Select the apply-tag.xml file in the extend-library folder to add the session file to the Library.<li>Load the create-box.xml session file from the examplefiles folder. Save to a convenient location, with a different filename.<li>Expand the Session File Library node under Source Components, and locate the apply-tag.xml session file that you added above. Expand the node for the Library listing. Select the item Apply Tag, and you should see the Add &gt;&gt; button become enabled.<li>Click the Add &gt;&gt; button to add the actions from the library to the action sequence, making sure you are adding it at the end of the existing action sequence. The actions from the Apply Tag sequence should be copied into your action sequence.<li>Save to a convenient location, and execute. This script is in the examplefiles folder, named apply-tag-to-box.xml.</ol><h3><a class="anchor" id="id_executing_a_session_file_from_within_another_session_file"></a> Executing a session file from within another session file</h3><p>Instead of reusing sequences by extending the library, you could use an Execute Session File action, located under the Actions &gt; Custom Actions node in Source Components. This action executes a particular session file that you direct it to, as part of another action sequence. The advantage of using an Execute Session File action in your sequence is that the executed session file is self-contained. Any changes are made in one place, the executed file. A disadvantage is that, if you need to isolate a problem, you may have to troubleshoot multiple session files.<p>A further disadvantage is that you cannot pass parameters into session files that you execute from another session file. This means, for example, if you create context in one session file, like a page item that you want to pass into the actions in the other session file, you cannot do this by executing one session file from within another. In this case, you should use the approach described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extending_the_session_file_library">Extending the Session File Library</a>.<h2><a class="anchor" id="id_working_with_page_items"></a> Working with page items</h2><p>There can be many ways to create a particular layout object. For example, to create text, you can directly create a text frame with the text tool and begin to type, place a story, click in a graphic frame with the text tool and type, or click in a text frame and paste text. Alternately, you can click a path and create text-on-a-path.<p>Just like manually creating a page item, usually there are multiple ways to create a given item through action automation. It is helpful to consider what method you want to use. Sometimes it does not matter, as long as the result is the same; other times, the method matters a great deal. For example, if you are testing a tool that creates specific page items, you want your automation to create new page items using the given tool, not another method.<p>Before you manually create a page item, you specify where you want the page item to go-not only in terms of its coordinates, but also the document and page relative to the start of the document-or you locate the spread and choose a page within that spread relative to the start of the spread. If you have multiple documents open, you choose the document in which the object goes. If multiple views are open on one document, when manually creating a page item, you choose the view (out of those opened on the document) in which you want to create the page item. You also may choose the page on which you will create the object and where on the page you will start to drag with the page-item tool.<p>These same decisions need to be made in your automation. You must be explicit about which document, which page, and where on the page you want to create an object in the action session. The following figure shows the wrong way to create a rectangle, where the page is not made explicit: <div class="image"><img alt="itk-guide-9.gif" src="itk-guide-9.gif" /></div><p>The following figure shows the correct way, where the page is explicit. In both cases, only one document is open, so we do not have to tell the session file which document to target. <div class="image"><img alt="itk-guide-10.gif" src="itk-guide-10.gif" /></div><p>When creating a new document with an action session, sometimes it is easier to use the Close All Docs action under Application Actions before starting. This eliminates the need to specify which document or window you are targeting, since there can be only one.<h2><a class="anchor" id="id_creating_and_modifying_page_items"></a> Creating and modifying page items</h2><p>This section looks at the basics of creating and modifying page items.<p>Page items are drawn by default from right to left. To draw page items from left to right, use a click and drag action, not the Create (something) action. The default location for new page items is (0, 0) (upper-left corner of the page). No margins are taken into account. Page items are created at the default location, unless another location is specified in the Item Editor.<p>Each page in the document has an index associated with it, which is a number that identifies the page you are targeting. This is a zero-based index, so page numbering starts from 0. To put an object on page 1 of the document (as displayed in the Pages panel), the action needs to use page index 0. To put an object on page 2, specify page index 1, and so on. In other words, take the page number displayed in the Pages panel, subtract 1, and the result is the index to use.<p>The same applies for anything you have to target; for example, collections of documents and spreads use a zero-based index. The first document opened (Untitled-1.indd) has an index of 0; the second document opened, 1; and so on.<h3><a class="anchor" id="id_creating_basic_page_items"></a> Creating basic page items</h3><ol type="1"><li>Open the Action Automation Editor, and press Clear Sequencer if needed.<li>From Actions &gt; Doc Actions, add a New Doc action.<li>From Actions &gt; Page Actions, add a Get Nth Page action, immediately beneath the New Doc action.<li>From Actions &gt; Page Item Actions, add each of the following page-item actions and specify their bounds:<ul><li>Rectangle (Create Rectangle)<li>Oval (Create Oval, etc.)<li>Line<li>Polygon</ul><li>Using the Item Editor, change the Action Sequence name to Create Page Items.<li>Save the Action Sequence to a convenient location, and execute. A sample script named create-page-items.xml implements this recipe.</ol><p>Note that a new Action Sequence has the default name Action Sequence. It is good practice to change the name of your action sequence to something descriptive. The name appears in the Action Automation Editor and makes organizing long sequences, troubleshooting, and re-using Action Sessions easier, especially if you use the Extend Library feature. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extending_the_session_file_library">Extending the Session File Library</a>.<p>When editing or creating page items, the location and size of the object is specified using four parameters, in this order: X (left), Y (top), H (height), W (width).<p>For example, add a Create Rectangle action and edit the Bounds value, making it 2, 2, 3, 4 inches. You are telling the application to start at (x, y) and drag down the page to (H) and across the page to (W). This corresponds to the following: &quot;Go to (2 inches right, 2 inches down) from the page origin, and create an item 3 inches high and 4 inches wide.&quot;<p>Any item you create must fit on the pasteboard. We recommend that you do not specify negative numbers in the bounds of a create action, as the behavior of the application is undefined.<h3><a class="anchor" id="id_applying_attributes_to_page_items"></a> Applying attributes to page items</h3><p>The following procedure creates some page items and modifies their attributes:<ol type="1"><li>Open the Action Automation Editor, and press Clear Sequencer.<li>Load the create-page-items.xml session file. Change the name of the Action Sequence to Create Page Items and Attribs. Save to a convenient location, with a different filename.<li>Modify the Rectangle to begin at X=28 points, Y=53 points, with Width and Height equal to 72 points.<li>Modify the Oval created to begin at X=3 inches, Y=2 Inches. Make it 4 inches wide and 1 inch high.<li>Modify the Line to begin at X=5 inches, Y=1 inch.<li>Transform the following objects:<ul><li>Skew the rectangle by 15 degrees. Hint: Look under Actions &gt; Page Item Actions.<li>Resize the oval to 50% of its width and height. Hint: See Page Item Actions &gt; Resize.<li>Change the stroke on the line to 15 pts. Hint: See Page Item Actions &gt; Set Page Item Stroke Weight.</ul><li>Save the action session and execute. This script is in the examplefiles folder, named create-page-items-attribs.xml.</ol><h3><a class="anchor" id="id_typing_text_into_a_story"></a> Typing text into a story</h3><p>This procedure shows one way to enter text into a story, as if it had been typed into a window through the user interface:<ol type="1"><li>Open the Action Automation Editor, and press Clear Sequencer if needed.<li>Load the new-default-doc.xml session file, and save it to a new location. Rename the action sequence (edit the Action Sequence action and change the Name parameter) to Typing Text.<li>From Actions &gt; Story Actions, add a New Story Action, immediately after the Get Nth Page action, at the bottom of the Typing Text sequence.<li>From Actions &gt; UI Actions, add an action to Type Text.<li>Go into the Item Editor by either double-clicking the Type Text action or selecting the action and clicking the Edit button in the Action Automation Editor dialog.<li>Specify a text file for the Type Text action. Hint: See the File parameter associated with the action. Choose the testfile.txt file in the examplefiles folder. Hint: Make this relative to the Session File&#39;s folder; see the Relative Folder widget. Because this is a QA tool, the AAT editor expects test files to be specified as paths relative to the QA folder, which is why this option appears as the default.<li>Execute the session file. The text in the test file should be inserted into the new story. This script is in the examplefiles folder, named typing-text.xml.</ol><p>When working with text, consider whether placing a text file would work better for your purposes. It is much faster to place a text file than to type text; under Page Item actions, see the Place File at Selection action.<p>If you want to test a feature that depends on an end user actually typing, not just putting text in a document, use the Type Text action. For example, suppose you want to set a default style, then test it was respected as text was typed. You could create an action sequence to set the text style, then type text into the story and determine the style settings; this would let you verify that the defaults in that text frame were correctly respected, which placing cannot do in all situations.<p>In addition to the typing-text.xml session file, there is a related session file in the examplefiles folder, named placing-text.xml. In the placing-text.xml, a Place File at Selection action replaces Type Text. Execute both session files, and compare the relative speeds of the two scripts to create text.<h3><a class="anchor" id="id_cutting_copying_and_pasting_text"></a> Cutting, copying, and pasting text</h3><ol type="1"><li>Save typing-text.xml as a new session file in a convenient location.<li>From Actions &gt; Story Actions, add a Select Text action immediately after the Type Text action.<li>Cut the text. Hint: Use Cut selection under Actions &gt; Doc Actions.<li>Add a New Story Action. Specify the bounds, so this story will not overlap the story you created previously; for example, X=4 inches, Y=1 inch.<li>Paste into the last story you created. Hint: Use Paste into Story, under Story actions.<li>Create another New Story, again specifying the bounds so it does not overlap either of the existing two stories; for example, X=1 inch, Y=5 inches. Paste into it.<li>Save the session file to a convenient location, and execute. You should now see three text frames, the first of which is empty after the cut-selection operation. The other two should have the content that was typed into the first story. This script is in the examplefiles folder, named cut-copy-text.xml.</ol><h3><a class="anchor" id="id_filling_with_placeholder_text_"></a> Filling with placeholder text</h3><ol type="1"><li>Open the Action Automation Editor, and press Clear Sequencer.<li>Load the new-default-doc.xml session file from the examplefiles folder.<li>Edit the Action Sequence, and retitle it as Placeholder Text.<li>From Actions &gt; Story Actions, add a New Story Action, immediately after the Get Nth Page action, at the bottom of Placeholder Text sequence.<li>From Actions &gt; Story Actions, add a Fill with Placeholder text action, immediately after the New Story action.<li>Save the session file to a convenient location, and execute. You should find you have a text frame containing placeholder text. This script is in the examplefiles folder, named placeholder-text.xml.</ol><h2><a class="anchor" id="id_placing_files"></a> Placing files</h2><p>The objectives of this section are to introduce you to the basics of placing assets.<p>When placing graphics and text, consider whether you will run the test on more than one machine or platform. If so, create a relative path to the graphic or text file, rather than an absolute path. Otherwise, the AAT cannot automatically target the path to the asset on the new machine, and your test will fail.<h3><a class="anchor" id="id_placing_graphics"></a> Placing graphics</h3><ol type="1"><li>Open the Action Automation Editor, and clear the Sequencer.<li>Load the new-default-doc.xml session file. Change the name of the action session in the Sequencer to Place Graphics.<li>From Actions &gt; PageItem Actions, add a Place File at Point action, immediately after the Get Nth Page action, at the bottom of Place Graphics sequence.<li>In the Item Editor, specify the desired coordinates. The default is 0,0,pts. Change this to X=50pts, Y=100pts.<li>Under Parameters, click File and browse to the file named bottle.tif in the examplefiles/images folder.<li>Save to a convenient location, and execute the action sequence. You should see a graphic placed on the page. This script is in the examplefiles folder, named place-graphics.xml.</ol><h3><a class="anchor" id="id_placing_text_to_autoflow"></a> Placing text to autoflow</h3><ol type="1"><li>Open the Action Automation Editor, and clear the Sequencer.<li>Load the new-default-doc.xml session file. Rename the Action Sequence, by setting its Name parameter to be Place RTF.<li>From Actions &gt; PageItem Actions, add a Place File at Point w/ Autoflow action, immediately after the Get Nth Page action at the bottom of Place RTF sequence.<li>In the Item Editor, specify the desired coordinates. The default is 0,0,pts. Change this to X=36pts, Y=36pts.<li>Under Parameters for the Place File action, click File, and browse to the text file named testfile.rtf in the examplefiles folder.<li>Save to a convenient location, and execute the action sequence. You should find an RTF file placed on the page. This script is in the examplefiles folder, named place-rtf.xml.</ol><h3><a class="anchor" id="id_placing_text_into_threaded_frames"></a> Placing text into threaded frames</h3><ol type="1"><li>Launch the Action Automation Editor, and clear the Sequencer.<li>Load the new-default-doc.xml session file. Change the name of the Action Sequence in the Sequencer to be Place Linked.<li>From Actions &gt; Story Actions, add a New Story Action, immediately after the Get Nth Page action, at the bottom of Place Linked sequence.<li>From Actions &gt; PageItem Actions, add a Place File at Selection action, immediately after the New Story Action. Because the New Story action leaves a text-insertion point in the new story, which counts as a selection, you can place a file at the &quot;selection&quot; (insertion point).<li>Edit the File value for the Place File action: choose large.rtf in the examplefiles folder.<li>From Actions &gt; PageItem Actions, add a Create Linked Text Frame immediately after the Place File at Selection action.<li>Save the session file to a convenient location, and execute the action sequence. You should see two text frames, with a story flowing between them that came from the placed RTF file. This script is in the examplefiles folder, named place-linked.xml.</ol><h3><a class="anchor" id="id_placing_inline_graphics"></a> Placing inline graphics</h3><p>To create inline graphics, you must first have some text, then either create a text insertion or select a range of text. You then place a graphic at the selection (or insertion point) to create an inline graphic.<p>Some Select Text action parameters are important to know about when creating inlines:<ul><li>TextStart Index - The Nth character specifies where you want the selection to start.<li>Selection Length - Specifies the number of characters included in the selection. A value of 0 gives you a text insertion. A value of (-1) selects to the end of the story.</ul><p>To place inline graphics:<ol type="1"><li>Open the Action Automation Editor, and clear the Sequencer.<li>Load the new-default-doc.xml session file. Change the name of the Action Sequence, editing its Name parameter to be Place Inline.<li>From Actions &gt; Story Actions, add a New Story Action immediately after the Get Nth Page action at the bottom of Place Inline sequence. Set the frame origin to x=1 inch, y=1 inch, with Width=6 inches and Height=6 inches.<li>From Actions &gt; Story Actions, add a Fill with Placeholder Text action immediately after the New Story action.<li>From Actions &gt; Story Actions, add a Select Text action immediately after the Fill with Placeholder Text action.<li>Change the Selection Length parameter to 0 for the Select Text action (it defaults to -1). This creates an insertion point but does not select any text.<li>From Actions &gt; PageItem Actions, add a Place File at Selection action immediately after the Select Text action. Set the File parameter to bottle.tif, from the examplefiles/images folder.<li>Save to a convenient location, and execute the action sequence. You should see a graphic placed as an inline at the start of the story within a text frame. This script in the examplefiles folder, named place-inline.xml.</ol><h2><a class="anchor" id="id_linking_text_frames"></a> Linking text frames</h2><p>This section explores how to create linked text frames using the Action Automation Editor.<p>Expand Text Frame Actions in your Source Component list, and notice the Link To Text Frame and the Link From Text Frame actions. To manipulate text-frame threads, we use variables to refer to different text frames and use these as action parameters. For more detail about using variables to refer to objects we create in scripts, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_input_and_output_variables">Input and output variables</a>.<h3><a class="anchor" id="id_link_two_existing_stories"></a> Link two existing stories</h3><ol type="1"><li>Launch the Action Automation Editor, and clear the Sequencer.<li>Load the new-default-doc.xml session file from the examplefiles folder. Set the name of the Action Sequence to be Link Two Stories.<li>From Actions &gt; Story Actions, add a New Story Action immediately after the Get Nth Page action, at the bottom of Link Two Stories sequence. Set the Bounds to X=1 inch, Y=1 inch, with both Width and Height 3 inches. Edit the Output Frame parameter to be TextFrame1, rather than the default TextFrame.<li>Add another New Story action right after the new New Story action. Set the frame origin to X=1 inch, Y=5 inches, with both Width and Height 3 inches. Edit the Output Frame parameter to be TextFrame2.<li>From Actions &gt; Text Frame Actions, add a Link To Text Frame after the new New Story action. Specify that you want to link From TextFrame1 and link To TextFrame2.<li>From Actions &gt; Text Frame Actions, add a Get Story from Text Frame action immediately after the Link From Text Frame action. Specify that you want to get the story from TextFrame1.<li>From Actions &gt; Story Actions, add a Fill with Placeholder Text action immediately after the Get Story from Text Frame action. This should put placeholder text into the story that begins at TextFrame1 and flows through TextFrame2.<li>Save to a convenient location, and execute the session file. You should see two linked text frames. Confirm this by choosing View &gt; Show Text Threads and selecting one of the text frames with the pointer tool This script is in the examplefiles folder, named thread-two-stories.xml.</ol><h3><a class="anchor" id="id_practice_threading_linking_text_frames"></a> Practice threading (linking) text frames</h3><ul><li>Start from thread-two-stories.xml, and save to a new filename. Specify different variables for three text frames, and thread them from the first frame to the last frame. This is really just an extension of the procedure in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_linking_text_frames">Linking text frames</a>. For a completed script, see thread-three-stories.xml.<li>Save the session file to a new name, and reverse the order of threading; that is, thread from the last frame to the first frame. For a completed script, see thread-three-stories-reverse.xml.<li>Save the session file under a new name, and thread from the middle frame to the last frame, then to the first frame. For a completed script, see thread-three-stories-middle.xml.</ul><h2><a class="anchor" id="id_programming_concepts"></a> Programming concepts</h2><p>The AAT provides testers with a user interface, the AAT Editor, with which to create automated tests. The tool makes it possible for a tester to create automated tests without requiring an extensive technical background. That said, there are certain programming concepts and methods built into the tool, which may require some study for those who have never scripted or programmed before.<p>The concepts presented in this section will help you understand how each action affects every other action by way of input and output variables, how loop statements are used in action sequences, and how to use logic to control the flow of action sequences. The concepts introduced in this section include the following:<ul><li>In variable - The variable that refers to the object that is the target (input) for an action. The action executes on the In variable.<li>Index Value - A numerical representation of an object in relation to other objects of the same type. For example, if you imagine a queue of 100 cars stretching back from a traffic light, each car has a unique index value. The index count begins at 0. If you count from the traffic light back down the queue, you begin with the car at the light (index=0), the one behind it (index=1), and so on.<li>Loop - A loop is a sequence that starts at the beginning with some initial conditions and continues repeating the same steps in order until it completes, with a terminating condition that indicates when to stop; for example, when the loop is carried out 100 times.<li>Nth - A way of referring to an object based on its index value. In the context of the AAT, Nth values always are zero-based, and objects in a collection are referred to as zeroth, first, second, and so on.<li>Object - Any entity associated with InDesign. Objects are created by actions. You can manipulate an object only if you have a variable that refers to the object.<li>Out variables - The variable that refers to the object that is emitted (output) by an action.<li>Parameter - The name of a property of an action or sequence that can be specified by its value. For example, Selection Length is a parameter of the Select Text action.<li>Value - The setting applied to a parameter. For example, the Selection Length parameter could be set to the value zero.<li>Variable - A that refers to an object to allow you to manipulate it; for example, TextFrame1 might identify the first of a series of text frames that you want to link together.</ul><h2><a class="anchor" id="id_variables_in_action_automation"></a> Variables in Action Automation</h2><p>With AAT, variables are the objects an action takes in (the In variable) or produces (the Out variable). Variables can be anything-rectangles, pages, XML tags, documents, swatches, text strings, numbers-and are identified by a name the action specifies.<p>Every action that produces an object outputs a default name to represent that variable. For example, if you use the New Doc command, the output variable is Doc. In addition, most actions that require an input variable reference an expected variable. For example, if you select the Insert Pages action, it expects an Input variable called Doc.<p>Parameters of an action may accept values directly or values stored in variables. For the New Doc action example, you can specify the number of pages of the new document as 10 using the &quot;Num Pages&quot; parameter in the top right of the Item Editor dialog, or you can provide a variable name (for example, &quot;numPages&quot;) at the bottom right of the dialog and initialize the variable to 10.<p>AAT variables do not specify a type. You can assign a string to a variable that was used as an integer.<h3><a class="anchor" id="id_input_and_output_variables"></a> Input and output variables</h3><p>If you examine the thread-two-stories.xml session file from <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_link_two_existing_stories">Link two existing stories</a>, note how Doc is an output variable in the New Doc action, but it is an input variable in the Get Nth Page action. Variables are neither exclusively input nor exclusively output. When an output variable is assigned based on an action, that variable is available for input to another action later. In short, a variable gives you a name with which to refer to an object later.<p>An output variable is the name of the object the action created. For example, Page is the default output variable for the Insert Pages action.<p>An input variable is the name of the object the action needs to successfully create its object. For example, the Insert Pages action requires an input variable that references a document, as shown in the following figure. By default, the Insert Pages action expects a variable named Doc to be available and to refer to a document created by an action like New Doc. <div class="image"><img alt="itk-guide-11.gif" src="itk-guide-11.gif" /></div><p>The Sequencer pane of the Action Automation Editor displays input and output variables in parentheses next to the action name for any actions that have variables associated with them. In and Out are used for input and output variables, respectively.<p>Sometimes an action requires variables other than the In variable shown when the action is added to an action sequence. For example, the Apply Swatch To Page Item action (Actions &gt;\ Swatches) depends on two input variables, Target Page Item and Swatch. Only the Target Page Item is shown as an In variable. The AAT tool typically reports an error if an input variable is not defined and gives you an indication of how to fix the problem.<p><b>Variable names</b><p>Variables can be renamed, depending on how you want to use them. For any action that outputs an object, you can edit the Out variable if desired. Sometimes this is necessary, as in the example of linking two TextFrame objects, where you might choose to name them TextFrame1 and TextFrame2, to specify the From and To frames.<dl class="section note"><dt>Note<dd>The scope of a variable is the entire session. Choose your variable names carefully.</dl><h3><a class="anchor" id="id_using_custom_variables"></a> Using custom variables</h3><p>Suppose you want to create two documents and work with both throughout an action sequence. If you execute the New Doc action with the default output variable, the first document you create is assigned a variable named Doc, but as soon as the second New Doc action is executed, the variable named Doc is reassigned to the second document; see the following figure. A straightforward workaround to this problem is to change the default name of the New Doc output variable to something different in each case, say Doc1 and Doc2. <div class="image"><img alt="itk-guide-12.gif" src="itk-guide-12.gif" /></div><p>To define custom variable names:<ol type="1"><li>Clear the Sequencer. Rename the sequence to be Custom-Variables.<li>From the Doc actions, add a Close All Docs action to your action sequence.<li>Add a New Doc action to your action sequence. Edit the action, changing the Output Doc parameter of the action to Doc01.<li>Add another New Doc action, setting its Output Doc parameter to Doc02.<li>Assume that we want to create an oval page item in the first document and a rectangle page item in the second document. Before we can create the page items, we need variables that can refer to pages in the documents.<li>From Page Actions, add a Get Nth Page action to the action sequence. By default, this action requires an input variable called Doc, specified in the Target Document parameter. For this action, we want a page from the first document, referred to by the Doc01 variable, so edit the action and change the Target Document input variable to Doc01; see the following figure. We must do this, because we renamed the output variable for both New Doc actions, and the default variable Doc does not exist in our sequence. We now have two variables that reference open documents, so we can refer to the two documents independently. <div class="image"><img alt="itk-guide-13.gif" src="itk-guide-13.gif" /></div><li>Edit the Output Page parameter of the Get Nth Page action, to be Page01. The Get Nth Page action assigns a variable to the page object with a default name of Page, and we want to make it clear that the page we are referring to is in the first document.<li>Add another Get Nth Page action, but this time, set the Target Document parameter of the action to Doc02, and set the Output Page parameter to Page02.<li>From Page Item actions, add a Create Oval action, which we will create in the first document. Before editing the action, notice how the action is phrased. Actions that require an input variable have a default variable assigned to them when you add them to an action sequence. In this case, the Create Oval action expects an input variable named Page, but this variable does not exist in the action sequence. We need to edit the action to reflect the page on which we want the page item to be created.<li>Edit the Target Page parameter of the Create Oval action, to specify an input variable named Page01. Edit the Bounds parameter of the action to be X=1 inch, Y=1 inch.<li>Add a Create Rectangle action. Again, the action expects an input variable named Page, which does not exist in our action sequence.<li>Edit the Target Page parameter of the Create Rectangle action, to specify an input variable named Page02. Edit the Bounds parameter of the action to be X=2 inch, Y=2 inch.<li>When you are finished, your action sequence should look like the following figure. Save it to a convenient location, and execute the sequence. This should create two documents, one with an oval page item, and the other with a rectangle page item. This script is in the examplefiles folder, named custom-variables.xml. <div class="image"><img alt="itk-guide-14.gif" src="itk-guide-14.gif" /></div></ol><h3><a class="anchor" id="id_variable_operations"></a> Variable operations</h3><p>The AAT provides a collection of miscellaneous actions; for example, for mathematical functions and string manipulations. These actions can be found under Actions &gt; Variable Operation and are listed in the following table.<table class="doxtable"><tr><th>Operation </th><th>Meaning </th></tr><tr><td>Math </td><td>Left value [+, -, *, /,%], right value = value. </td></tr><tr><td>Unary </td><td>Takes a single variable and performs floor, ceiling, and round operations. </td></tr><tr><td>Compare </td><td>Compares two values based on an operations (&lt;, &gt;, =, etc). </td></tr><tr><td>Random Number </td><td>Generates a random, real number specified by min and max parameters. </td></tr><tr><td>Output Rect </td><td>Outputs a variable for the &quot;x1, y1, x2, y2, units&quot; values specified in the action. </td></tr><tr><td>Output Point </td><td>Outputs a variable for the &quot;x,y,units&quot; values specified in the action. </td></tr><tr><td>Offset Rect </td><td>Outputs a variable for a new set of &quot;x1,y1,x2,y2,units&quot; based on previous coordinates, offset by &quot;x,y&quot; as specified in the action. </td></tr><tr><td>Offset Point </td><td>Outputs a variable for a new set of &quot;x1,y1,units&quot; based on previous coordinates, offset by &quot;x,y&quot; as specified in the action. </td></tr><tr><td>Get Point From Rect </td><td>Outputs a variable for a new set of &quot;x, y, units&quot; based on an input rect as specified in the action parameter. </td></tr><tr><td>Get Value From Point </td><td>Outputs a variable for x or y value of an input point specified in the action parameter. The units for the variable also can be set in the action parameter. </td></tr><tr><td>String Actions </td><td>Manipulates a string based on the supplied parameters. For example, you can append one string of text to another. </td></tr><tr><td>String Information </td><td>Returns information about a string, based on the supplied parameters. For example, you can return the total number of characters in the string. </td></tr><tr><td>Output Path </td><td>Specifies where you want a file to go. </td></tr><tr><td>Extract File Name from Path </td><td>Returns a string contain the filename. </td></tr><tr><td>Get Session File Name </td><td>Returns the filename of the session. </td></tr><tr><td>Get Platform Folder Separator </td><td>Returns &quot;\&quot; or &quot;:&quot;. </td></tr><tr><td>Get Local Point from Global </td><td>Converts global coordinate to local. </td></tr><tr><td>Get Global Point from Local </td><td>Converts local points to global. </td></tr></table><h2><a class="anchor" id="id_get_nth_object"></a> Get Nth object</h2><p>An InDesign document can be viewed as a collection of object collections. Suppose you have a one-page document that contains a rectangle, linked graphic file, and text frame. That one-document object includes a page object, and that page object includes three page items-the text frame, the link, and the box.<p>In <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_using_custom_variables">Using custom variables</a>, we considered how variables are assigned to new objects created by your action sequence. In this section, we discuss how variables can be assigned to existing objects in your document.<p>Consider the following scenario. Suppose you want to create a new document and draw a box on the first page. Through the InDesign user interface, you choose File &gt; New, supply the document parameters and click OK, select the Rectangle Tool, click and hold down the mouse button in the area of the page where you want the box to start, drag the mouse to where you want the box to stop, and release the mouse button.<p>The AAT lets you automate this operation with the New Doc and Create Rectangle actions. Superficially, it might seem that, to automate the action of creating a box as described above, all you would need to do is add a New Doc action followed by a Create Rectangle action to your action sequence; however, there is a missing step: if you created the action sequence (New Doc, Create Rectangle), you would find the Create Rectangle action fails, with an error like this:<div class="fragment"><div class="line">Error: CreateRectAATAction: failed to obtain document or page. Did you <span class="keyword">set</span> a page?</div></div><p>Many actions require an input variable, including Create Rectangle, which has the default input variable of Page. If you change the Target Page parameter of the Create Rectangle action to be Doc, then execute the action sequence, the Create Rectangle action succeeds.<p>Suppose we want to create a new document with five pages, with the rectangle created on the third page (index=2). If we edit the New Doc action so the number of pages is five and execute the action sequence again, we get a five-page document but with a rectangle on the first page (index=0). Clearly, we need another variable to specify that we should use the third page in the document, not the first.<p>In this situation, when you need to specify a position within an indexed collection, using an action of the form Get Nth object can solve our problem; we can obtain a variable that refers to an existing object and use it throughout our action sequence.<p>We need to have a variable that refers to the third page in the document, and use that as our input variable for the Create Rectangle action. Using a Get Nth Page with the Index value set to 2 (since the pages are indexed from 0), then assigning the output variable (Output Page) from that action as the input variable (Target Page) for the Create Rectangle action, we can create a rectangle page item on the third page of the document.<h3><a class="anchor" id="id_when_to_use_get_nth_object"></a> When to use Get Nth object</h3><p>You may have to use an action of the form Get Nth object when another action you want to use requires an input variable that was not specified previously in your action sequence.<p>An action of the form Get Nth object allows you to refer to an object of a specific type based on its index value. The index enumerates all objects of a given type in a particular context. For example, if you have 10 documents open, N can take the values N=0, 1, 2, ..., 9.<p>An action to Get Nth object is available for many object types. You can Get Nth Page, Get Nth Swatch, Get Nth Document, and so on. Occasionally, Get Nth is the only way to obtain a variable referring to an object in your document.<p>Get Nth object and Get Num object look similar but have different meanings: Get Nth lets you choose an object by its position in a collection, while Get Num tells you the size of a collection. For example, when a Get Num Pages action executes, the value it outputs is the number of pages in the document, which is not zero-based.<h3><a class="anchor" id="id_adding_a_rectangle_to_a_given_page"></a> Adding a rectangle to a given page</h3><ol type="1"><li>Close all docs, and create a New Doc with five pages.<li>From the Page Actions, add a Get Nth Page action.<li>Edit the Page Index parameter of the action, and set the Page Index to 2. Because we want to draw a rectangle on the third page of the document, we need to enter the value as 2 because the values taken by the Page Index are zero-based.<li>Before dismissing the Item Editor, note the name of the output variable, specified by Output Page for this action. The default output variable is named Page.<li>Add a Create Rectangle action from Actions &gt; PageItem Actions. Edit the action, and double-check the In Variable value of the Target Page parameter. By default, it should match the value from the preceding step. If not, make the appropriate change.<li>Save the session, and execute. When the session completes, a rectangle should be on the third page of the document. This script is in the examplefiles folder, named rect-on-page3.xml.</ol><h3><a class="anchor" id="id_practice_using_get_nth"></a> Practice using Get Nth</h3><p>Use actions of the form Get Nth object to do the following. Create a new document with five pages. Add a different type of page item to each page, using Get Nth Page actions. For a sample solution, see five-page-items.xml in the examplefiles folder.<h2><a class="anchor" id="id_loops_and_flow_of_control"></a> Loops and flow of control</h2><p>A loop in an action sequence is one way to build a repeating action. Loops allow you to reduce the number of actions you list in your action sequence, while maintaining the number of repetitions you want.<p>For example, suppose you want to draw 1,000 boxes in a document. One way of doing that is to add 1,000 Create Rectangle actions to your action sequence. A more efficient way is to add an iterative loop to your action sequence that performs the Create Rectangle action 1,000 times. Either way, you end up with the same number of boxes in your documents, but the former approach yields a much longer action sequence than the latter.<p>The number of times a loop executes can be based on the following:<ul><li>A number that specifies how many times the loop should be executed. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_iterative_loop">Iterative loop</a>.<li>The number of files in a folder. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_file_loop">File loop</a>.<li>The number of available values for a parameter. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_parameter_loop">Parameter loop</a>.<li>The boolean value of a condition. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_do_while_loop">Do/while loop</a>.<li>The number of an object type. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_object_loop">Object loop</a>.</ul><p>In each case, the loop executes a set of actions (the actions within the loop) based on a condition specified by the loop statement. Loops can be found under the Action Sequences and Loops node in Source Components.<h3><a class="anchor" id="id_iterative_loop"></a> Iterative loop</h3><p>An iterative loop is a sequence of actions that repeats the number of times specified in the loop action. The Iterative Loop action has an Iterations parameter that controls how many times the actions in the loop are executed.<p><b>Building an iterative loop</b><p>In this procedure, the action sequence creates a new document five times, using an Iterative loop:<ol type="1"><li>Clear the Sequencer. From Actions &gt; Doc Actions, add a Close All Docs action.<li>From Action Sequences and Loops, add an Iterative Loop action to the Action Sequence. By default, the loop is set to run once.<li>Edit the loop, and set the Iterations parameter to 5.<li>Add a New Doc action to the action sequence, which should be nested underneath Iterative loop: <div class="image"><img alt="itk-guide-15.gif" src="itk-guide-15.gif" /></div><li>Save to a convenient location, and execute the script. Five new documents should be created. This script is in the examplefiles folder, named iterative-loop.xml.</ol><p><b>Practice using iterative loop</b><p>Create an action sequence using Iterative Loop to do the following:<ul><li>Create five documents of two pages each. In each document, add a story that spans two pages, filled with placeholder text. Hint: if you use Link From Text Frame, you may have to use Get Story From Text Frame to get the story to fill with placeholder text, unless you used custom variables to refer to the outputs from New Story. For one solution, see iterative-loop-stories.xml.<li>Advanced: Use an Iterative Loop to create 12 rectangle page items, each 8 picas square, with 2 picas between them, on one page, starting at the top-left corner (X=3 picas, Y=3 picas). Arrange the boxes so there are four across and three deep. For one solution, see iterative-loop-tiled-boxes.xml.</ul><h3><a class="anchor" id="id_file_loop"></a> File loop</h3><p>A file loop is a sequence of actions that executes for all files in a specified location of a specified file extension.<p>When using a File Loop action, you specify which folder to target and which file extension to look for in the folder. The default folder is the build/qa folder, and the default file extension is INDD, native InDesign documents.<p>You can use a file loop if you want to quickly place all graphics of the same type into a document.<p><b>Constructing a file loop</b><p>In this procedure, a file loop is used to perform an Place File action on each file with the &quot;tif&quot; file extension in the examplefiles/images folder.<ol type="1"><li>Clear the Sequencer, and add a Close All Docs action.<li>Add a New Doc action, and add a Get Nth Page action to your action sequence.<li>From Variable Operations, add an Output Point action, starting with X=3 picas, Y=3 picas.<li>From Action Sequences And Loops, add a File Loop to the action sequence.<li>Edit the File Loop, and set the File(s) in Folder value to the path of the examplefiles/images folder. Edit the File Extension value to be tif.<li>Add a Place File at Point in the context of the File Loop (nested in its scope within the action sequence), and specify the input variable to be Point, and the output variable from the Output Point action you added above the File Loop. Do not bother to set the File parameter of the Place File at Point action, because it will be set by the File Loop.<li>Add an Offset Point, with input variable Point and offset by X=2 picas, Y=3 picas.<li>Save to a convenient location, and execute the action sequence. You should see a variety of images placed on the first page of a new document. This script is in the examplefiles folder, named file-loop.xml. <div class="image"><img alt="itk-guide-16.gif" src="itk-guide-16.gif" /></div></ol><p><b>Practice using file loops</b><p>Try this using file loops and different types of actions.<p>Try the task in &quot;Constructing a file loop&quot; (in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_file_loop">File loop</a>), but use the CurIter output variable of the loop sequence to create a unique place point for each image. Hint: Use actions from Variable Operations, like Math, if you want to use div (/) or modulo (%) operators to create a tiled layout.<h3><a class="anchor" id="id_parameter_loop"></a> Parameter loop</h3><p>A parameter loop is a sequence of actions that executes for each available value of a particular action. Parameter loops are helpful when you want to apply each available value in a list or combo box. For example, when you create a new document with InDesign Roman, you have 11 page-size parameters to choose from (Legal, Letter, A5, etc.). If you want to create a new document for each available size, you could construct a parameter loop using the Page Size values of the New Document dialog.<p><b>Constructing a parameter loop</b><p>In this example, the action sequence draws a line on a page, selects the line, and executes a parameter loop over the Stroke Type values in the Stroke palette to apply each type to the selected line:<ol type="1"><li>Bring up the Stroke palette, and choose Show Options to show the stroke drop-down widget list.<li>Load the draw-line.xml session file from the examplefiles folder.<li>From Action Sequence And Loops, add a Parameter Loop action to the action sequence. Make sure the action is added at the bottom of the sequence.<li>Nested inside the Parameter Loop action in your action sequence, add the action(s) you want to execute. To iterate the stroke types that would be available to an end user, open the Loaded UI Extensions node in the Source Components panel, and navigate to Stroke Palette &gt; Stroke Actions &gt;&gt; Type: Stroke Drop Down. Add the action to your action sequence.<li>Edit the Test Entry parameter of the Parameter Loop action, to execute over the List Value of the Stroke List action. Any action nested under the Parameter Loop can be selected for a parameter loop: <div class="image"><img alt="itk-guide-17.gif" src="itk-guide-17.gif" /></div><li>Save to a convenient location, and execute the action sequence. You should see the application cycle through the different stroke types and apply them in turn to a line. This script is in the examplefiles folder, named stroke-line.xml.</ol><h3><a class="anchor" id="id_do_while_loop"></a> Do/while loop</h3><p>Do/while loops execute a series of actions while a specified condition is true. There are two distinct types of do/while action:<ul><li>A do/while variant, where a condition, the result of a logical expression, is evaluated after the loop, meaning the actions in the loop are executed at least once: <div class="fragment"><div class="line">Do { &lt;execute actions...&gt; } While (condition)</div></div><li>The while variant, where a condition is evaluated before the loop, meaning it is possible for the actions in the loop not to be executed at all: <div class="fragment"><div class="line">While (condition) { &lt;execute actions...&gt; }</div></div></ul><p>A do/while loop is controlled by four parameters, described in the following table. These specify whether the loop is a do/while variant or a while variant, and the logical expression that controls the loop&#39;s execution.<table class="doxtable"><tr><th>Parameter </th><th>Meaning </th></tr><tr><td>Do/while </td><td>Specifies whether the loop is the do/while variant or while variant. The while variant evaluates the condition first, before executing. The do/while variant executes the actions in the loop at least once before evaluating the condition. </td></tr><tr><td>Operator </td><td>The evaluative statement between the left value and right value (see the following figure). Operator values can be Equal, Not Equal, Less Than, Less Than or Equal To, Greater Than, or Greater Than or Equal To. </td></tr><tr><td>Left value </td><td>The variable or value that precedes the operator statement (see the following figure). </td></tr><tr><td>Right value </td><td>The variable or value that follows the operator statement (see the following figure). </td></tr></table><div class="image"><img alt="itk-guide-18.gif" src="itk-guide-18.gif" /></div><p>When constructing a do/while loop, you evaluate the relationship between one entity and the other; for example, whether value &quot;a&quot; is greater than value &quot;b,&quot; or the logical expression (a &gt; b). When evaluating expressions containing a logical operator (in this case, &gt;, greater than), you need to consider the type of variable on either side of the operator, to be sure you are evaluating an expression that makes sense. The variables on either side of the logical operator (also called operands) are represented by the left-value and right-value parameters.<p><b>Creating a do/while loop</b><p>This procedure creates a page item and pastes it repeatedly, until there are six page items in the spread:<ol type="1"><li>Construct an action sequence based on new-default-doc.xml. Save it to a convenient location, and rename the action sequence to be Do-While-Paste.<li>From Page Item actions, add a Create Rectangle action after the Get Nth Page action.<li>From Page Item actions, add a Select Page Item action after the Create Rectangle action.<li>From UI Actions, add a Menu action after the Select Page Item action. Edit the Commands parameter of this Menu action to be Edit &gt; Copy.<li>From Spread actions, add a Get Nth Spread action after the Menu action, to acquire the first spread (at index 0) in the document.<li>From Spread actions, add a Get Num Items on Spread action after the Get Nth Spread action. Edit the Result parameter of the Get Num Items on Spread action, and change it from Value to NumItemsOnSpread. <div class="image"><img alt="itk-guide-19.gif" src="itk-guide-19.gif" /></div><li>From the Action Sequences and Loops, insert a Do/While Loop action after the Get Num Items on Spread action. We will edit the parameters of this Do/While Loop action to set up the conditions for it to evaluate. Change the name of the action to Paste-Loop.<li>Specify the type of loop required. Edit the Do/While parameter of the Do/While Loop action, setting it to do/while; note the default value for this parameter is while. In this procedure, we require the do/while variant, because we want to paste at least one time before checking whether we pasted enough page items.<li>Specify the operator that will produce the desired behavior. Edit the Operator parameter of the Do/While Loop action, and set the operator value to Less Than. In this case, we will terminate when there are six page items in the spread; we want the loop to iterate while the number of page items is less than six.<li>Edit the left-value parameter of the Do/While Loop action. The left value should be the number of page items on the spread of interest. This is referred to by NumItemsOnSpread. Set the Variable field of the left-value parameter to the NumItemsOnSpread. If you set only the Value field of the left-value parameter, the variable name is treated as a string literal, and your loop will not iterate as intended.<li>Edit the right-value parameter of the Do/While Loop action. We want six page items in the spread; therefore, enter 6 for the Value field. Now that we have set up the parameters for our Do/While loop, we need to specify the actions to execute.<li>Nested within the do/while loop, we will add an action to paste the selected page item. From UI Actions, add a Menu action. Edit the Commands parameter of this Menu action to be Edit &gt; Paste.<li>Again nested within the do/while loop, we need to count the number of items on the spread again. If we do not add this action, our loop might run infinitely, because NumItemsOnSpread always would be 1. The Do/While Loop action guards against this by providing a check against infinite loops, turned on by default. <div class="image"><img alt="itk-guide-20.gif" src="itk-guide-20.gif" /></div><li>Save the action sequence, and execute. You should observe six rectangle page items on the spread (though some may be on top of others, because they are pasted on the same location). This script is in the examplefiles folder, named do-while-paste.xml.</ol><h3><a class="anchor" id="id_object_loop"></a> Object loop</h3><p>An object loop loops over each object type specified. An object type could be anything in the document: pages, lines, boxes, words, etc. When you create an object loop, you are telling the action sequence to perform the actions nested in the scope of the loop on every object of the specified type.<p>When building an object loop, you must be aware of the parameters that control the behavior of the loop, listed in the following table. These specify the type of container object you want to look inside, the type you want to iterate over within a container object, and the range of container objects over which you want to search. You can think of the specification controlling the behavior of the object loop as a query.<table class="doxtable"><tr><th>Parameter </th><th>Meaning </th></tr><tr><td>Finder Type </td><td>The type of container in which you want to search. For example, you would look for inline graphics inside a Story or Table, but you would look for Stories or Swatches inside a Document. </td></tr><tr><td>Find Object of Class </td><td>The object type for which you want to search. </td></tr><tr><td>Find In Target </td><td>The object variable in which you want to search. For example, if you want to search only for text-frame objects on page 3, you would search only within that page variable. </td></tr></table><p><b>Building an object loop</b><p>In this example, we use an object loop to apply a new stroke weight and type to a collection of page items. Follow these steps; the following figure summarizes these actions:<div class="image"><img alt="itk-guide-21.gif" src="itk-guide-21.gif" /></div><ol type="1"><li>Load the new-default-doc.xml session file, and save it to a convenient location. Change the name of the action sequence to Object Loop Stroker.<li>From Actions &gt; Page Items Actions, add a Create Line action after the Get Nth Page action, to draw a page item on the first page of the document. Set the bounds to X=1 inch, Y=1 inch, W=2 inches, H=2 inches.<li>From Page Items Actions, Add a Create Rectangle action after the Create Line action. Set the bounds to X=1 inch, Y=4 inch, W=2 inches, H=2 inches.<li>From Page Items Actions, Add a Create Oval action after the Create Rectangle action. Set the bounds to X=4 inch, Y=1 inch, W=2 inches, H=2 inches.<li>From Page Items Actions, Add a Create Regular Polygon action after the Create Oval action. Set the bounds to X=4 inch, Y=4 inch, W=2 inches, H=2 inches.<li>From Action Sequences and Loops, add an Object Loop action to the sequence, immediately after the Create Regular Polygon action. We will edit the Object loop action to iterate the page items in the document.<li>For the Object Loop action, set the Finder Type parameter to Document Content Finder, by choosing it from the drop-down list.<li>For the Object Loop action, set the Find Object of Class parameter to SplineItem, by choosing it from the drop-down list.<li>For the Object Loop action, set the OutputObject parameter to MyObject, rather than the default, Object.<li>From PageItem Actions, add a Select Page Item action. This action should be nested within the Object Loop action above. Specify MyObject as the Target page Item parameter of the action.<li>Open the Loaded UI Extensions node in the Source Components panel, and navigate to Stroke Palette &gt; Stroke Actions &gt;&gt; Type: Stroke Drop Down. Add the action to your action sequence, nested inside the Object Loop action. Edit the action you just added, and set a List Value of Wavy from the drop-down list.<li>Open the Loaded UI Extensions node in the Source Components panel, and navigate to Stroke Palette &gt; Stroke Actions &gt;&gt; Weight: Combo Box. Add the action to your action sequence, nested inside the Object Loop action. Edit the action you just added, and set the Combo Box value to 4.<li>Save to a convenient location, and execute the action sequence. You should see four page items created with a wavy stroke. This script is in the examplefiles folder, named object-loop-stroker.xml.</ol><h2><a class="anchor" id="id_logic_sequences_and_clusters"></a> Logic sequences and clusters</h2><p>Logic sequences allow you to control the flow of an action sequence, using if, else-if, and else statements. Informally, an if statement involves a test to see whether a condition holds. If it does, the AAT executes one set of actions; otherwise, it does something else.<p>The practical topics covered in this section include the following:<ul><li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_constructing_a_logic_sequence_if_statement">Constructing a logic sequence: if statement</a>.<li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_constructing_a_logic_sequence_cluster_elseif">Constructing a logic-sequence cluster: else-if</a>.</ul><p>Conditional expressions and decisions based on the results of these expressions are common. For example, suppose you walk past the cinema with 5 euros in your pocket. If the price of the ticket is less than or equal to 5 euros, you buy a ticket; if the price is higher, but you have a friend with you, you borrow some money and then buy a ticket; and if you do not have a friend with you, you do not buy a ticket. There are several conditions you would evaluate one after the other. Using AAT terminology, this is a logic sequence.<p>Expressions in a logic sequence begin with &quot;if,&quot; &quot;else-if,&quot; or &quot;else.&quot; When writing conditional expressions for AAT, you must follow these rules:<ul><li>The logic sequence must start with &quot;if&quot;; it cannot start with &quot;else&quot; or &quot;else-if.&quot;<li>An if statement does not need to be followed by an else or else-if statement, if your evaluation does not require it. That is, you do not have to supply a default or fallback set of actions when the condition of interest does not hold.</ul><p>The operator within a conditional expression in a logic sequence can be any of the following: Equal, Not Equal, Less Than, Less Than or Equal To, Greater Than, or Greater Than or Equal To. Logical sequences can be nested, to create relatively elaborate (though possibly hard to understand) logic.<p>The simplest useful logic sequence, written in some notional scripting language, is something like this: <div class="fragment"><div class="line">If (a &gt; c) then-do-this</div></div><p>This is an if statement, consisting of a keyword &quot;if,&quot; a condition (in this case, &quot;a &gt; c &quot;), and operations to perform (in this case, &quot;then-do-this&quot;). The operations indicated by then-do-this are performed only if the condition is true, making (a &gt; c) a decision point for this example.<p>Here is an example of a slightly more elaborate logic sequence: <div class="fragment"><div class="line">If (a &gt; c) then-do-this </div><div class="line"> else if(a &gt; b) then-do-that</div><div class="line"> else do-the-other</div></div><p>The action (do-the-other) is performed if &quot;a&quot; fails to be greater than either &quot;b&quot; or &quot;c.&quot; For example, if a=1, b=3, and c=2, the do-the-other action is performed.<p>Building a logic sequence is like building a do/while loop, described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_do_while_loop">Do/while loop</a>. The Action Sequences and Loops node in the Source Components panel contains an action named Logic Sequence. You can parameterize an instance of this action with a left value (left operand), operator, and right value (right operand). See the following table for information about these parameters. You also need to specify the type of the Logic Sequence; that is, whether it is an if, else-if, or else statement.<table class="doxtable"><tr><th>Parameter </th><th>Meaning </th></tr><tr><td>Operator </td><td>Operator can be Equal, Not Equal, Less Than, Less Than or Equal To, Greater Than, or Greater Than or Equal To. </td></tr><tr><td>Left Value </td><td>Left operand. The variable or value that precedes the operator statement; for example, in the statement (A &gt; B), A is the left value. </td></tr><tr><td>Right Value </td><td>Right operand. The variable or value that follows the operator statement; for example, in the statement (A &lt; B), B is the right value. </td></tr></table><h3><a class="anchor" id="id_constructing_a_logic_sequence_if_statement"></a> Constructing a logic sequence: if statement</h3><p>A fundamental type of logic sequence is an if statement, where we perform an operations if a specified condition is true.<p>This procedure creates a new document and a story in it, fills it with placeholder text, and changes the point size of the text to a random value. If the point size of text in a given text frame is greater than a threshold value (in this case, the default point size for placeholder text, 12 pts), we assume that the text is overset. In that case, an additional linked text frame is created to hold the overset text. An if statement is used to determine whether a linked text frame is needed, based on the point size of the text in the text frame under consideration.<ol type="1"><li>Load the new-default-doc.xml session file, and save it to a convenient location.<li>From Story actions in the source component, add a New Story action after the Get Nth Page action. Name the output story Story01, and name the text frame TextFrame01. Set the Bounds parameter of the action, with units=picas, X=3, Y=3, W=20, H=60.<li>From UI actions, add a Menu Action to fill with placeholder text, after the New Story action. Edit the <a class="el" href="class_command.html">Command</a> parameter of the Menu Action, and look under the Type Menu node.<li>From Page Item actions, add a Select Page Item action after the Menu action. Set the Target Page Item parameter of this action to TextFrame01.<li>From the Variable Operations node, add a Random Number after the Select Page Item action. Edit the parameters of this action, setting the Min parameter to 8 and the Max parameter to 20. Set the Result parameter to a custom variable named RandPointSize. Edit the Real or Integer parameter to be Int32, so only integers for (random) point sizes are produced.<li>From Actions &gt; Variable Operations, add a String Action. Set the In Variable field of the Input String parameter to RandPointSize, and set the Output String to randStr. Set the Action Type to None.<li>Add another String Action. Set the Value field of the Input String to &quot;pt&quot; (space intentional). Set the In Variable field of the Target String parameter to randStr; this target string is the base string to which the AAT appends the Input String. Set the Output String to randStr. Set the Action Type to Append.<li>From Loaded UI Extensions, add Character Palette &gt;&gt; Character Actions &gt;&gt; 12 pt Combo Box after the Random Number action. Edit the Combo Box parameter, and set the In Variable to randStr. The randStr variable holds the value of RandPointSize, with the string &quot;pt&quot; appended to it, which is the expected format when setting this particular Combo Box.<li>Insert a Logic Sequence action after the 12 pt Combo Box action. Verify the parameter Logic Type of this action is set to if.<li>The default point size for placeholder text is 12 points, so assume a point size greater than this value is overset. This is only an approximation, but it is sufficient for our example. Edit the Operator parameter of the Logic Sequence to be Greater Than.<li>Edit the Left Value parameter of the Logic Type action, setting the In Variable to RandPointSize and Var Type to Int32.<li>Set the Right Value parameter of the Logic Type action to 12, and set Var Type to Int32.<li>Nested within the if action, add a New Story action. Set Output Story to Story02 and Output Frame to TextFrame02. Set the Bounds parameter of the action, with units=picas, X=28, Y=3, W=20, H=60.<li>From Actions &gt; Text Frame Actions, again nested within the if action, add a Link From Text Frames action, immediately after the new New Story action. Set the From Text Frame parameter to TextFrame01 and the To Text Frame parameter to TextFrame02.<li>Save to a convenient location, and execute the action sequence. This script is in the examplefiles folder, named if-link.xml.</ol><h3><a class="anchor" id="id_constructing_a_logic_sequence_cluster_elseif"></a> Constructing a logic-sequence cluster: else-if</h3><p>A logic-sequence cluster supports else-if logic. Suppose we want to modify the procedure in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_constructing_a_logic_sequence_if_statement">Constructing a logic sequence: if statement</a>, so when the point size of text is less than 12 points, we fit the frame to the content. Follow these steps:<ol type="1"><li>Load the session file named if-link.xml, and save it to a convenient location.<li>Edit the Random Number action in the action sequence, to set the Min parameter to 4 and the Max parameter to 16, increasing the chance of underset text.<li>From Logic Sequences, insert an action of type Logic Cluster Sequence. This should be positioned immediately after the Character... action and before the If... (Logic Sequence) action.<li>Nest the original If ... (Logic Sequence) inside the new Logic Sequence Cluster action, by dragging and dropping within the Sequencer. You will know when you have nested the If ... (Logic Sequence) correctly by closing the Logic Sequence Cluster node, which should hide the If ... (Logic Sequence) when it is correctly nested.<li>Select the If ... (Logic Sequence) action, and duplicate it. This should create a duplicate action within the Logic Sequence Cluster.<li>Edit the second If action. Change the Logic Type parameter of the second If... to &quot;else if,&quot; because we want to make sure (RandPointSize &lt; 12) is evaluated, even when we know RandPointSize is not greater than 12, because we will not take any action if RandPointSize is 12.<li>Now the action should appear as Else.... Change the Operator of this action from &quot;greater than&quot; to &quot;less than.&quot;<li>Edit the sequence of actions within the Else... (Logic Sequence) action. Remove the New Story and Link From Text Frame actions, since we will not create a new text story when the point size is less than 12 pts.<li>From UI Actions, add a Menu Action, and edit the <a class="el" href="class_command.html">Command</a> parameter to the path Object Menu &gt; Fitting &gt; Fit Frame to Content.<li>Save to a convenient location, and execute the action sequence. Run this action sequence several times, and you should find that the linked frame is created when the point size is greater than 12 pts, but below this value, the frame is fitted to the content. This script is in the examplefiles folder, named if-link-else-fit.xml.</ol><h2><a class="anchor" id="id_logging_and_debugging"></a> Logging and debugging</h2><p>A principal objective of writing action sequences is automating some of your testing. As you write and run your tests, you may encounter the following bugs:<ul><li>Bugs in the plug-ins you are testing.<li>Bugs in your action sequences; the sequences may not do exactly what you intended.</ul><p>This section describes the logging features of AAT, how to use the AAT logs in your own testing, and how to determine the likely location of defects you observe during testing with the AAT.<h3><a class="anchor" id="id_log_files"></a> Log files</h3><p>The objectives of this section are as follows:<ul><li>Identify what logs tell you.<li>Identify how you can use the logs to help develop tests.<li>Learn to use the logs to identify bugs.</ul><p>Log files are an integral part of using the AAT to validate tests. Automating certain tasks saves time in several ways and allows you to focus on other testing areas that cannot benefit from automation; however, simply running an action sequence does not absolve you from ever looking at that area again, and this is where log files can come into play.<p>Each time an action sequence is run, two log are created that report on the status of the test while it ran:<ul><li>QASessionLog.txt/xml.<li>AATSessionLog.txt.</ul><p>These logs record information about the test that ran, including when it started and when it finished, build, platform, what steps (actions) were performed, and any errors that occurred. By keeping track of this information, you can use your action sequences to verify different test criteria, like performance, functionality, and errors.<p><b>AAT session log</b><p>The AAT session log, shown in the following figure, contains an account of every action and its supplied parameters of the action sequence, as well as information about the time it took the sequence and each of its individual actions to complete. Viewing this log is another method of determining which actions were run during the test; the other method is inspecting the action sequence in the Action Automation Editor. <div class="image"><img alt="itk-guide-22.gif" src="itk-guide-22.gif" /></div><p><b>QA session log</b><p>The QASessionLog.txt/xml log files list errors that occurred during the test, as well as build and machine information. These are in the qa folder.<p>The QA session log includes errors encountered because of a problem with your action sequence, errors caused by bugs in the code you are testing, and/or forced errors.<p><b>Action sequence errors</b><p>While you are learning the tool, the most common type of error reported by the AAT is errors in your action sequence. These errors can arise for several reasons. If you construct the sequence of actions (Open Doc, Save Doc), the AAT tool reports an error something like this:<div class="fragment"><div class="line">Error: Trying to save a <span class="keyword">new</span> or converted document. You must call Save As</div></div><p>This is because the Save action is valid only for a modified document. The error provides you with an attempt at a resolution, to substitute another action for the inappropriate Save Doc. You can find a transcript of the error message in the action sequence if you inspect QASessionLog.txt. You also can find a detailed description of the behavior of the AAT action behind each action while the test ran, in AATSessionLog.txt.<p><b>Diagnosing and fixing an error</b><ol type="1"><li>Load the aat-error.xml session file from the examplefiles-errors folder. Execute the action sequence, and observe the error.<li>Inspect QASessionLog.txt and AATSessionLog.txt, which are in the QA/logs/InDesign folder. This is the QA folder that is a peer of the installation folder for InDesign, not the one in the saved data folder. For more information, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_where_is_the_qa_folder_i_keep_hearing_about">Where is the QA folder I keep hearing about?</a>.<li>Using your judgment and the Action Sequence Editor, fix the problem, and save the action sequence to a convenient location.<li>Execute the action sequence again with the edits, and check the logs again to see if any errors were reported this time.</ol><p><b>Creating custom error messages</b><p>Built into the AAT is an action called Report Error, available under the Actions &gt; Custom Actions node. This action allows you to write into the QASessionLog.txt file, by setting a parameter named Error String. The action also generates a warning dialog when the action sequence completes, indicating there are errors in the action sequence.<p><b>Using a custom error to indicate success or failure</b><p>In the following procedure, we consider how to use the Report Error action to report success or failure of a test. A minimal document is created, with a page item in the pasteboard, to the left of the first page of the document. A logic-sequence cluster is used to write a custom error, indicating whether the page item is on the first page of the document.<ol type="1"><li>Load create-rect-in-pasteboard.xml from the examplefiles folder. The sequence creates a new document, switches to the rectangle tool, and draws a box. Save the action sequence to a convenient location with a different filename.<li>Select the last item in the sequence, the Click Drag action. From the Page Item action, add a Get Num Items on Page action at the end of the action sequence. Edit the action, and set the Result parameter, the output variable, to a custom variable named NumItemsOnPage. This variable is used later in a Logic Sequence.<li>From Action Sequences and Loops in Source Components, add a Logic Sequence Cluster action.<li>Nested in the scope of the Logic Sequence Cluster, add a Logic Sequence action from the Action Sequences and Loops node. Edit the Left Value, Operator, and Right Value parameters of the action, to construct an If statement NumItemsOnPage &gt; 0. To make this explicit, the Operator parameter should be Greater Than, and the Left Value should take an In variable of NumItemsOnPage. The Right Value need not change, as the value of 0 is the default. Set the Var Type to Int32 for the Left Value and Right Value parameters.<li>Nested in the scope of the If... (Logic Sequence), add a Report Error action, from the Custom Actions node. Edit the action and set the Error String parameter to &quot;Error: Rectangle is reported as a page item on first page.&quot;<li>From Action Sequences and Loops, add another Logic Sequence action beneath the If... (Logic Sequence) action but on the same level. You can achieve this by closing the If... node in the tree view of the sequence and leaving it selected while you add a new Logic Sequence action. Both these Logic Sequence actions should be nested inside the logic-sequence cluster. Edit the Logic Type parameter of the action just added to be &quot;else.&quot;<li>Nested within the scope of the Else statement, add another Report Error action. Set the Error String parameter value to. &quot;Success: page item not reported on first page.&quot;<li>Save the session file, and execute. You should see an error report with the string &quot;Success...&quot; that was entered in the previous step. This script is in the examplefiles-errors folder, named custom-error.xml.</ol><p>The Report Error action can be used in developing action sequences. By reporting values, names, and other variables to the log file, it can help determine the state of objects that otherwise may be confusing.<p><b>Custom error messages using string actions</b><p>The following procedure uses String Actions to demonstrate how to construct more informative error messages. After the action sequence executes, the error message reports how many page items are on the first page, rather than just success or failure.<ol type="1"><li>Load custom-error.xml from the examplefiles folder, and save it to a convenient location with a different filename.<li>From Variable Operations, add a String Actions action nested within the scope of the first if statement. The action should be added immediately above the Report Error action that is there already. By selecting the If... statement before adding the new action, you can add the action at the correct point in the sequence.<li>Edit the String Actions action just added. Set the value of the Target String parameter to &quot;Error: AAT reports the number of page items is &quot; (the space at the end of string is intentional). Set the In Variable of the Input String parameter of the action to NumItemsOnPage. Ensure the Action Type parameter is set to Append, which is the default. Set the Output String to be CustomErrStr, a new custom variable.<li>Edit the Report Error action. Set the In Variable of the Error String parameter to CustomErrStr.<li>Modify the existing Click and Drag action in the action sequence to create a page item that is now on the first page. To do this, set the Start Point to X=1 inch, Y=1 inch and the End Point to 3 inch, 3 inch.<li>Save and execute the action sequence. You should see a custom error message reported. This script is in the examplefiles-errors folder, named custom-error-string-actions.xml.</ol><p>String Actions can be used to build logging statements based on different types of data, including variables, strings, and integers.<h3><a class="anchor" id="id_debugging_and_fixing_action_sessions"></a> Debugging and fixing action sessions</h3><p><b>Developing a methodology</b><p>There is a basic methodology you can use to ensure your action sequence works in the way you intend, by asking questions as actions are added:<ul><li>What is the target? Does it need to be acquired; for example, using Get Nth &lt;object&gt;?<li>Is the target really the object reference needed?<li>Is a dialog or some other user interface needed to complete the action?<li>What controls a given loop? Does it need to be specified each time around the loop, or does the loop statement take care of that?</ul><p>When you run into problems with your action sequence, the log files may provide answers. For example, if you want to create a new page item but do not have a page-object reference, an error is reported that the object does not exist.<p>If the action sequence does not generate an error but fails to do what you intend, it may be harder to determine the source of the problem. Perhaps there is a page-object reference already in the action sequence, but for a page other than the one intended. Experience with the AAT tool makes it easier to solve problems.<p>You can nest a series of actions in an action-sequence cluster. This can allow you to isolate and debug sets of actions, as well as remove sequences quickly if you no longer need them.<p><b>Abort on error</b><p>Built into all actions is a parameter called Abort on Error. By default, this parameter is set to No. When it is set to Yes for a specific action, if the action fails for any reason, the whole test is terminated and an error is reported.<p>For example, suppose an action sequence has a Get Nth Page action, which may try to acquire a page not available in the document. If you set the Abort On Error parameter to Yes for the Get Nth Page action, you can terminate the action sequence whenever the Get Nth Page fails.<p>You should set the Abort on Error parameter to Yes for actions that are critical to what you are validating. Also, use it to help troubleshoot your action sequences as you develop them.<p><b>Break</b><p>Another parameter that is useful for debugging is Break. Like Abort on Error, Break is set to No by default. When it is set to Yes for a specific action, it serves as a break point of the Session: AAT stops at the action and waits for user intervention. You can press Option Alt+S to step to the next action, or press Option Alt+R to restart the program. If the action is within a loop, it stops every time the loop executes.<p><b>Working with the AAT script debugger</b><p>AAT script debugger is a separate panel that displays the same session file as the one displayed in the Action Automation Editor. Changes made in either window effect the other. The debugger is useful when you debug an AAT script. When you set a break point in the action sequence using the Break parameter and execute the session, the Action Automation Editor disappears. When the AAT stops at the action, the action is highlighted in the AAT script debugger, and if you press Option Alt+S, the highlight moves to the next action, showing what is going on in your action sequence.<h2><a class="anchor" id="id_automated_tests_user_interface_or_commands"></a> Automated tests: user interface or commands?</h2><p>The objectives of this section are as follows:<ul><li>Identify differences between command-based and user-interface-based action sequences.<li>Construct a user-interface-based action sequence.</ul><p>Session files can include two types of actions: command actions and user-interface actions; see the following tables. Each action type has benefits and drawbacks, and understanding these will help you write tests faster and more efficiently. For example, user-interface-based actions tend to be slower, but they simulate end-user actions more convincingly.<p>The following table shows the benefits of command and user-interface actions:<table class="doxtable"><tr><th>User-interface actions </th><th><a class="el" href="class_command.html">Command</a> actions </th></tr><tr><td>Reproduces end-user actions by automating palette and dialog widgets and window operations like click and click-and-drag. </td><td>Quick and straightforward shortcut for the provided actions you want to run that would take more actions if done via the user interface. </td></tr><tr><td>Accompanying user interface for requested actions can be monitored while the test runs. </td><td>Outputs object references that can be referenced later in the automation sequence. </td></tr><tr><td>Most InDesign features are accessible via user-interface actions. </td><td>Command-based automation runs faster than user-interface-based automation. </td></tr></table><p>The following table shows the drawbacks of command and user-interface actions:<table class="doxtable"><tr><th>User-interface actions </th><th><a class="el" href="class_command.html">Command</a> actions </th></tr><tr><td>Requires more actions for the desired result. </td><td>Does not accurately reproduce end-user actions in the application. </td></tr><tr><td>While building tests, the black-box tester must acquire dialogs and palettes. </td><td>A limited number of commands are written relative to the number of available features in InDesign. </td></tr><tr><td>User-interface-based automation takes longer to complete than command-based automation. </td><td><a class="el" href="class_command.html">Command</a> actions do not display the accompanying user interface for the requested action. </td></tr></table><h3><a class="anchor" id="id_command_actions"></a> Command actions</h3><p><a class="el" href="class_command.html">Command</a> actions execute without involving the user interface when they are running; for example, the action to create a New Doc is a command action. There is an application user interface (the New Document dialog) to create a new document, but it is not involved when the New Doc action executes. With the exception of the actions listed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_user_interface_actions">User-interface actions</a>, the actions under the Actions node of Source Components are command actions.<p><a class="el" href="class_command.html">Command</a> actions are intended to enable black-box testers to build tests quickly, when the application user interface associated with those actions is not important to the test. <a class="el" href="class_command.html">Command</a> actions invoke code written by white-box testers (AATActions), which in turn uses the InDesign API directly.<h3><a class="anchor" id="id_user_interface_actions"></a> User-interface actions</h3><p>User-interface actions include menu commands, key presses, and mouse clicks. User-interface actions also include any actions that set data in widgets. When building an action sequence that reproduces the actions an end user would take with the user interface, this is described as &quot;testing through the user interface.&quot; (See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_working_with_the_user_interface">Working with the user interface</a>).<h3><a class="anchor" id="id_creating_a_new_document_with_command_and_user-interface_actions"></a> Creating a new document with command and user-interface actions</h3><p>The following procedure loads and runs a session file that creates a new document using the New Doc command and using user-interface actions. This example illustrates the differences between using commands and the user interface.<ol type="1"><li>Load the create-new-doc-two-ways.xml session file from the examplefiles folder. Expand the Action Sequences so you can view the actions they contain.<li>Inspect the first action sequence, New Doc: Commands. It creates a 10-page document with facing pages turned off, with 1 New Doc action parameterized as required.<li>Inspect the next action sequence, New Doc: UI. It has the same intent as above but requires several more steps. The extra steps automate the individual actions an end user would perform to create the 10-page document, with facing pages turned off.<li>Execute the sequence.</ol><p>When the first action sequence (New Doc: Commands) executes, a new 10-page document is created. When the second action sequence (New Doc: UI) executes, the New Document dialog appears. The action sequence sets the state of widgets in the New Document dialog; for example, it modifies the state of the number-of-pages edit box and facing-pages check box to something other than the defaults.<h3><a class="anchor" id="id_building_command_and_user-interface_action_sequences"></a> Building command and user-interface action sequences</h3><p>The following two procedures create a cyan rectangle on the first page of a document. The first example uses command actions; the second, user-interface actions. The following figure shows the sequences side by side. <div class="image"><img alt="itk-guide-23.gif" src="itk-guide-23.gif" /></div><p><b>Cyan rectangle - command actions</b><ol type="1"><li>Clear the Sequencer. From Actions &gt; Doc Actions, add a Close All Docs action and a New Doc action. Add a Get Nth Page action, to acquire the first page.<li>From PageItem Actions, add a Create Rectangle action. Set the Bounds to X=1 inch, Y=1 inch, Width=3 inches, Height=3 inches.<li>From Swatch Actions, add a Get Nth Swatch action. Cyan is the fifth swatch in the swatch list, giving it an index of 4 (since the index is 0-based). Set the Swatch Index parameter of this action to 4.<li>From Swatch Actions, add an Apply Swatch to Page Item action. Set the Stroke parameter of this action to No.<li>Save to a convenient location, and execute. You should see a cyan rectangle created on the first page. A completed example of this is in the examplefiles folder, named create-cyan-rect-command-actions.xml.</ol><dl class="section note"><dt>Note<dd>This example has additional actions to set up the document unit and increment preferences, before the Get Nth Page action.</dl><p><b>Cyan box- user-interface actions</b><p>The main focus here is on how to create a page item with user-interface actions, and how to apply a swatch in the same way. To create the rectangle with user-interface actions, we need to switch tools to the Rectangle Tool. There are several ways to select the Rectangle tool:<ul><li>Use the keyboard shortcut &quot;m.&quot; To do this, we add the Key Press action from the UI Actions node and set its key press parameter to &quot;m.&quot;<li>Select the Rectangle Tool from Loaded UI Extensions &gt; Tools Palette, and locate the Rectangle Tool... action.<li>Select the rectangle tool from a menu. Add a Menu Action from Actions &gt; UI Actions. Set its command parameter value to Tools &gt; Rectangle Tool.</ul><p>In the following procedure, we select the tool through the Tools palette:<ol type="1"><li>Clear the Sequencer, and add a Close All Docs action and a New Doc action.<li>We need to provide a user-interface action to select the Rectangle Tool. Navigate through Loaded UI Extensions &gt; Tools Palette &gt;&gt; Tools Actions &gt; Rectangle Tool (M) Icon Action. Add this to the action sequence.<li>Add a Get Nth Page action and a Get Nth Window action. Since we want the window and the first page of the document, the defaults for each action are sufficient.<li>From Actions &gt; Window Actions, add a Get Nth Window action. From Page Actions, add a Get Nth Page action.<li>From Actions &gt; UI Actions, add a Click and Drag action, and click it to edit it. The action has Target Window and On Page parameters; the defaults of Window and Page, respectively, are sufficient.<li>Continue editing the Click and Drag action just added. Set the Start Point to 1 inch, 1 inch. Set the End Point to 4 inches, 4 inches.<li>Navigate to Loaded UI Extensions &gt; Swatches Palette &gt; Swatch Actions, and add the user-interface action that appears as Name List Box. Edit the action, setting the List Value parameter to C=100 M=0 Y=0 K=0, the 6th item in the drop-down list.<li>Save to a convenient location, and execute. You should see a cyan rectangle created. This script is in the examplefiles folder, named create-cyan-rect-ui-actions.xml.</ol><dl class="section note"><dt>Note<dd>For multiple document views, specify the document with Actions &gt; Doc Actions &gt; Make Document Active before the Click and Drag action.</dl><h3><a class="anchor" id="id_choosing_between_command_and_user-interface_actions"></a> Choosing between command and user-interface actions</h3><p>As the previous procedures illustrate, using user-interface actions for your automation can take several additional steps compared to the command-action equivalent. On the other hand, user-interface-driven automation has the major advantage of reproducing end-user actions more closely, so you can test your end-users&#39; code paths more effectively.<p>We recommend that you focus on building tests that run through user-interface actions, if you are simulating black-box testing. When deciding whether to use command actions or user-interface actions, use the following questions to guide your decision:<ol type="1"><li>What user interface needs to be tested? You may have been asked directly to test some functionality through the user interface; in that case, use user-interface actions.<li>Is there an existing command action for a particular operation? If there is no command action that can perform the required operation, you must use a user-interface action. Commands include actions frequently used in test cases, like New Doc or Create Rectangle. For features added by third-party plug-ins, for example, there are likely to be no command actions to exercise the features, but they still can be tested through user-interface actions. To write action sequences to test third-party code through the user interface, it may be necessary to acquire any third-party-specific user interface; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_working_with_user_interface_extensions">Working with user-interface extensions</a>.<li>Does one type of action (command or user interface) do something the other cannot? Both command actions and user-interface actions have limitations that may influence your decision to choose one over the other in a particular test case.</ol><h2><a class="anchor" id="id_working_with_the_user_interface"></a> Working with the user interface</h2><p>Several user-interface actions are available to manipulate the InDesign user interface. These can be found under Actions &gt; UI Actions in the Source Components panel. They include the following:<ul><li>Key Press - Presses the key or key plus modifiers specified.<li>Menu Action - Selects an item in a menu or pop-out menu.<li>Click Action - Clicks the mouse one or more times at the specified location.<li>Click and Drag Action - Clicks and holds down the mouse as it drags from the specified start point to the end point.</ul><p>To see a more complete list, inspect the actions nested under Actions &gt; UI Actions in the Source Components panel.<h3><a class="anchor" id="id_using_the_user-interface_actions_to_group_page_items"></a> Using the user-interface actions to group page items</h3><p>The following procedure uses a combination of user-interface actions in an action sequence that creates rectangle page items and groups them:<ol type="1"><li>Clear the Sequencer. Load the new-default-doc.xml session file, and save it with a different filename.<li>Select the Get Nth Page action in the Sequencer, to start adding actions at the end of the action sequence.<li>From Page Item Actions, add a Create Rectangle action. Set the Bounds to X=2 inch, Y=1 inch, Width=2 inches, Height=3 inches.<li>From Page Item Actions, add a Select Page Item action.<li>From UI Actions, add a Menu Action. Edit the action, and set the <a class="el" href="class_command.html">Command</a> Parameter to Window Menu &gt; Transform.<li>To rotate the page item, navigate to Loaded UI Extensions &gt; Transform Palette &gt; Transform Actions &gt; Transform Actions &gt; 0&Acirc;&deg; Combo Box (the one just above Rotation Angle Icon). Set the Combo Box Value parameter to 90 degree.<li>From Page Item actions, add another Create Rectangle action. Set the Bounds to X=5 inches, Y=1 inch, Width = 2 inches, Height=3 inches.<li>From Loaded UI Extensions &gt; Tools Palette, add a Selection Tool Icon action.<li>A Click and Drag action is added next. This action requires a Page and a Window target. The Page was acquired early in the sequence, and that object reference is still valid. From Actions &gt; Window Actions, add a Get Nth Window action.<li>From Actions &gt; UI Actions, add a Click and Drag Action. Edit it, setting the Start Point to X=1 inch, Y=1 inch and the End Point to X=7 inches, Y=8 inches.<li>Add a Key Press action to the bottom of the sequence. Edit the Key Press action. Set the Modifier parameter to Command/Ctrl, and set the Press Key value to &quot;g.&quot; Ignore the values in the drop-down list, which provide some special characters; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_key_presses">Key presses</a>.<li>Save and execute the session file. You should see two rectangles have been grouped. A completed example of this is in the examplefiles folder, named group-rects.xml.</ol><p>If the Click and Drag actions failed to select both page items, try to slow down the drag by increasing the &quot;Num Steps&quot; parameter of the action.<p>Click and Click and Drag actions can fail if palettes or dialogs obstruct the area of layout in which you want to click. Avoid having palettes in the way when running user-interface actions.<p>You also can suppress the AAT progress bar with a menu item on the QA menu. This is at the path QA &gt; Action Automation Tool &gt; Settings &gt; Suppress Progress Bar.<dl class="section note"><dt>Note<dd>For multiple document views, specify the document with Actions &gt; Doc Actions &gt; Make Document Active before the Click and Drag action.</dl><h3><a class="anchor" id="id_using_modifier_keys_with_the_key_press_action"></a> Using modifier keys with the key-press action</h3><p>Many keyboard shortcuts depend on keyboard modifiers. The Key Press action, under Actions &gt; UI Actions in the Source Components panel, can be parameterized with keyboard modifiers required to create the keystrokes for the keyboard shortcuts understood by InDesign, as shown in the following figure: <div class="image"><img alt="itk-guide-24.gif" src="itk-guide-24.gif" /></div><p>This procedure sends the key press Cmd+Option+n (Ctrl-Alt-n), which creates a new document without showing the New Document dialog:<ol type="1"><li>Clear the Sequencer.<li>Under Actions &gt; UI actions, add a Key Press action.<li>Edit the Key Press action. Set the Value field of the Modifier parameter to Command/Ctrl from the drop-down list. Type &quot;+Option/Alt&quot; (no spaces) after Command/Ctrl; see the following figure. <div class="image"><img alt="itk-guide-25.gif" src="itk-guide-25.gif" /></div><li>Continue to edit the Key Press action. Set the Value field of the Press Key parameter to the character &quot;n.&quot;<li>Save and execute. You should see a new document created, without the New Document dialog appearing. This script is in the examplefiles folder, named new-default-doc-ui.xml.</ol><h3><a class="anchor" id="id_key_presses"></a> Key presses</h3><p>In <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_using_modifier_keys_with_the_key_press_action">Using modifier keys with the key-press action</a>, a character &quot;n&quot; was entered as part of the keystrokes for the shortcut to create a new default document. Beside the basic alphanumeric characters, a Key Press action (under UI Actions) can be used to send the keystrokes that correspond to the keys like Enter (Return) and Delete. The following table shows so me keypress references.<table class="doxtable"><tr><th>Key </th><th>Value </th></tr><tr><td>Enter (Return) </td><td>\r </td></tr><tr><td>Delete </td><td>\b </td></tr><tr><td>Tab </td><td>\t </td></tr><tr><td>Home </td><td>\h </td></tr><tr><td>End </td><td>\e </td></tr><tr><td>Right Arrow </td><td>&gt; </td></tr><tr><td>Left Arrow </td><td>\&lt; </td></tr><tr><td>Up </td><td>\u </td></tr><tr><td>Down </td><td>\d </td></tr></table><p>To press more than one modifier key, a second modifier can be entered, exactly as it appears in the drop-down list for modifiers. In <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_using_modifier_keys_with_the_key_press_action">Using modifier keys with the key-press action</a>, the string &quot;+Option/Alt&quot; was appended to the modifier, to form the keystroke Cmd+Option+n.<p>If you enter a capital letter in the &quot;Press Key&quot; field, you do not need to enter Shift as a modifier. The same rule applies for the characters above number keys, like @ (shifted 2 on a US keyboard). <div class="image"><img alt="itk-guide-26.gif" src="itk-guide-26.gif" /></div><h3><a class="anchor" id="id_measurements"></a> Measurements</h3><p>The Action Automation Editor understands several abbreviations for units and measurements. For example, any of the abbreviations in the following table works when specifying bounds or other measurements.<table class="doxtable"><tr><th>Measurements </th><th>Abbreviations </th></tr><tr><td>Centimeters </td><td>cm, centimeters </td></tr><tr><td>Ciceros </td><td>cicero </td></tr><tr><td>Inches </td><td>in, ins, inch, inches </td></tr><tr><td>Millimeters </td><td>mm, millimeters </td></tr><tr><td>Picas </td><td>p, picas </td></tr><tr><td><a class="el" href="class_points.html">Points</a></td><td>pt, pts, points </td></tr></table><h2><a class="anchor" id="id_working_with_user_interface_extensions"></a> Working with user-interface extensions</h2><p>A key feature of the AAT is the ability to drive the InDesign user interface. The InDesign user interface needs to be captured or acquired to an XML file, representing the widgets in a palette or dialog.<p>The Action Automation Editor has a built-in set of user-interface extensions for palettes in their default states; you can use these preloaded user-interface extensions as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_using_a_preloaded_palette_user_interface_library">Using a preloaded palette user-interface library</a>. These preloaded user-interface extensions are XML-based descriptions of the default set of InDesign palettes, acquired during the installation of the AAT data files (see &quot;Acquire palettes for user-interface extension&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_required_data_files">Required data files</a>). After a palette or dialog is acquired, actions available through its user interface become available in the Action Automation Editor for use in action sequences.<p>There are actions available through AAT that enable a palette or dialog to be acquired as part of an action sequence; these actions are under Extension Tools &gt; Acquisition Actions. When a dialog or palette is acquired, the state of the dialog or palette at that moment is saved to an XML description.<p>The AAT obtains menu items from the keyboard-shortcut editor. Palette pop-out menus are considered menu items and are not part of the palette. This is true in both the keyboard shortcut editor and the Action Automation Editor. The menu items that appear on the palette pop-out menus are available to parameterize Menu Action actions (under Actions &gt; UI Actions) through the <a class="el" href="class_command.html">Command</a> parameter; to use these, no user interface needs to be acquired.<p>Acquiring a dialog targets the front-most dialog. The Acquire Dialog action (see Extension Tools &gt; Acquisition Actions) can be parameterized to specify the output filename and folder to which the dialog-dump XML file should be written. By default, this action creates a file named Dialog_Dump.xml inside the QA folder. For more detail, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_dialog">Acquiring a dialog</a>.<p>When acquiring a palette, the target needs to be specified explicitly through the <a class="el" href="class_command.html">Command</a> parameter of the Acquire Palette action (see Extension Tools &gt; Acquisition Actions). The output filename and the folder to which the palette description XML file is saved are parameters of this action. By default, the palette-description XML file is saved to &lt;palette-name&gt;.xml; for example Align.xml for the Align palette. For more details, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_palette">Acquiring a palette</a>.<p>After some user-interface components like a palette or dialog are acquired, you can create action sequences based on the palette or dialog. These sequences can be executed on another machine without the acquired user-interface XML files being present. To create action sequences based on the acquired user-interface component on other machines, you need to transfer one or more XML files; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_transferring_a_saved_user_interface_library_between_machines">Transferring a saved user-interface library between machines</a>.<p>When you create action sequences based on user-interface extensions, particularly when testing before your product is released, the user interface you acquired can change. If you are using an acquired user interface in your action sequences, and this user interface changes, it is important to acquire the dialog/palette again and replace actions using that dialog/palette in existing session files with actions from the updated user-interface extensions.<h3><a class="anchor" id="id_using_a_preloaded_palette_user_interface_library"></a> Using a preloaded palette user-interface library</h3><p>The default set of InDesign palettes should be available when the Action Automation Editor is launched, if AAT is correctly installed. These palettes are listed under Loaded UI Extensions in the Source Components panel. They reflect the user interface of the palettes when nothing is selected. If the palette of interest has other states that show different sets of controls, the palette may need to be acquired in that state. If no Loaded UI Extensions can be found, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_how_can_i_solve_common_problems_like_loading_aat_under_release">How can I solve common problems, like loading AAT under release?</a>.<p>Palette pop-out menus are accessed through a Menu action, not a UI Extension action. The menu items from the palette pop-out menus are in a subtree under the Palette Menus node; for example, when editing the <a class="el" href="class_command.html">Command</a> parameter of a Menu Action (from Actions &gt; UI Actions).<p><b>Aligning objects with a preloaded user-interface extension</b><ol type="1"><li>Open the Action Automation Editor and clear the Sequencer.<li>Load the new-default-doc.xml session file from the examplefiles folder.<li>From Page Item Actions, add a Create Rectangle Page Item action. Set the bounds to X=1 inches, Y=1 inches, Width=2 inches, Height=2 inches.<li>Add another Create Rectangle Page Item action. Set the bounds to X=5 inches, Y=5 inches, Width=2 inches, Height=2 inches.<li>From UI Actions, add a Menu Action, with the <a class="el" href="class_command.html">Command</a> parameter set to Edit &gt; Select All.<li>From Loaded UI Extensions &gt; Align Palette, add the action that appears as &quot;Align horizontal centers Icon.&quot; This has the same effect as clicking the iconic button on the Align panel to align the selected page items: <div class="image"><img alt="itk-guide-27.gif" src="itk-guide-27.gif" /></div><li>Save the session file to a convenient location, and execute. When the action sequence has executed, there should be two rectangle page items, aligned horizontally by their centers. This script is in the examplefiles folder, named align-rect-centres.xml.</ol><h3><a class="anchor" id="id_acquiring_a_dialog"></a> Acquiring a dialog</h3><p>Unlike palettes, there is no preloaded user-interface library for dialogs. To test the user interface of a dialog or test a feature accessible only through a dialog, the dialog first needs to be acquired.<p>To acquire a dialog, set up actions to open the dialog (for example, using UI Actions &gt; Menu Action), then add an Acquire Dialog action from Extension Tools &gt; Acquisition Actions.<p><b>Acquiring the New Paragraph Style dialog</b><p>The following procedure acquires the New Paragraph Style dialog:<ol type="1"><li>Open the Action Automation Editor, and clear the Sequencer.<li>From Doc Actions, add a Close All Docs action and a New Doc action.<li>From UI Actions, add a Menu action. Set the <a class="el" href="class_command.html">Command</a> parameter of this action to New Paragraph Style. This is under Panel Menus &gt; Paragraph Styles &gt; New Paragraph Style...<li>From Extension Tools &gt; Acquisition Actions, add an Acquire Dialog action. Set the Value field of the Description File parameter of this action to something like NewParaStyleDialog_Dump.xml, in a convenient folder.<li>Execute but do not save the action sequence. Note how the action to acquire the dialog cycles through the selectable dialogs of the New Paragraph Style dialog.<li>The acquired dialog is appears under the Loaded UI Extensions part of the Source Components panel, with the New Paragraph Style dialog.&quot; You also may want to browse to NewParaStyleDialog_Dump.xml in the folder location you specified above. You should see a description of the dialog and the widgets it contains in this XML file. This script is in the acquire-ui folder, named acquire-para-style-dialog.xml.</ol><p>When acquiring dialogs, be sure to use a <a class="el" href="class_command.html">Command</a> parameter for the Menu Action (from Actions &gt; UI Actions) that will bring up the precise dialog you require. For example, in the procedure above, a Menu Action was needed to bring up the New Paragraph Style dialog rather than, say, using the iconic button on the Paragraph Styles palette.<p><b>Acquiring the Move dialog</b><p>This procedure is another example of capturing a dialog, this time by adapting an existing action sequence:<ol type="1"><li>Open the Action Automation Editor, and clear the Sequencer.<li>Load the align-rect-centres.xml session file, and save it to a convenient location with a different filename.<li>Click the last action in the action sequence, Align &acirc;&#128;&#147; Align horizontal centers icon Action.<li>From UI Actions, add a Menu Action. Set the <a class="el" href="class_command.html">Command</a> parameter of this action to Object Menu &gt; Transform &gt; Move.<li>From Extension Tools &gt; Acquisition Actions, add an Acquire Dialog action.<li>Edit the Acquire Dialog action. Set the Value field of the Description File parameter to MoveDialog_Dump.xml. This should save the dialog-dump XML file to the default folder, which is the QA folder, a peer of the application-installation folder.<li>Save and execute. The Move Dialog should appear at the end of the sequence, then the Action Automation Editor dialog re-appears and the Move dialog appear under Loaded UI Extensions. At this point, you can inspect the MoveDialog_Dump.xml file saved to the QA folder. This script is in the acquire-ui folder, named acquire-move-dialog.xml.</ol><dl class="section note"><dt>Note<dd>Step 6 indicates that the default folder for the dialog-dump XML file is the QA folder. In the sample script in the ITK, however, the dialog-dump file is saved in the same folder as the session file, using the &quot;Relative to Session File Folder&quot; option in the Item Editor dialog.</dl><h3><a class="anchor" id="id_acquiring_a_palette"></a> Acquiring a palette</h3><p>Although palette user-interface libraries are preloaded in the AAT, you may need to capture a palette in a state other than its default state. If you are a third-party developer, you may have your own palettes and want to capture these.<p>Unlike acquiring a dialog, you do not need to bring up a palette in the user interface to acquire it. There is an Acquire Palette action under Extension Tools &gt; Acquisition Actions. If you add an Acquire Palette action and edit the action, you can specify the palette you want to acquire through the <a class="el" href="class_command.html">Command</a> parameter of this action.<p><b>Acquiring the Tags palette</b><ol type="1"><li>Launch the Action Automation Editor, and clear the Sequencer.<li>From Extension Tools &gt; Acquisition Actions, add an Acquire Palette action.<li>Edit the Acquire Palette action, setting the <a class="el" href="class_command.html">Command</a> parameter to Window &gt; Tags. Set the Value of the Description File parameter to TagsPal.xml. This will save into the default location of the QA folder.<li>Execute but do not save the sequence. Inspect the TagsPal.xml file created in the QA folder. This script is in the acquire-ui folder, named acquire-tags-palette.xml. It has the variation that it saves to the same folder as the session file.</ol><p>If you want to use an acquired user interface on more than one machine, you can move the file to the second machine and load it through the Action Automation Editor; alternately, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_transferring_a_saved_user_interface_library_between_machines">Transferring a saved user-interface library between machines</a>.<h3><a class="anchor" id="id_using_acquired_dialogs_and_palettes"></a> Using acquired dialogs and palettes</h3><p><b>Entering text into an edit box of an acquired dialog</b><p>The New Hyperlink dialog is of medium complexity. It uses buttons, edit boxes, list boxes, and combo boxes. We begin by extending the user interface to include the New Hyperlink dialog after acquiring it:<ol type="1"><li>Create a New Document manually, type a word, and select it with the text tool. Choose Window &gt; Interactive &gt; Hyperlinks. For the New Hyperlink menu item (on the Hyperlinks palette pop-out menu) to be enabled, there must be a selection.<li>Open the Action Automation Editor, and clear the Sequencer if needed.<li>From Actions &gt; UI Actions, add a Menu Action. Set the <a class="el" href="class_command.html">Command</a> parameter to Panel Menus &gt; Hyperlinks &gt; New Hyperlink action.<li>From UI Extension &gt; Acquisition Actions, add an Acquire Dialog action. Set the Value field of the Description File parameter to NewHyperlinkDialog_Dump.xml.<li>Execute the sequence. A script that implements these actions is in the acquire-ui folder, named acquire-hyperlink-dialog.xml. It was modified to automate the manual actions in the scenario above.</ol><p>Having created a dialog dump for the New Hyperlink dialog, we can now load it and begin to use the actions it specifies in a new action sequence. The following procedure sets the name of the hyperlink created through this acquired-dialog user interface and dismisses the dialog through its OK button:<ol type="1"><li>Bring up the Action Automation Editor, and clear the Sequencer.<li>If the New Hyperlink Dialog does not appear under the Loaded UI Extensions part of Source Components, click the Extend UI button in the bottom-left of the Action Automation Editor dialog, and select NewHyperlinkDialog_Dump.xml from the location where it was saved.<li>Load the new-default-doc.xml session file from the examplefiles folder, and save it to a convenient location with a different filename. Select the last action in this action sequence, to ensure that further actions are added at the end of the sequence.<li>From Actions &gt; Story Actions, add a New Story action.<li>From Story Actions, add a Fill With Placeholder Text action.<li>From Story Actions, add a Select Text action. Set the Selection Length to 9 characters.<li>From Actions &gt; UI Actions, add a Menu Action. Set the <a class="el" href="class_command.html">Command</a> parameter of this action to Panel Menus &gt; Hyperlinks &gt; New Hyperlink action, to bring up the New Hyperlink Dialog. From this point on, we will use the user-interface extension we have created to enter values for this dialog.<li>From Loaded UI Extensions &gt; New Hyperlink Dialog &gt;&gt; New Hyperlink Actions, add an action named Name: Edit Box action.<li>Edit this Name: Edit Box action in the Item Editor. Change the Value field of the Edit Box Value parameter to MyHyperlink1.<li>From Loaded UI Extensions &gt; New Hyperlink Dialog &gt;&gt; New Hyperlink Actions, add an action named OK Button, which dismisses the dialog when executed.<li>Save and execute. You should see a new hyperlink created.</ol><p>We created a new hyperlink and gave it a name, but it does not yet have a destination; this is left as an exercise for the reader.<p>When using user-interface extensions like an acquired dialog, as in this example, it is important to remember that if the action sequence edits parameters of a dialog, you must add an action to click the OK button or Cancel to dismiss the dialog, or your action session will fail.<p><b>Setting a drop-down list-box value in an acquired dialog</b><p>The following procedure acquires the New Gradient Swatch dialog and uses it to create a new gradient swatch with a radial gradient:<ol type="1"><li>Launch the Action Automation Editor, and clear the Sequencer.<li>From Actions &gt; Doc Actions, add a Close All Docs action and a New Doc action.<li>From Actions &gt; UI Action, add a Menu Action. Set the <a class="el" href="class_command.html">Command</a> parameter to Panel Menus &gt; Swatches &gt; New Gradient Swatch...<li>From Extension Tools &gt; Acquisition Actions, add an Acquire Dialog action. Edit the Description File parameter to NewGradientSwatchDialog_Dump.xml.<li>Execute without saving. This takes a modest time to execute, since the acquisition of the dialog requires swatch libraries to be loaded. You can dismiss the New Gradient Swatch dialog when the Action Automation Editor re-appears behind it. This script is in the acquire-ui folder, named acquire-gradient-swatch-dialog.xml.</ol><p>The following procedure uses the acquired-dialog user interface to set the state of one of the list boxes on the New Gradient Swatch dialog:<ol type="1"><li>Launch the Action Automation Editor, and clear the Sequencer.<li>If New Gradient Swatch Dialog does not appear under Loaded UI Extensions, click the Extend UI button on the bottom left of the Action Automation Editor dialog, and select NewGradientSwatchDialog_Dump.xml from the location where it was saved by the previous procedure.<li>From Actions &gt; Doc Actions, add a Close All Docs action and a New Doc action.<li>From Actions &gt; UI Actions, add a Menu Action. Set the <a class="el" href="class_command.html">Command</a> parameter of this action to Panel Menus &gt; Swatches &gt; New Gradient Swatch...<li>From Loaded UI Extensions &gt; New Gradient Swatch &gt; New Gradient Swatch Actions &gt; Gradient Options Actions, add an action named Type: Drop Down. Edit this action:, setting the Value field of the List Value parameter to Radial.<li>Save to a convenient location, and execute the sequence. A radial gradient swatch should be created. This script is in the examplefiles folder, named create-new-gradient-swatch.xml.</ol><h3><a class="anchor" id="id_transferring_a_saved_user_interface_library_between_machines"></a> Transferring a saved user-interface library between machines</h3><p>Although it is not necessary to give dialog descriptions to execute session files on another system, if you want to create Action Sessions on multiple machines, you may want to set up your dialog extension library and use that library of dialogs on multiple machines.<p>When the AAT extends the user interface, an XML file named MyDialogExtensionLibrary.xml is created in the cached data folder under the QA folder (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_where_is_the_qa_folder_i_keep_hearing_about">Where is the QA folder I keep hearing about?</a>). This file indicates where the loaded user-interface extension files are located (see the following figure). Relative links work just as with graphics, to the documents or my documents folders, desktop, QA folder, or anywhere inside those locations. <div class="image"><img alt="itk-guide-28.gif" src="itk-guide-28.gif" /></div><p>If you have only one or two dialogs that you have captured, it is straightforward to just click Extend UI and browse to the Dialog Description files on any system; for example, if you place the captured user interface on a server volume that can be seen from all the test machines you are working on, use Extend UI, and point the AAT on each machine at the user-interface-extension files on the server. If you have many acquired user-interface-extension files and you want to create action sequences on many machines, consider putting the user-interface extensions on a server, but transfer the MyDialogExtensionLibrary.xml file between machines, to avoid having to click the Extend UI button for each user-interface extension.<p>The following procedure goes under the hood to examine how Loaded UI Extensions are represented on your local system and how to transfer them to another machine. There is an acquired user interface for the Move Dialog in the examplefiles folder. This defines the information the AAT needs to automate actions through the Move Dialog. In the procedure, we consider how data stored on one machine about a loaded user-interface extension can be transferred to another machine, to make the captured user interface available on the other machine.<ol type="1"><li>Be sure you executed the procedure in &quot;Acquiring the Move dialog&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_dialog">Acquiring a dialog</a>, to create the dialog description XML file named MoveDialog_Dump.xml.<li>Launch the Action Automation Editor, and clear the Sequencer.<li>Navigate to Loaded UI Extensions in Source Components, and open the node to list the available user-interface extensions. If this is the machine on which you executed the procedure in &quot;Acquiring the Move dialog&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_dialog">Acquiring a dialog</a>, you already should have a Move Dialog node that points to the MoveDialog_Dump.xml file.<li>Otherwise, if this another machine, Click the Extend UI button, locate the MoveDialog_Dump.xml file from the server where it was saved in &quot;Acquiring the Move dialog&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_dialog">Acquiring a dialog</a>, and click Open. Notice the Move Dialog node is added.<li>Locate the folder with the InDesign cached data folder. For Windows and Mac OS, respectively, this path is of the following form:<ul><li>Windows: <div class="fragment"><div class="line">C:\Documents and Settings\&lt;username&gt;\Local Settings\Application Data\Adobe\InDesign\Version&lt;version&gt;\&lt;locale&gt;\Caches</div></div><li>Mac: <div class="fragment"><div class="line">/Users/&lt;username&gt;/Library/Caches/Adobe InDesign/Version&lt;version&gt;/&lt;locale&gt;</div></div></ul><li>Locate the QA folder within this cached data folder, and inspect the XML file named MyDialogExtensionLibrary.xml; see the preceding figure. If this file refers to user-interface extensions on a file server that is visible from the machine on which you intend to run AAT tests, you should be able to transfer MyDialogExtensionLibrary.xml to the remote machine, as long as you put it into QA folder within the cached data folder on the remote machine.</ol><h2><a class="anchor" id="id_frequently_asked_questions"></a> Frequently asked questions</h2><h3><a class="anchor" id="id_how_can_i_solve_common_problems_like_loading_aat_under_release"></a> How can I solve common problems, like loading AAT under release?</h3><p>The following table lists common issues getting started with the AAT:<table class="doxtable"><tr><th>Issue </th><th>Cause </th><th>Resolution </th></tr><tr><td>I don&#39;t see the QA menu. I&#39;m running the release build of InDesign. </td><td>Be sure you have the testing plug-ins loaded. By default, these are not in the profile that loads under release. </td><td>See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_launching_the_action_automation_editor">Launching the Action Automation Editor</a> and <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installation">Installation</a>. </td></tr><tr><td>I don&#39;t see anything under the &quot;Loaded UI Extensions&quot; of the source components. </td><td>You need to have the qa/aat folder in the correct location and execute GetAllPalettes script. </td><td>See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installation">Installation</a>. </td></tr><tr><td>I can&#39;t find the Type Text to Story action. </td><td>This action is obsolete and is hidden in the source components tree. </td><td>Old action sequences that use it will still run, but new action sequences should use Type Text, from Actions &gt; UI Actions. </td></tr><tr><td>How do I create a new paragraph style? I don&#39;t see the action I expect under the Styles actions. </td><td>There is no New Paragraph Style action, as it is relatively elaborate to parameterize. </td><td>Use a Load Styles action from a document that contains the styles you want. </td></tr></table><h3><a class="anchor" id="id_where_is_the_qa_folder_i_keep_hearing_about"></a> Where is the QA folder I keep hearing about?</h3><p>You will encounter two different QA folders, and the context in this document should specify which of the two QA folders is being discussed. One is in the cached data folder, and the other is a peer of the folder in which the application (for example, InDesign) is installed. The default locations of the cached folder are as follows:<ul><li>Windows: <div class="fragment"><div class="line">C:\Documents and Settings\&lt;username&gt;\Local Settings\Application Data\Adobe\InDesign\Version&lt;version&gt;\&lt;locale&gt;\Caches</div></div><li>Mac OS: <div class="fragment"><div class="line">/Users/&lt;username&gt;/Library/Caches/Adobe InDesign/Version&lt;version&gt;/&lt;locale&gt;</div></div></ul><h3><a class="anchor" id="id_can_i_use_aat_with_adobe_indesign_server"></a> Can I use AAT with Adobe InDesign Server?</h3><p>Yes. AAT scripts that use only command actions can be used with InDesign Server.<h3><a class="anchor" id="id_can_i_run_aat_scripts_developed_for_indesign_within_adobe_incopy"></a> Can I run AAT Scripts developed for InDesign within Adobe InCopy?</h3><p>Yes, AAT can be used with InCopy, but if you run a script that uses InDesign-only functionality in InCopy, it is likely to fail or crash. Scripts written for InDesign may not function as intended if the corresponding functionality is not in InCopy.<h3><a class="anchor" id="id_what_do_i_need_to_do_to_get_the_aat_working_under_the_release_build"></a> What do I need to do to get the AAT working under the release build?</h3><p>Follow the procedure in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installation">Installation</a>. You need to be sure the Testing plug-ins are loaded. These plug-ins are loaded by default under the debug build. For the release build, however, you need to take some action to ensure they load; for example, either add a Path in your PluginConfig.txt file or copy these plug-ins to the application&#39;s plug-ins folder.<h3><a class="anchor" id="id_how_do_i_find_an_action_given_its_name_or_partial_name"></a> How do I find an action given its name or partial name?</h3><p>Right-mouse-click (Ctrl-click) on the Source Components panel, choose Search from the context-sensitive menu that appears, and enter the name or partial name of the action. You should be presented with a list of matches. Select one from the dialog that appears, and the Action Automation Editor navigates to the action in the Source Components that matches your choice.<h3><a class="anchor" id="id_where_do_i_find_the_actions_when_creating_menu_actions"></a> Where do I find the actions when creating menu actions?</h3><p>Menu Actions are based on the keyboard shortcuts list in InDesign. If you find an expected item missing, check in InDesign and in the Keyboard Shortcut editor to make sure the item appears on the menu where you expect it to be.<h3><a class="anchor" id="id_what_is_object_loop_target"></a> What is object loop target?</h3><p>An object loop finds every object in a specified target and outputs a reference to it for manipulation within the loop. There are only two kinds of targets in which it will look: stories and documents (the table-content finder shows up but is unimplemented). So, we cannot say, &quot;For Each rectangle on Page 1, apply swatch Black,&quot; but we can say, &quot;For Each spline in document foo.indd, apply swatch Black.&quot;<h3><a class="anchor" id="id_what_is_the_create_linked_text_frame_action_for"></a> What is the Create Linked Text Frame action for?</h3><p>The Create Linked Text Frame action is supposed to be like clicking in the overset-text adornment on one frame (whether or not there is overset text) and dragging a new frame. You need to specify the frame to which you are linking and the page and bounds of the new frame. The After Frame parameter allows you to make the new linked frame appear before the one you are linking to in the story.<h3><a class="anchor" id="id_is_there_a_straightforward_way_to_insert_a_text_cursor_into_any_story"></a> Is there a straightforward way to insert a text cursor into any story?</h3><p>If you specify the length of the range to select as 0, the cursor (with no selected text) is inserted at the specified index.<h3><a class="anchor" id="id_how_do_i_select_one_or_all_items_on_a_page_after_they_are_placed"></a> How do I select one or all items on a page after they are placed?</h3><p>You just need a reference to the page item you want to select. If you used one of the Place actions under Page Item Actions, they should give you one, and you can use that variable name to specify which page item to select in the Select Page Item action. If you used the Import Load Place Gun action under Import/Export Actions, you must get the reference in another way (for example, using the Get Nth Page Item action under Page Actions). You also can use Select All (and Deselect All, if desired) under Doc Actions.<h3><a class="anchor" id="id_what_is_the_difference_between_string_actions_and_string_information"></a> What is the difference between String Actions and String Information?</h3><p>String Actions act on a string, and String Information gets information about a string. String Actions has four action types, and String Information has four information types; see the following tables. Of the other parameters in the actions, not every action type uses all of them.<p>The following table lists parameters used by String Actions:<table class="doxtable"><tr><th>Action Type </th><th>Parameters Used </th></tr><tr><td>Remove </td><td>Target String, Output String, Index, and Length. </td></tr><tr><td>Append </td><td>Target String, Input String, Output String. </td></tr><tr><td>Set </td><td>Input String and Output String. </td></tr><tr><td>Insert </td><td>Target String, Input String, Index, and Output String. </td></tr></table><p>The following table lists parameters used by String Information:<table class="doxtable"><tr><th>Information Type </th><th>Parameters Used </th></tr><tr><td>Get Index of Character </td><td>Target String, Start Index, Character, and Output Int. </td></tr><tr><td>Get Last Index of Character </td><td>Target String, Character, and Output Int. </td></tr><tr><td>Contains Substring </td><td>Target String, Substring, and Output Int. </td></tr><tr><td>Get Num Characters </td><td>Target String and Output Int. </td></tr></table><h3><a class="anchor" id="id_what_are_the_four_values_for_bounds_referred_to_in_a_text_box"></a> What are the four values for bounds referred to in a text box?</h3><p>The four values represent the text frame&#39;s left, top, right, and bottom, in that order. For example, 1,1,3,6 creates a frame that starts at (1,1) and ends at (3,6). (Recall that points are described as (x, y); thus, the bounds are (x1, y1, x2, y2).)<h3><a class="anchor" id="id_can_i_apply_xml_tags_to_text_through_aat"></a> Can I apply XML tags to text through AAT?</h3><p>You can use the Apply XML Tag to Text action found under both Story Actions and XML Actions. It takes in tag, story, and range information. It ignores the current selection.<h3><a class="anchor" id="id_what_is_alert_watcher_found_under_action_sequences_and_loops"></a> What is Alert Watcher (found under Action Sequences and Loops)?</h3><p>Alert Watcher can watch for all alerts (hitting the default button) or a specific alert. For specific alerts, it can check the alert text and hit a specific button (based on the button string). It behaves like any other sequence or loop and can be nested, have multiple children, etc.<p>Alert Watcher has four parameters:<ul><li>Watch Type - If this is set to Hit Default Button on Any Alert, both the Button to Press and Expected Alert Text parameters are ignored.<li>Button to Press - This is the label of your desired button. This has a combo box containing [Default] for choosing the default button, whatever it may be.<li>Expected Alert Text - This is the translated alert text; that is, what you see on your screen.<li>Error if No Alert - This causes the watcher to report an error if no error matching its criteria is observed.</ul><h3><a class="anchor" id="id_how_can_i_close_the_progress_bar_on_the_fly"></a> How can I close the progress bar on the fly?</h3><p>There are two ways to do this:<ul><li>Show the AAT Progress Bar and Hide AAT Progress Bar actions, under Custom Actions.<li>Use a parameter on the Session File that lets you hide the progress bar for the duration of the session file. If you do a Show action during that session file, the progress bar is shown.</ul><p>In both cases, if the application preference (from the QA menu) is set to suppress the progress bar, it never appears (even if you call Show). So, you can hide the progress bar for your click actions and bring it back when you are done, or you can have an entire session file that does not show it at all.<h3><a class="anchor" id="id_why_am_i_having_trouble_selecting_the_graphic_in_a_placed_image"></a> Why am I having trouble selecting the graphic in a placed image?</h3><p>The page item output from place is the frame that contains the graphic you have placed, not the graphic itself. As a workaround, add a menu action that changes to the Direct select tool through the Tools menu, then add a mouse-click action on a point you know is on the image.<h3><a class="anchor" id="id_how_can_i_specify_a_key_press_with_two_modifiers_like_ctrlaltn_to_make_a_new_doc"></a> How can I specify a key press with two modifiers, like Ctrl+Alt+n to make a new doc?</h3><p>You need to type the second modifier as it appears in the drop-down for the combo box. You can, but do not need to, use spaces, commas, or other separators for each modifier (&quot;Ctrloption&quot; equals &quot;Ctrl option&quot; equals &quot;Ctrl+option&quot; equals &quot;Ctrl,option&quot;).<p>If you enter a capital letter in the Press Key field, you do not need Shift as a modifier as the AAT sorts that out for you. The same applies for the characters above number keys, like 2 and @ on a US keyboard.<h3><a class="anchor" id="id_what_is_the_finder_type_parameter_of_an_object_loop"></a> What is the Finder Type Parameter of an object loop?</h3><p>The Finder Type is the type of container in which you want to search. For example, you would look for inline graphics inside a story or table, but you would look for stories or swatches inside a document.<p>Finder Loops loop for each object they find and post out a reference to each instance they find. For example, a given script opens a document that contains three stories. Consider a Finders set to the following:<div class="fragment"><div class="line">Finder Type Parameter = Document ContentFind Object of Class = TextStory</div></div><p>This will loop three times, posting references to each story it finds. The order in which items are found depends on the container in which you are searching. In documents, it is based on UID; that is, the order in which each content item was created initially. In stories or tables, the order is based on the text index in the story or table cell.<h3><a class="anchor" id="id_how_do_i_select_a_specific_word_in_some_text"></a> How do I select a specific word in some text?</h3><p>Suppose you have text like this question&#39;s title, and you want to select the word &quot;specific.&quot; You could use the Select Text action (from Actions &gt; Story Actions), with Text Start Index set to 18 and Selection Length set to 8.<h3><a class="anchor" id="id_i_am_confused_about_getting_an_object_in_aat_it_does_not_seem_to_select_the_object"></a> I am confused about getting an object in AAT; it does not seem to select the object.</h3><p>Getting does not manipulate an item. It is not selected, deleted, modified or altered. You can think of Get as a pathway to another action or set of actions. When you insert a Get action into a sequence, what you are doing is &quot;specifying&quot; the object you want to manipulate with a later action. For example, suppose you have a test file where you have made three page items, and you want to select the first one. To do this, you need to Get the 0th Page Item, then call Select Page Item.<h3><a class="anchor" id="id_how_do_you_say_for_every_document_that_is_open_do_this"></a> How do you say, &quot;For every document that is open, do this&quot;?</h3><p>Suppose for every open file, we want to set the name of the document to something different, then save and close. Here are the steps to do this:<div class="fragment"><div class="line">Get Num Docs [output: numDocs]</div><div class="line">While(numDocs &gt; 0) </div><div class="line"> numDocs = numDocs - 1 [Math operation] </div><div class="line"> Get Nth Doc(numDocs) </div><div class="line"> [Do the new naming thing </div><div class="line"> Save Doc [with new Name] </div><div class="line"> Close Doc</div></div><p>Ensure that you set the parameters for the While loop to be integers.<h3><a class="anchor" id="id_how_can_i_access_commands_found_in_the_character_palette_pop-out_menu"></a> How can I access commands found in the character palette pop-out menu?</h3><p>Pop-out menus are available by adding a Menu Action, from Actions &gt; UI Actions. If you edit the <a class="el" href="class_command.html">Command</a> Parameter of this action, you will find a node called Palette Menus. Within the subtree below that node are the pop-out menu items.<p>The basic idea is that our Menu Action really is a reflection of the keyboard-shortcut editor&#39;s list of entries. Anything for which you can set a keyboard shortcut can be accessed there. Hide/Show toggles are not updated, so if you call Show Layout Grid twice, and it originally was not shown, it ends up not shown again.<h3><a class="anchor" id="id_how_can_i_automate_right-clicking_to_get_to_the_context_menu"></a> How can I automate right-clicking to get to the context menu?</h3><p>All menus are accessible through the Menu Action item. We do not provide custom/special methods for accessing contextual menus. If you know where an item is in the keyboard shortcut editor, that is where it appears in our menus. Thus, contextual-menu actions and palette-menu actions are done through the Menu Action.<h3><a class="anchor" id="id_why_are_the_palette_pop-out_menus_not_shown_with_the_palette_under_ui_extensions"></a> Why are the palette pop-out menus not shown with the palette under UI extensions?</h3><p>Again, this happens because the AAT locates menu items based on the keyboard-shortcut editor. Under the hood, the palette pop-out menu items are considered menu items, so that is where they show up. Look under the Palette Menus subtree when editing a Menu Action (Actions &gt; UI Actions &gt; Menu Action).<h3><a class="anchor" id="id_is_there_a_straightforward_way_to_select_a_paragraph"></a> Is there a straightforward way to select a paragraph?</h3><p>Use the GetNthParagraph action from Actions &gt; Story Actions to get the offset and length you need, then call Select Text, again from Actions &gt; Story Actions.<h3><a class="anchor" id="id_why_did_an_assert_show_up_when_i_tried_to_write_out_an_aat_file"></a> Why did an assert show up when I tried to write out an AAT file?</h3><p>If you see the following assertion when writing AAT files, it is because the file you are trying to write to is locked, is in a locked folder, or is in use: <div class="fragment"><div class="line">UTF16to8streamBuf::ConvertAndOutputLocal() - unable to write to outputbuf!</div></div><p>Simply unlock it or its parent folder, or save to a new location or with a different filename.<h3><a class="anchor" id="id_where_does_the_aat_come_up_with_the_descriptions_for_items_in_a_dialog_or_palette"></a> Where does the AAT come up with the descriptions for items in a dialog or palette?</h3><p>InDesign reports what is in a dialog or palette by including the possible values, the ID of each widget, the bounds, and the default state. The representation of the dialog or palette is said to be acquired or captured, and it can be loaded as a user-interface extension by the AAT. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_working_with_user_interface_extensions">Working with user-interface extensions</a>.<h3><a class="anchor" id="id_where_can_you_change_the_name_and_path_of_the_dialog_description_file_when_acquiring_a_user_interface"></a> Where can you change the name and path of the Dialog Description file when acquiring a user interface?</h3><p>You can change this in the Description File parameter on the Acquire Dialog action. For details, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_acquiring_a_dialog">Acquiring a dialog</a> and the sections following it.<h3><a class="anchor" id="id_can_you_take_an_acquired_dialog_to_another_machine_and_load_it"></a> Can you take an acquired dialog to another machine and load it?</h3><p>Yes. The description is in XML and should have no machine- or platform-specific information. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_transferring_a_saved_user_interface_library_between_machines">Transferring a saved user-interface library between machines</a>.<h3><a class="anchor" id="id_if_you_have_a_session_file_with_an_acquired_user_interface_do_you_need_to_provide_the_dialog_dump_to_run_the_file"></a> If you have a session file with an acquired user interface, do you need to provide the Dialog Dump to run the file?</h3><p>The part of the user interface that is used is included with any session file. There is no reason to provide the Dialog Description file just to run the session file; you need the Dialog Description file only if you want to add new actions to it.<h3><a class="anchor" id="id_is_there_any_reason_to_take_a_dialog_description_xml_file_to_another_machine"></a> Is there any reason to take a Dialog Description XML file to another machine?</h3><p>Only the part used in a session file is included If you want to create more session files using this user interface, or add actions based on this acquired user interface to an existing action sequence, it makes sense to copy the XML file and extend the user interface with it.<h3><a class="anchor" id="id_how_can_i_drag_and_drop_a_page_item"></a> How can I drag and drop a page item?</h3><p>Use the click and drag action. If you will drag and drop on a different window, you need to convert the location from local to global and manage active windows accordingly.<h1><a class="anchor" id="id_extending_the_action_automation_tool"></a> Extending the Action Automation Tool</h1><p>This chapter explains how to extend the Action Automation Tool (AAT).<h2><a class="anchor" id="id_background"></a> Background</h2><p>With the default AAT, you can automate many black-box testing tasks by implementing test scripts, as explained in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_action_automation_tool_for_black-box_testing">Action Automation Tool for Black-box Testing</a> . The AAT comes with many common actions ready to be plugged into your action script. It also comes with a list of acquired user-interface actions, so a QA engineer can use the user-interface action to &quot;simulate&quot; user actions.<p>Also, the AAT is very smart in &quot;acquiring&quot; a third-party plug-in&#39;s user interface. If you have a panel (or dialog) in your plug-in, it is possible for the AAT to get information about the panel&#39;s widgets, as long as the widget class hierarchy for the control includes a known InDesign widget type.<p>There are times, however, when your QA testing requirements are not covered by the default AAT. Consider the following situations:<ul><li>You want to provide a command-level action that appears in the Actions List of the AAT Editor source tree, enabling a tester to use that action in conjunction with existing actions. For example, if you have an action that acts on a page item, your test sequence would make a new document, create the page item, and pass it on to your new custom action.<li>You have a widget that does not descend from any existing InDesign widgets that the AAT knows about. When the AAT acquires the user interface, it cannot recognize your control, which is ignored. Alternately, you could have a widget that descends from a standard widget, but the AAT cannot extract values.</ul><p>Fortunately, AAT is designed for flexibility, functionality, and extensibility. By writing a plug-in using the supplied AAT-related APIs, you can extend the default AAT tool so it can adapt to your specific QA requirements.<p>This chapter explains how to implement AAT extensions, and provides specific implementation tips in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_building_blocks">Building blocks</a> for the two situations described above.<h2><a class="anchor" id="id_setup"></a> Setup</h2><h3><a class="anchor" id="id_overview"></a> Overview</h3><p>This section describes how to set up the AAT extension environment. To work with the AAT extension, you must have the required assets (libraries, header and source files, and so on) in the correct places.<h3><a class="anchor" id="id_shared_libraries"></a> Shared libraries</h3><p>You must move the shared libraries described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_shared_libraries">Shared libraries</a> to an additional location.<p>Move the shared libraries to SDK folders named as follows:<ul><li>Windows: <div class="fragment"><div class="line">&lt;SDK&gt;/build/win/&lt;debug|debugx64&acirc;&#148;&#130;release|releasex64&gt;</div></div><li>Mac OS: <div class="fragment"><div class="line">&lt;SDK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos</div></div></ul><h3><a class="anchor" id="id_header_and_source_files"></a> Header and source files</h3><p>The source files for the AAT extension are in InDesign Tool Kit folders named as follows:<div class="fragment"><div class="line">&lt;ITK&gt;/source/components&lt;ITK&gt;/source/precomp&lt;ITK&gt;/source/<span class="keyword">private</span></div></div><p>Normally, they are not part of the InDesign SDK. To compile the ITK source files, move them to the SDK folders named as follows:<div class="fragment"><div class="line">&lt;SDK&gt;/source/components&lt;SDK&gt;/source/precomp&lt;SDK&gt;/source/<span class="keyword">private</span></div></div><h3><a class="anchor" id="id_project_files"></a> Project files</h3><p>AAT&#39;s project files are provided in:<div class="fragment"><div class="line">&lt;ITK&gt;/build/&lt;win|mac&gt;/prj</div></div><p>Move them to the SDK folder:<div class="fragment"><div class="line">&lt;SDK&gt;/build/&lt;win|mac&gt;/prj</div></div><h2><a class="anchor" id="id_concepts"></a> Concepts</h2><p>The core of the AAT system comprises action/verification pairs called AATActions. AATActions allow us to remove the data from the code and store it in external files. These files, which are a series of actions described in XML, are processed by the AAT as tests.<p>Each AATAction encompasses one kind of action, but it can store its own attributes. Each action displayed under the AAT editor&#39;s Source Components is an AATAction. To extend the AAT system as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_background">Background</a>, you need to create your own AATAction or, in some cases, add to an existing AATAction.<h3><a class="anchor" id="id_aat_architecture"></a> AAT architecture</h3><p>The following figure shows how the AAT system is represented by boss classes and interfaces. <div class="image"><img alt="itk-guide-29.gif" src="itk-guide-29.gif" /></div><p>When a user clicks the Execute button in the AAT editor, the AAT queries the ITestSessionList on the <a class="el" href="classk_workspace_boss.html">kWorkspaceBoss</a> for a list of test sessions to execute. An ITestSessionList contains a list of kCTestSessionBoss(es) that aggregate ITestSession(s). Only the first ITestSession is used during an AAT session; that is, you can have only one top-level session file per session. In the preceding figure, this is shown in the AAT Editor under the Sequencer box as the Session File.<p>An ITestSession manages a list of sequence lists. A sequence list, as depicted in the following figure, is the Action Sequences item in the Sequencer box, which is represented by service provider bosses that aggregate any descendent of ISequenceList. <div class="image"><img alt="itk-guide-30.gif" src="itk-guide-30.gif" /></div><p>The purpose of a sequence list is to provide flow control, data sharing, and logic for a series of actions. A sequence list provides an environment in which AATActions run and communicate. A sequence list can contain a list of AATActions, managed by an IAATActionList or another ISequenceList like kCDoWhileSequenceListBoss, which aggregates an implementation of ISequenceList that basically manages other AATActions or other sequence lists. ISequencesList is a list of ISequenceItem(s). ISequenceItem is the parent class for ISequenceList and IAATActionList. This arrangement allows ISequenceList to contain another ISequenceList; therefore, it satisfies the requirement for nested sequences. The following figure shows the main AAT classes in a C++ class hierarchy diagram. <div class="image"><img alt="itk-guide-31.gif" src="itk-guide-31.gif" /></div><h3><a class="anchor" id="id_aataction"></a> AATAction</h3><p>An AATAction is a C++ instance of VAATAction. CAATAction is a (partial) abstract class that provides most of the default implementations for an AATAction; your AATAction should use CAATAction as the base class and override only the necessary methods. There are a few pure virtual methods and one static method in CAATAction for which you must provide implementations; these are listed in the following table.<table class="doxtable"><tr><th>Method name </th><th>Note </th></tr><tr><td>CreateAATAction </td><td>A static method that returns an instance of the AATAction class to the caller. </td></tr><tr><td>Execute </td><td>Test code goes here. For example, if want to exercise your code that adds custom data to a page item, you should put the code in this method. Then, when this AATAction is called to perform the action, it adds the data to the target page item. </td></tr><tr><td>GetAATActionID </td><td>Returns the hex ID declared for this AATAction. For more information about AATAction IDs, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_id">AATAction ID</a>. </td></tr></table><p>Think of an AATAction as a self-contained test unit. You use input data (of a type based on CAATData; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>) in the Execute method. Usually, the input data is needed to exercise the code you want to test, then you put the result in one or more output variables. The top-most sequence list is responsible for passing data among the AATActions it manages. The following figure shows AAT PageItem Actions &gt; Create Rectangle used in a sequence. <div class="image"><img alt="itk-guide-32.gif" src="itk-guide-32.gif" /></div><p>By default, the Create Rectangle action expects an input variable (In Variable, as labeled in the action item&#39;s editor) named Page, and it puts its test result, a rectangle page item, in an output variable (Out Variable) named PageItem. When a correct action sequence is constructed using the Create Rectangle action, the Create Rectangle action should be preceded by an action that outputs a variable that Create Rectangle expects; in this example, it is a variable called Page, output by the Get Nth Page In Spread action. The sequence list that manages the AATActions (from New Doc to Resize) matches all the input and output request by each AATAction and distributes proper data at run time, based on the variable names set up by each AATAction. <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a> discusses in more detail how input data can be collected and how the output data is being broadcast.<p>The following table lists the data members of CAATAction. Most are initialized by CAATAction, but your AATAction implementation might need to change the values in some data members. <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_building_blocks">Building blocks</a> gives examples of when you should override the default values.<table class="doxtable"><tr><th>Member </th><th>Type </th><th>Note </th></tr><tr><td>fAbortOnError </td><td>qaBool16 </td><td>Default variable indicating whether execution should stop if this action fails. The implementation of your action should check the value of fAbortOnError. If it is set to kTrue or &quot;Yes,&quot; you should return kCancel rather than kFailure when your action fails. </td></tr><tr><td>fActionDescription </td><td>qaString </td><td>AATAction&#39;s information string, usually a description of the action&#39;s use. </td></tr><tr><td>fDefault </td><td>qaBool16 </td><td>Deprecated. Do not use. </td></tr><tr><td>fInited </td><td>ProdBool </td><td>CAATAction initializes fInited to kFalse by default. In some custom AATActions, it needs a specialized user-interface handler. When fInited is set to false, the handler is set up properly. </td></tr><tr><td>fItems </td><td><a class="el" href="class_k2_vector.html">K2Vector</a> &lt;ISequenceItem*&gt; </td><td>For internal use. </td></tr><tr><td>fName </td><td>qaString </td><td>Deprecated. Do not use. </td></tr><tr><td>fParamExtensions </td><td>VirtualDataList* </td><td>Not used. </td></tr><tr><td>fParentContainer </td><td>VAATAction* </td><td>For internal use. </td></tr><tr><td>fParentSeq </td><td>ISequenceList* </td><td>The sequence list that contains the AATAction. </td></tr><tr><td>fProduct </td><td>qaUIDRef </td><td>Output variable for the AATAction. </td></tr><tr><td>fProductCompatibility </td><td>ProdInt32 </td><td>Indicates the AATAction&#39;s availability in different products. See VAATAction.h for enum values. </td></tr><tr><td>fSessProps </td><td>IAATActionSessionProperties* </td><td>Provides access to IAATActionSessionProperties. Initialized by CAATAction. </td></tr><tr><td>fShowInTree </td><td>qaBool16 </td><td>Used by DialogAndPanelActions to prevent &quot;empty&quot; user-interface actions from appearing in the source tree. If this value is set to kFalse, the item is not displayed in the Actions List of the source tree. Defaults to kTrue. </td></tr><tr><td>fSubject </td><td>qaUIDRef </td><td>Input variable for the AATAction. It could be a document <a class="el" href="class_u_i_d_ref.html">UIDRef</a>, page item <a class="el" href="class_u_i_d_ref.html">UIDRef</a>, and so on, or nothing. </td></tr><tr><td>fSupportsExtensions </td><td>ProdBool </td><td>Not used. </td></tr><tr><td>fType </td><td>qaString </td><td>AATAction action name, initialized by the first parameter of CAATAction constructor, typeStr. </td></tr><tr><td>fTypeCode </td><td>qaString </td><td>AATAction&#39;s eight-digit hex ID. </td></tr><tr><td>fValidationLevel </td><td>qaString </td><td>Deprecated. Do not use. </td></tr><tr><td>fVersion </td><td>ProdInt32 </td><td>Used for conversion. The value of fVersion is additive, so if CAATAction changes, your descendants also change. You should never hard-code this value; instead, you should increment it in your action&#39;s constructor. </td></tr></table><h3><a class="anchor" id="id_aataction_data"></a> AATAction data</h3><p>Each AATAction action is an atomic unit designed to perform one test step. The question is: How does an action like Insert Pages know to which document to add pages?<p>Like all programming systems, the AAT architecture allows for the passing of values through variables of the CAATData type. Virtually any parameter in the AAT architecture is simultaneously a static value and a variable. Variables in AAT can be assigned and used to assign specific objects, values, or strings. Unlike traditional algebraic models, variables in the AATAction architecture can receive values or assign (post) values, but never both; that is, some AAT variables receive values and some post. The distinction can be noted in the Item Editor of an AATAction, where a receiving variable is indicated as In Variable, while a posting variable is Out Variable.<p>If a CAATData variable never receives a new value, it uses the default value set up by the AATAction where the variable belongs. If you examine the test case in the figure shown earlier in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction">AATAction</a>, it contains New Doc, Get Nth Spread, Get Nth Page in Spread, Create Rectangle, and Resize actions. After each action title, there is an entry in parentheses indicating the posting and receiving keys for the action&#39;s primary variables. These are the default fSubject and fProduct members of CAATAction.<p>Whenever a test action with a posting variable executes, every receiver has its value set to the value posted. This means that, if two actions post the same key, they overwrite each other. For example, New Doc and Open Doc both post Doc by default. If an Open Doc action is inserted just below the New Doc in the previously mentioned figure, the rectangle is created in the document that is opened, not the new one.<p>Variable communication is scoped by the top-most sequence; that is, every test item below the sequence that is added to the session can communicate with every other item in that sequence tree. Sequences at the session level cannot communicate with items in other session-level sequences.<p>Many of the CAATAction&#39;s data members listed in the preceding table are of types prefixed with &quot;qa.&quot; For example, fActionDescription is of type qaString, and fSubject is of type qaUIDRef. The qa*** classes are the most fundamental data classes in AAT for an AATAction&#39;s input and output. All these qa*** types are defined in the AATDataTypes.h file and are based on CAATData. All the most common types in InDesign have a corresponding qa*** class defined in AATDataTypes.h. An AATAction always should use variables of the qa*** type to collect and store data.<p>CAATData is a data class that can generate a user interface to be used in the AATAction action&#39;s Item Editor (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_action_item_editor">AATAction action-item editor</a>). Every instance of CAATData must have a user-interface code associated with it. CAATAction creates a user interface in the Item Editor based on the user-interface code. For example, CAATAction has a derived class called BaseDialogAATAction, which has a data member called fCheckEnabled. It is a qaString and is constructed with a kDropDownListCode user-interface code. In BaseDialogAATAction&#39;s constructor, three expected enable-state strings (Don&#39;t Check, Disabled, and Enabled) are added to the fCheckEnabled using CAATData::AddAcceptableValues. When Expected Enable State is clicked in the Item Editor of a user-interface extension action, a drop-down list that contains the three enable-state strings set up in BaseDialogAATAction&#39;s constructor is available for the user to choose. The current selection is translated into a string and stored in the qaString. Then the AATAction&#39;s implementation can use the BaseDialogAATAction::fCheckEnabled to find the user&#39;s choice.<p>The following table lists the available user-interface element codes to be used in a CAATData-based class. The default user-interface code for CAATData is kInvalidUICode, which does not display any user interface in the Item Editor.<table class="doxtable"><tr><th>User-interface code </th><th>User-interface element shown in item editor </th></tr><tr><td>kButtonCode </td><td>No user interface. </td></tr><tr><td>kCheckBoxCode </td><td>Single-selection, drop-down list with string values of Yes/No. </td></tr><tr><td>kCheckBoxTreeViewCode </td><td>Tree view with check-box tree node. An example is the Snapshots parameter of Validation Actions &gt; Snapshot. </td></tr><tr><td>kChooseDirCode </td><td>Like kChooseFileCode, but the browser window is a &quot;choose folder&quot; dialog. </td></tr><tr><td>kChooseFileCode </td><td>Text-edit box with a Browse button. When clicked, a browser window opens for the user to choose a file. </td></tr><tr><td>kComboBoxCode </td><td>Combo box. </td></tr><tr><td>kDropDownListCode </td><td>Single-selection, drop-down list. </td></tr><tr><td>kFileComboCode </td><td>Deprecated. Do not use. </td></tr><tr><td>kIndeterminateCode </td><td>Provides an interface that allows users to set the data type of this data point to whatever they want. For example, logic may sometimes call for an integer value but other times need a string, bool, or even UID or <a class="el" href="class_u_i_d_ref.html">UIDRef</a>. </td></tr><tr><td>kInt32EditBoxCode </td><td>Text-edit box. </td></tr><tr><td>kInvalidUICode </td><td>None. </td></tr><tr><td>kMeasurementCode </td><td>Edit box for a value in the unit of measurement available from a drop-down list. An example is the Weight parameter of the Set Page Item Stroke Weight action. </td></tr><tr><td>kMultiLineTextEditBoxCode </td><td>Multiline text-edit box. </td></tr><tr><td>kPointCode </td><td>A group of widgets with edit boxes for X and Y (values of a point) plus a drop-down list for the unit of measurement for the point. An example is the Center Point parameter of the Rotate action. </td></tr><tr><td>kRadioButtonCode </td><td>Same as kCheckBoxCode. </td></tr><tr><td>kRadioClusterCode </td><td>Single-selection, drop-down list. The list of strings in the drop-down represents the values of the radio cluster. </td></tr><tr><td>kRealEditBoxCode </td><td>Text-edit box. </td></tr><tr><td>kRectCode </td><td>A group of widgets with edit boxes for X, Y, Width, and Height values of a rectangle, plus a drop-down list for the unit of measurement for the rectangle. An example is the Expected Bounds parameter of the Get Window Dimension action. </td></tr><tr><td>kSaveAsDependentFileCode </td><td>To be deprecated. Use kSaveAsFileCode instead. </td></tr><tr><td>kSaveAsFileCode </td><td>Like kChooseFileCode, but the browser window is the Save As... dialog. </td></tr><tr><td>kStaticTextCode </td><td>Static text. </td></tr><tr><td>kTextEditBoxCode </td><td>Text-edit box. </td></tr><tr><td>kTextListBoxCode </td><td>Single-selection, drop-down list. </td></tr><tr><td>kTreeViewCode </td><td>Scrollable tree view. An example is the <a class="el" href="class_command.html">Command</a> parameter of UI Action &gt; Menu Action. </td></tr></table><dl class="section note"><dt>Note<dd>AATAction data does not have to show itself in the same way that the actual InDesign user interface draws. For example, a table action that applies strokes to cells could simply have a string list of sides, rather than drawing the user interface in the Tables:Cell Strokes dialog panel.</dl><h3><a class="anchor" id="id_aataction_action_item_editor"></a> AATAction action-item editor</h3><p>Sometimes you want to create tests that do not use default values when executed. Perhaps you want to create a document with a specific page size or place a file at a specific location. To do this, you need to be able to edit individual actions and change their values. When you insert an item into the sequencer, it starts life with its default values. By double-clicking an item in the sequencer or selecting an item and clicking the Edit button, you access the Item Editor dialog. The Item Editor, shown in the following figure, allows you to set values and variables for any parameter of a test action, sequence, or session. By default, the AAT puts up the parameters shown in the following table. <div class="image"><img alt="itk-guide-33.gif" src="itk-guide-33.gif" /></div><table class="doxtable"><tr><th>Parameter </th><th>Note </th></tr><tr><td>Comments </td><td>For AATAction users to insert their own comments. </td></tr><tr><td>Comment Out </td><td>For the AATAction user to disable the AATAction in the sequence. When &quot;commented out,&quot; an AATAction is not executed. </td></tr><tr><td>Action Description </td><td>For the AATAction author to describe the use of the AATAction. This corresponds to CAATAction::fActionDescription, a qaString variable. You can use the variable to set up your action description. </td></tr><tr><td>Validation Level </td><td>For the AATAction user to specify test-validation level. By default, CAATAction uses a drop-down list to provide three validation levels, using the strings constants (kExtensiveValidationStr, kStandardValidationStr, and kMinimumValidationStr) declared in AATXMLTagDefs.h. The current selected item from the drop-down list is stored in the CAATAction::fValidationLevel, a qaString. Typically, in your CAATAction::Execute method, you use the validation level to provide different levels of testing. </td></tr><tr><td>Abort on Error </td><td>For the AATAction user to decide what to do when the AATAction encounters an exception. Abort on Error causes the test session to terminate if the action fails. For example, if your test began with New Doc, and you set the Abort On Error drop down to &quot;Yes,&quot; then if the creation of a new document fails, the test does not try to continue execution. The Abortion Error parameter corresponds to CAATAction::fAbortOnError, a qaBool16. Every CAATAction::Execute should return an ErrorCode. During exception, it is an AATAction&#39;s responsibility to return a proper ErrorCode based on the user&#39;s choice in the Abort on Error parameter. If the user&#39;s choice is True, CAATAction::Execute should returns kCancel; otherwise, kFailure. </td></tr></table><p>Item Editor dialog is generated when the user double-clicks on an action in a sequence list. This is done by asking the sequence item (a AATAction) for its data list. The list contains all member variables for the AATAction. As discussed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>, each of these variables is an instance of CAATData. The implementations of CAATData can provide a user-interface code for the type of user-interface element needed to collect input from the user.<p>You can supply your own parameter(s) to collect the necessary data and broadcast your test result to meet your AATAction&#39;s needs. This is done by adding a CAATData-based class (qa*** type, discussed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>) data member to your AATAction class and constructing it with proper user-interface code. For example, your test code may process a command that requires a string as its command data. To collect string data in the AAT, you can add qaString-type member data to your AATAction implementation. Depending on the user-interface code associated with your qaString variable, a corresponding user interface is displayed in the Item Editor.<p>When you add your own parameter to the AATAction, by default, the parameter is created as a receiving variable (that is, input variable). To make it a posting variable (that is, output variable), you need to call the VAATData::SetIsPosting method and pass kTrue to the function. Typically, you need to assign your output variable with the object you want to output, then call fParentSeq-&gt;PostMsg (fParentSeq is a member of CAATAction) to post the output, so the parent sequence can propagate the result to proper receivers for that variables. The CAATAction class declares two UID-based (type qaUIDRef) data members, fSubject and fProduct, that you can use as input/output variables. fSubject (used as input variable by default) and fProduct (used as output variable by default) are initialized by CAATAction. For the corresponding user interface to show up in the AATAction&#39;s Item Editor, you need to call the CAATData::SetUITextString and give the editor panel a name.<h3><a class="anchor" id="id_aataction_factory_and_registry"></a> AATAction factory and registry</h3><p>The AAT system uses the service-provider paradigm to find all AATActions during run time and make them available in the AAT editor. An AATAction boss typically is a service provider that aggregates IAATActionList, which maintains a list of test implementations that can be queried. The test implementation is a regular C++ instance of the VAATAction class. The AATAction factory (IAATFactory) is an AddIn interface to the global workspace. The core of the factory is a tree data structure that stores the function pointer to each AATAction&#39;s static CreateAATAction method. The tree is sorted by hexadecimal character strings, each eight characters long. This provides up to eight bytes of possible AATActions. Every AATAction needs to define a unique ID to be identified inside the factory. For the reserved ID range, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_id">AATAction ID</a>.<p>To register into the factory, an AATAction must be registered in the Initialize method of at least one IAATActionList interface. All AATActions lists register with their boss ID and impl ID to the factory&#39;s registry. When the factory initializes, an instance of each IAATActionList is created and initialized. When the list is initialized, it is passed the optional IAATFactory pointer. The list, in turn, adds the AATAction IDs into the registry, as well as its own list. If two or more IAATActionLists try to add a duplicate pointer to the same leaf of the registry, an assert is thrown only if the leaf pointers do not match; otherwise, this is simply ignored.<p>Due to the cumbersome nature of repeating the same code to add items to the registry, it was decided that an AATAction must define an ID internally that corresponds to its class name plus &quot;ID.&quot; This allows a simple macro that needs only the class name to expand for registration. (The macro is k##a##ID, which expands to the name with the ID).<h3><a class="anchor" id="id_aataction_id"></a> AATAction ID</h3><p>Each AATAction is associated with an ID of the AATActionHexID class (see IAATActionList.h). You should define the ID as an eight-character string, but you should treat it as a four-byte hexadecimal number. The AAT system actually expects the string to be in the range 0x00000000 to 0xFFFFFFFF. with DEADFACE and a certain range of IDs reserved for internal use. The ID should be registered in IAATActionList::AddAATActionID, and the VAATAction::GetAATActionID should return the ID.<dl class="section note"><dt>Note<dd>The letter in the AATAction ID that represents a hexadecimal digit needs to be in uppercase. If you specify a lowercase digit, the AAT will be unable to register your AATAction and will crash the application.</dl><p>The following example shows a typical way to define an AATAction ID: <div class="fragment"><div class="line"><span class="preprocessor">#define kANABPINewAATActionID &quot;00C5D001&quot; </span></div><div class="line"><span class="preprocessor"></span><span class="comment">// OK!#define kANABPINewAATActionID &quot;00c5d001&quot; </span></div><div class="line"><span class="comment">// NOT OK! c and d are lower case.</span></div><div class="line"><span class="preprocessor">#define kANABPINewAATActionID &quot;GYMK0001&quot; </span></div><div class="line"><span class="preprocessor">// NOT OK!</span></div></div><p>Assume that a third-party AATAction ID is declared as follows: <div class="fragment"><div class="line"><span class="preprocessor">#define kMYAATActionID &quot;@@###$%%&quot;</span></div></div><p>The following table shows how the AATAction ID should be declared.<table class="doxtable"><tr><th>@@: Product ID </th><th>###: Plug-in ID space </th><th>$: AATAction list IDs </th><th>%%: AATAction IDs </th></tr><tr><td>For InDesign and InCopy, the product ID should be declared as 00. </td><td>Third-party partners should use the first three characters from their plug-in ID. For example, if your plug-in prefix ID is 0xC5D00, you would use C5D. </td><td>Use this digit to manage your AATAction List. Since it is really a hex value, you can have up to 16 (0-F) AATAction lists per plug-in ID space. </td><td>Use these two digits to manage your individual AATAction IDs. You can specify anything from 00-FF, which allows up to 4096 potential actions, since you can specify up to 16 action lists in the proceeding digit. </td></tr></table><h2><a class="anchor" id="id_key_client_apis"></a> Key client APIs</h2><p>The APIs provided to manipulate layout-related objects are summarized in the following tables.<p>The following table lists key AAT APIs:<table class="doxtable"><tr><th>API </th><th>Note </th></tr><tr><td>CAATAction </td><td>Provides a basic implementation for VAATAction. This is the base class you should use for your own AATAction, if you are adding a new AAT action. </td></tr><tr><td>CAATData </td><td>Provides a basic implementation for VAATData. </td></tr><tr><td>IAATActionList </td><td>An AATAction list is a kind of sequence item that holds related AATActions. When added to a sequence list, the AATAction list has one of its member AATAction activated. When Execute is called on the list, the active AATAction is executed. </td></tr><tr><td>IAATFactory </td><td>Serves as the constructor/provider of all AATAction items. </td></tr><tr><td>ISequenceList </td><td>A sequence list is a list of sequence items. The list is itself an item and can be embedded in another sequence list. </td></tr><tr><td>ITestSession </td><td>A session is a list of ISequenceLists that represents a specific test or set of tests. A session is responsible for releasing all its list contents when destroyed. </td></tr><tr><td>ITestSessionList </td><td>A list of sessions. The session list serves as a driver for a test file and is filled in when the file is read to memory. </td></tr><tr><td>VAATAction </td><td>Not an interface. An AATAction is a specific test or action to be performed and verified. </td></tr><tr><td>VAATData </td><td>The &quot;variable&quot; to be used for communication between AAT actions. A VAATData is a virtual class that defines such data. </td></tr></table><p>The following table lists APIs for add-on:<table class="doxtable"><tr><th>API </th><th>Note </th></tr><tr><td>IAATActionListAddOn </td><td>CAATActionListAddOn. </td></tr><tr><td>IAATUIHandler </td><td>When you want to add a custom widget to the AAT, you need to tell the AAT how to handle the widget through IAATUIHandler. This includes information such as widget ID and widget bound. </td></tr><tr><td>BaseDialogAATAction </td><td>The base class of an AATAction for dialog add-ons, like a custom widget. </td></tr><tr><td>BaseUIAction </td><td>Descendent of CAATAction. This is the base class for BaseDialogAATAction. </td></tr></table><h2><a class="anchor" id="id_building_blocks"></a> Building blocks</h2><p>This section describes two common scenarios, listed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_background">Background</a>, to illustrate the necessary steps to extend the AAT system.<h3><a class="anchor" id="id_add_an_aataction_to_the_aat_editor_source_tree"></a> Add an AATAction to the AAT editor source tree</h3><p>In the first scenario, you want to add a new custom action to the action list of the main AAT editor window, so users can insert your action into their test sequences. You need to add an AATAction to the AAT system. Here is the critical information that you need to know to be able to add an AATAction to the AAT source tree.<p><b>Implement an AATAction</b><p>You always should implement your AATAction based on CAATAction.<p><b>AATAction constructor guideline</b><p>In your AATAction constructor, you always should call the CAATAction base class&#39;s constructor, which is declared as follows: <div class="fragment"><div class="line">CAATAction(<span class="keyword">const</span> ProdString &amp;typeStr, <span class="keyword">const</span> ProdString &amp;subject, <span class="keyword">const</span> ProdString &amp;product);</div></div><ul><li>typeStr is the AATAction&#39;s name as shown in the sequence source list.<li>subject is the default input variable (CAATAction::fSubject) name.<li>product is the default output variable(CAATAction::fProduct) name.</ul><p>An AATAction&#39;s data variables should have their values set in the AATAction&#39;s constructor. If you specified a variable name in the CAATAction constructor, a proper construction of the qa*** class should set up the user interface with a proper user-interface string associated with it. For fSubject and fProduct, call the variable&#39;s SetUITextString to set up the user-interface string for the parameter. The user-interface string shows up in the left side of the Item Editor as a parameter that the user can click and then edit. Most of the CAATAction&#39;s data members are initialized by CAATAction, but you may want to set up at least fProductCompatibility, to make sure your AATAction is available only in proper products. Use the eProductCompatibility defined in the VAATAction.h to declare your AATAction compatibility.<p>To add an additional input variable, declare a new data member in one of the qa*** types (see AATDataTypes.h) in your CAATAction-derived class. The qa*** uses two macros to expand the preprocessor macro-generated classes (QA_##a##_Data) into a fully qualified class, MAKE_NONORDINAL_DATA_HEADER for a UID-based data class and MAKE_QADATA_HEADER for an ordinal data class. Both preprocessor macro-generated classes are based on CAATData, which has four constructors: <div class="fragment"><div class="line">CAATData(<span class="keywordtype">void</span>);</div><div class="line">CAATData(<span class="keyword">const</span> ProdString &amp;tag);</div><div class="line">CAATData(<span class="keyword">const</span> ProdString &amp;tag, <span class="keyword">const</span> ProdString &amp;uiString, ProdInt32 code);</div><div class="line">CAATData(<span class="keyword">const</span> ProdString &amp;tag, <span class="keyword">const</span> ProdString &amp;uiString, <span class="keyword">const</span> ProdString &amp;varName,ProdInt32 code);</div></div><p>Use the first three constructors either if the AATAction data will not be visible in the user interface or if the AATAction data&#39;s user-interface information will be set in the body of the constructor.<p>The fourth constructor is used most often. Its last parameter has a default value of kInvalidUICode and may be left blank for AATAction data that does not need a UI Element (value set by variable only). When you construct a qa*** type variable, you typically use its constructor of the following form, so it expands to be based on the fourth CAATData constructor. (For details, see AATDataTypes.h.) <div class="fragment"><div class="line">QA_##a##_Data(a var, ProdString tag, \ ProdString varName, \ ProdString uiString = <span class="stringliteral">&quot;&quot;</span>, \ ProdInt32 code = kInvalidUICode); \</div></div><ul><li>var is the default value for the variable in the Value field of the item editor.<li>tag is the XML tag used by AAT to identify the variable. You can define your own tag or use the ones defined in AATXMLTagDefs.h. No two data items may have the same tag. If two items with the same tag are added to VirtualDataList, the list will ASSERT that the items have duplicate strings and include the string of the offending XML tag.<li>varName is the default variable name used for In/Out Variable in the item editor.<li>uiString is the variable &#39;s label as it appeared in the Parameters list of the item editor.<li>code is the corresponding UI code to be used for this variable. See the table in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>.</ul><p>In the body of the constructor, set user-interface information for standard variables, if necessary. Also, if your AATAction data uses user-interface code such as drop-down lists or tree elements, acceptable values should be populated. The value of fProductCompatibility should be set as well. For more information, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>.<p><b>Declare an ID for the AATAction</b><p>The AATAction ID should be returned in the VAATAction::GetAATActionID. Also, it is used in the AATAction list. See &quot;Add an AATAction list&quot; in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_add_an_aataction_to_the_aat_editor_source_tree">Add an AATAction to the AAT editor source tree</a>.<p><b>Provide VAATAction implementation</b><p>See the table in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction">AATAction</a> for the minimal set of functions you should implement. If you added your own variable to the AATAction, you also should implement VAATAction::CollectReadWriteParams.<dl class="section note"><dt>Note<dd>Your call to CollectReadWriteParams must begin by calling CAATAction::CollectReadWriteParams(theList); otherwise, all dependent code cannot access the data points in CAATAction.</dl><p><b>Add an AATAction list</b><p>You need to provide your own IAATActionList implementation that will manage the AATActions you are adding. Your IAATActionList class always should be based on CAATActionList. There are only three things you need to do in your IAATActionList implementation:<ol type="1"><li>Construct the class, assigning the data member fName a string. All AATActions added to this IAATActionList appear under this name in the Source Components &gt; Actions list of the AAT editor. The IAATActionList is sorted alphabetically, but the individual actions are listed in the order in which they are added to the parent list.</ol><ol type="1"><li>In IAATActionList::Initialize, call IAATActionList::AddAATActionID once for each AATAction you are adding. Pass in the AATAction ID you declared in &quot;Declare an ID for the AATAction&quot;.<li>In IAATActionList::RegisterAATActions, use the ADD_AAT_ACTION_TO_LIST_REG macro to add the AATAction class to the list.</ol><p>After the AATAction list is implemented, add it to a service-provider boss, to be defined in your plug-in&#39;s .fr file. Use kAATFactoryServiceProviderImpl for the <a class="el" href="class_i_k2_service_provider.html">IK2ServiceProvider</a> implementation, which adds the IAATActionList implementation in the boss to the AAT system.<h3><a class="anchor" id="id_add_to_an_existing_aataction"></a> Add to an existing AATAction</h3><p>If you have a custom widget on a panel or dialog that does not descend from any InDesign widget boss, then, when the containing panel/dialog is acquired by AAT through the Acquisition Actions, the widget is not acquired, because the AAT does not know how to handle the widget. As a result, the AAT user cannot script that widget. The following definition is an example of such a widget:<div class="fragment"><div class="line">Class{</div><div class="line"> kAATExtGoButtonBoss,</div><div class="line"> kInvalidClass,</div><div class="line"> {</div><div class="line"><span class="comment">// widget implementation.</span></div><div class="line"> }</div><div class="line">},</div><div class="line">type AATExtGoButton (kViewRsrcType) : RollOverIconButtonWidget (<a class="code" href="class_i_d_type.html">ClassID</a> = kAATExtGoButtonBoss) { </div><div class="line"> CControlViewObservers;</div><div class="line">};</div></div><p>The kAATExtGoButtonBoss class descends from kInvalidClass, instead of an Indesign widget boss like <a class="el" href="classk_roll_over_icon_button_boss.html">kRollOverIconButtonBoss</a>. Even though the widget may reuse some of the provided implementations through the InDesign SDK, the AAT still cannot recognize the widget. If you have such a widget in your user interface, you need to write an AAT plug-in to tell the AAT how to handle your custom widget.<dl class="section note"><dt>Note<dd>In this scenario, we assume that the custom widget is to be used from a panel or dialog action, which usually is available through AAT user-interface extensions. For more information on how to acquire a panel or dialog of your own, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_action_automation_tool_for_black-box_testing">Action Automation Tool for Black-box Testing</a></dl><p>The following steps are necessary to make a custom widget available in the AAT system.<p><b>Provide widget handler</b><p>Each custom widget that you are about to acquire through AAT should have a widget handler that tells the AAT how to handle the widget. The widget handler should be a service provider (a boss that aggregates <a class="el" href="class_i_k2_service_provider.html">IK2ServiceProvider</a>) that identifies itself using the kAcquireService service ID. Normally, the service-provider boss simply uses the default implementation kAcquireServiceProviderImpl to identify itself.<p>Another interface that the widget-handler service provider needs to aggregate is IAATUIHandler; for the widget handler to work, you must provide your own implementation. The following table describes what should be implemented for each method in IAATUIHandler.<table class="doxtable"><tr><th>Method </th><th>Description </th></tr><tr><td>AcquireView </td><td>Returns a VAcquisitionElement, which is the pure virtual base class of AcquisitionElement. You should instantiate an AcquisitionElement and populate the object with the widget you are handling, whose <a class="el" href="class_i_control_view.html">IControlView</a> is passed in as a parameter. The basic data you need to set up for the AcquisitionElement includes: <br /><br /> - widget type (using AcquisitionElement::SetWidgetType with the supported token of this handler) <br /> - widget ID (using AcquisitionElement::SetWidgetID with the widget ID you can acquire from the <a class="el" href="class_i_control_view.html#a2effd2296767e506934d1d1eb17b2220">IControlView::GetWidgetID</a>) <br /> - widget bounding box (using AcquisitionElement::SetBounds with the bounds acquired from the <a class="el" href="class_i_control_view.html#ac8fc9f04204b4b4c2dc5f1e096e3d829">IControlView::GetBBox</a>),<br /> - enable state of the widget (using SetEnabled with the data returned from <a class="el" href="class_i_control_view.html#a75aae773b3120d7778ae77c23ca6b6c6">IControlView::IsEnabled</a>). <br /><br /> If the widget has data associated with it, like a combo box&#39;s drop-down menu item, you also should add each item&#39;s value to the AcquisitionElement through its AddValueEntry() method. </td></tr><tr><td>GetSupportedClassIDs </td><td>Connects the custom widget boss with the widget handler. Normally, you write one widget handler per widget, so you would append the custom widget&#39;s boss ID to the ID list passed in to this method. </td></tr><tr><td>GetSupportedTokens </td><td>A string token that identifies the widget handler. This token is used in the AAT&#39;s data file (XML) for the acquired containing panel/dialog, to identify the widget. It provides a hook from the data file into the C++ handler code. Normally, you write one handler per custom widget, so you can just append the only token into the token list passed in to this method. </td></tr><tr><td>GetSupportedWidgetIDs </td><td>Further connects the custom widget to the widget handler through the custom widget&#39;s ID. You can safely provide just an empty implementation, since the GetSupportedClassIDs method already provides the hook. </td></tr><tr><td>GetValueAsString </td><td>Mainly represents a control&#39;s value as a string, for users to understand what they are doing. </td></tr><tr><td>GetWidgetUIString </td><td>A string that identifies the type of the widget. </td></tr><tr><td>IsSupportedToken </td><td>The AAT acquires a panel/dialog and saves its data in an XML data file. All acquired widgets are identified by a tag called WIDGET_CODE. The value of this tag is a token defined in the IAATUIHandler::GetSupportedTokens() by the widget handler. When the AAT looks for widget-handler code to handle the widget, it passes the token to all widget handlers, to see which one handles it. So, in this method, you should check that the token passed in matches the supported token, and pass the result back to the calling function. </td></tr><tr><td>SetName </td><td>String that identifies the control. </td></tr><tr><td>SetValue </td><td>Mainly sets the value to the current state of a widget, such as a drop-down list or edit box where you want to set the control to a certain value. You can use the control&#39;s <a class="el" href="class_i_text_control_data.html">ITextControlData</a> (if any) to mirror the widget&#39;s value and AcquisitionElement. </td></tr></table><p><b>Add an AATAction based on naseDialogAATAction for the widget</b><p>Because the widget normally is acquired through an action like Acquire Palette or Acquire Dialog, the AAT user will try to use the widget through the acquired panel/dialog. The widget handler that you write connects the widget with the AAT system and tells the AAT about the attributes of the widget, like widget bounds, so the AAT knows how to interpret the custom widget and present it along with the acquired panel/dialog.<p>There is still one piece missing when users try to use the widget in their script: you need to provide a test function for the widget, when it is being added to a script. The test function should be provided through an AATAction. Consider a panel with a custom widget that you provided with a widget handler. When a user adds that widget action into his AAT script from Loaded UI Extension, typically the user wants to perform the user-interface function provided by that widget. For example, suppose we acquire and extend the ITK&#39;s AATExtensionTest panel so the panel is available in the AAT. When we add the Go button from the AAT source into the Script&#39;s Sequencer list, we are trying to simulate a click on the Go button panel. What happens after the click is not the concern of that widget. The C++ code of the widget&#39;s controller performs the proper action, as you expect. Basically, from the AAT script, you are trying to provide an automatic way of simulating a click on the button. That is the main purpose of an AATAction for the custom widget.<p>So, the next step in adding a custom widget to a panel/dialog is writing an AATAction for the widget.<p><b>What is BaseDialogAATAction?</b><p>A widget&#39;s AATAction always should derive from the BaseDialogAATAction class, which is descended from CAATAction. BaseDialogAATAction keeps tracks of the widget&#39;s geometry and hierarchy, so when a widget is used in the AAT script, it has enough information to perform proper user-interface interaction when necessary. The table in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction">AATAction</a> lists the functions you should override for a typical CAATAction derivation, and it should be applied to your own custom widget. Another method you should override is GetInstanceName(), which returns a name string that represents the action.<dl class="section note"><dt>Note<dd>Loaded UI Extension is where all the acquired panels are located after they are extended into AAT using the Extend UI function</dl><p>The following table lists some of the important member variables you may need to use in your BaseDialogAATAction-derived AATAction. If the description of the member indicates it needs to be set up, you should do so early in the construction of the AATAction.<table class="doxtable"><tr><th>Member </th><th>Description </th></tr><tr><td>fDlg </td><td>The parent window (<a class="el" href="class_i_window.html">IWindow</a>) that contains the widget. </td></tr><tr><td>fMyView </td><td>The <a class="el" href="class_i_control_view.html">IControlView</a> of the widget this AATAction represents. </td></tr><tr><td>fSetGet </td><td>Represents how the widget&#39;s AATAction is being used. The widget&#39;s item editor has a Set/Get field, to allow the user to specify how he wants to use the widget. The Get state means the user wants to get the value out of the widget; the value can be used to make further script logic. The Set state means the user wants to set the value of the widget, as if the user interacts with the widget through the InDesign user interface. </td></tr><tr><td>fShowInTree </td><td>Always should be set to kFalse; otherwise, a bogus Dialogs and Panels Actions is appended to the Action source tree. The real widget action should appear only under the acquired panel&#39;s tree under Loaded UI Extensions. </td></tr><tr><td>fSupportedTokens </td><td>The AATAction&#39;s supported token should be the same token as is set up in the AATAction&#39;s associated widget handler. </td></tr><tr><td>fWidgetValue </td><td>Use the widget code from the table in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a> to assign a user-interface representation to be used in the widget&#39;s value field in the item editor. For a button type of widget, you probably do not need a user interface, since when you use the widget, there usually is no further user choice; that is, when you use the widget, it should mean that you want a click the button. In this case, simply assign a kInvalidUICode to fWidgetValue using its SetUIElement() method. </td></tr></table><p>If you do not want the variable to show up at all in the editor, calling SetEditable(kFalse) would make the variable invisible.<p>For other types of widget, such as a check box, you can assign kCheckBoxCode to fWidgetValue. When kCheckBoxCode is used, AAT uses a drop-down list with a yes/no value in the item editor, for the AAT user to choose the value of the check box. Do not be confused by the name of the data member fWidgetValue. In the internal code for the Icon or Button action, the fWidgetValue data member is used to determine the number of clicks the user wants to perform (Single, Double, Triple, etc).<p><b>BaseDialogAATAction::Execute()</b><p>You always must override the Execute() method of the BaseDialogAATAction base class. Think about what the user wants to do in terms of user-interface interaction. When users interact with a button in InDesign, they want to click the button. With a check box, the user wants to select/deselect the box. With a drop-down menu, the user wants to select an item. In your Execute() override, try to &quot;simulate&quot; what the user wants to do with the widget. This is different from Execute() in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_add_an_aataction_to_the_aat_editor_source_tree">Add an AATAction to the AAT editor source tree</a>, where a new action represents the execution of a feature; for example, creating a document.<p>If you write code to perform the action that is supposed to happen after the user interacts with the user interface, this widget&#39;s AATAction loses the real purpose of providing this widget AATAction as a user-interface extension. Also, it may not accurately test the code written for that widget boss.<p>So, how do you simulate a user action? AAT provides a utility class, IUIDriverUtils, that you can use to perform user actions like mouse down, key press, and select a check box. When IUIDriverUtils is called on to perform user actions, you will see the widget being interacted with as if a phantom mouse is being directed by your code. For example, a IUIDriverUtils::MouseDown on the center of a button causes the cursor to be moved to the center point of the button, then the button to be highlighted as if clicked by a mouse. The real user-interface event is to the widget&#39;s controller code, as if a real mouse clicked it.<p>Another important aspect of Execute() in a BaseDialogAATAction-derived class is the need to distinguish among the different ways that a user intends to use the widget. The state is stored in the fSetGet member variable. In the Get state, the user wants to get the value of the widget. Typically, you should call the CAATAction&#39;s member fParentSeq&#39;s PostMsg() method to post any variable value. The standard member variable to use is fGetProduct, although you could use a member of your own definition. In the Set state, the user wants to change the value of the widget; in such a state, you should perform the user-action simulation. If you changed the widget value in Execute(), you always should call the fParentSeq-&gt;PostMsg() (as explained in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_aataction_data">AATAction data</a>) to broadcast the change to interested parties.<p><b>Add the widget AATAction to existing panel/dialog action</b><p>Instead of providing your own IAATActionList implementation, as explained in &quot;Add an AATAction list&quot; (in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_add_an_aataction_to_the_aat_editor_source_tree">Add an AATAction to the AAT editor source tree</a>), you need to provide a CAATActionListAddOn-based class implementation. In this class, you declare that you are adding to an existing dialog/panel action by calling CAATActionListAddOn::AddAATActionID and passing kDialogAndPanelActionsStrKey for the first parameter, idStr.<dl class="section note"><dt>Note<dd>You could use AddOns to add actions to any AATAction List. You could add your own commands to Doc Actions, using the same process defined here. The key is to use the name of the AATAction list.</dl><p><b>Sample code</b><p>The AATWidgetHandler sample shows how to make a custom widget available in the AAT. It illustrates all the steps covered in this section. The custom widgets it covers includes a button, check box, and combo box. To test the code for AATWidgetHandler, it uses a plug-in called AATExtensionTest, available in the ITK, where its Go button, check box, and combo box are customized.<h2><a class="anchor" id="id_frequently_asked_questions"></a> Frequently asked questions</h2><h3><a class="anchor" id="id_why_doesnt_the_qa_data_member_in_my_aataction_implementation_show_up_in_the_item_editor"></a> Why doesn&#39;t the qa*** data member in my AATAction implementation show up in the Item Editor?</h3><p>Make sure you called the qa*** class&#39;s SetUITextString() method, to give it a user-interface string.<h3><a class="anchor" id="id_what_is_the_kpostingkey_and_kreceivingkey_declared_in_the_aatxmltagdefsh"></a> What is the kPostingKey and kReceivingKey declared in the AATXMLTagDefs.h?</h3><p>kPostingKey is defined as #, and kReceivingKey is defined as $. Internally, they are used in some places for input/output variables; however, they are in the process of being deleted. Do not use # or $ as the prefix for your AAT variables, as they will cause unknown problems.<h1><a class="anchor" id="id_diagnostic_logger"></a> Diagnostic Logger</h1><p>This chapter describes the installation, use, and design of the Diagnostic Logger tool in the Adobe&reg; InDesign&reg; CC Tool Kit (ITK). The Diagnostic Logger collects information about application events occurring during execution of InDesign and related applications in both debug and release (production) environments.<h2><a class="anchor" id="id_terminology"></a> Terminology</h2><p>The following terms are related to the Diagnostic Logger:<ul><li>Consumer - You operate in the consumer role when programming InDesign to automate its function through the existing API, rather than implementing extension patterns.<li>Context event - An application event with a definite beginning and end, like a command.<li>Dispatcher - A component that dispatches information about application events to the Diagnostic Logger.<li>Event source - An abstraction capable of emitting information about an application event, such as a command being processed, a user-interface event taking place, or an action being performed.<li>Extender - To extend the application, your plug-in must implement one or more extension patterns.<li>Extension pattern - A pattern you can implement to extend the application. Extension patterns are implemented in the extender role, which takes advantage of the design patterns the API supports, to enable your code to be called in its correct context by the application core.<li>Information collector - An abstraction that is a sink for application events created by an event source.<li>Logger - Shorthand for the Diagnostic Logger tool.<li>Message - An application event that does not qualify as a context event (that is, does not have a distinct beginning and end). For example, a user-interface event like mouse-up is a message, rather than a context event.<li>Provided interface - Defines the services that a component (like a boss class or plug-in) delivers to other components.<li>Required interface - Defines the services that a component (like a boss class or plug-in) needs, to function properly in its execution context.<li>Roll over, rotate - Refers to a log file. When a log file reaches a specified maximum size, subsequent output is logged to a new log file. When the maximum number of log files is reached, the first log file is overwritten for subsequent output.</ul><h2><a class="anchor" id="id_installation"></a> Installation</h2><p>The main steps to install and start working with the Diagnostic Logger are as follows:<ol type="1"><li>Decide whether you will use the supplied binaries of the DiagnosticLog plug-in in the ITK or compile the DiagnosticLog plug-in. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration">Configuration</a>.<li>If you choose to use the supplied binaries, make sure you move them from the &lt;ITK&gt;/build/win/&lt;debug|debugx64|release|releasex64&gt;/future version/ (on Windows&reg;) folder or the &lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos/future version/ (on Mac OS&reg;) folder to a location where they will be loaded by the application. Alternately, use the PluginConfig.txt mechanism. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_executing_the_logger">Executing the Logger</a>.<li>If you choose to compile the DiagnosticLog plug-in, compile both the debug and release builds. Move the plug-ins to a location where they will be loaded, or use the PluginConfig.txt mechanism.<li>Run the InDesign debug build, and exit the application. You need to run the debug build of the DiagnosticLog plug-in at least once to create its configuration files, so you can control its behavior next time.<li>Read <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_generated_files">Generated files</a> to find out where the generated files are located. You can then configure the Diagnostic Logger by modifying these generated files, to produce the output you are interested in; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration_xml_file">Configuration XML file</a>. Next time you run the application, the configuration options specified in these files determines what output is created.<li>If you run the release build, make sure its configuration file refers to the symbol database-file named DiagnosticLogIDDB.xml, created by the debug application to enable symbol resolution in the release build. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_symbol_database_file">Symbol database file</a>.</ol><p>After you successfully install and use the logger, you can install and build the logger-related samples provided in the ITK. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_installing_and_building_the_samples">Installing and building the samples</a>.<h2><a class="anchor" id="id_configuration"></a> Configuration</h2><h3><a class="anchor" id="id_executing_the_logger"></a> Executing the Logger</h3><p>The Diagnostic Logger can be started without any configuration; it generates a configuration file based on its default settings after an initial run. The recommended way to configure the Diagnostic Logger is to run the debug version of the application once, to generate a default configuration file and a symbol database file that is used for the release build to resolve symbols.<p>By default, the use of a database to resolve symbols is disabled, even in the debug build; although it generates the database, you still need to turn on the &quot;load&quot; attribute in the &lt;iddatabase&gt; element to resolve symbols.<p>By default, the DiagnosticLog plug-in supplied with the ITK compiles into a &quot;future version&quot; folder. Also, prebuilt DiagnosticLog plug-ins for the debug and release versions are included in the following folders:<ul><li>Windows: <div class="fragment"><div class="line">&lt;ITK&gt;/build/win/&lt;debug|debugx64&acirc;&#148;&#130;release|releasex64&gt;/future version/</div></div><li>Mac OS: <div class="fragment"><div class="line">&lt;ITK&gt;/build/mac/&lt;debugcocoa64|releasecocoa64&gt;/packagefolder/contents/macos/future version/</div></div></ul><p>To have InDesign load the DiagnosticLog plug-in:<ol type="1"><li>Point the application to a given folder, by modifying PluginConfig.txt on Windows&reg; or dragging an alias to the folder into the plug-ins folder on Mac OS&reg;.<li>Copy the plug-in somewhere else, like the plug-ins/ folder inside the InDesign application folder, so it will be loaded.</ol><h3><a class="anchor" id="id_generated_files"></a> Generated files</h3><p>If InDesign is running without saved data (an empty Version 9.0 folder), by default the DiagnosticLog plug-in produces no logging information; however, both debug and release versions of InDesign produce configuration files after being run without saved data. The main difference is that the symbol database that is filed (DiagnosticLogIDDB.xml) is generated only when running under the debug build.<p>By default, the output files are generated to a folder called DiagLog in the user&#39;s InDesign Caches folder, in the following location:<ul><li>Windows XP: <div class="fragment"><div class="line">C:\Documents and Settings\&lt;username&gt;\Local Settings\Application Data\Adobe\InDesign\Version&lt;version&gt;\&lt;locale&gt;\Caches\DiagLog</div></div><li>Windows Vista: <div class="fragment"><div class="line">C:\Users\&lt;username&gt;\AppData\Local\Adobe\InDesign\Version&lt;version&gt;\&lt;locale&gt;\Caches\DiagLog</div></div><li>Mac OS: <div class="fragment"><div class="line">/Users/&lt;username&gt;/Library/Caches/Adobe InDesign/Version&lt;version&gt;/&lt;locale&gt;/DiagLog</div></div></ul><p>The debug and release builds of the DiagnosticLog plug-in generate slightly different sets of files in the output folder, as shown in the following tables.<p>Files generated in the debug version:<table class="doxtable"><tr><th>File </th><th>Description </th></tr><tr><td>DiagnosticLogConfiguration_debug.xml </td><td>Debug configuration file. Controls the operation of the logger in the debug version of the application. </td></tr><tr><td>DiagnosticLogIDDB.xml </td><td>Symbol database that can be used in both debug and release versions to resolve numeric identifiers to symbolic ones. </td></tr><tr><td>DiagnosticLogOutput_&lt;n&gt;.txt </td><td>Contains the output of the text-based logger. </td></tr><tr><td>DiagnosticLogOutput_&lt;n&gt;.xml </td><td>Contains the output of the XML-based logger. </td></tr><tr><td>DiagnosticLogRTEnvironment.xml </td><td>Run-time environment, plug-ins loaded when the Diagnostic Logger runs, platform, product, feature set, etc. </td></tr></table><p>Files generated in the release version:<table class="doxtable"><tr><th>File </th><th>Description </th></tr><tr><td>DiagnosticLogConfiguration_release.xml </td><td>Release configuration file. Controls the operation of the logger in the release version of the application. </td></tr><tr><td>DiagnosticLogOutput_&lt;n&gt;.txt </td><td>Contains the output of the text-based logger, with numeric identifiers resolved if requested and the symbol database file is present. </td></tr><tr><td>DiagnosticLogOutput_&lt;n&gt;.xml </td><td>Contains output of the XML-based logger, with numeric identifiers resolved if requested and the symbol database file is present. </td></tr><tr><td>DiagnosticLogRTEnvironment.xml </td><td>Run-time environment, plug-ins loaded when the Diagnostic Logger runs, platform, product, feature set, etc. </td></tr></table><h3><a class="anchor" id="id_configuration_xml_file"></a> Configuration XML file</h3><p>To control logging options, you edit an XML-based configuration file in the output folder, which is one of the following:<ul><li>DiagnosticLogConfiguration_Debug.xml, for the debug build.<li>DiagnosticLogConfiguration_Release.xml, for the release build.</ul><p>By default, both text and text loggers are disabled, so you need to turn on at least one of them to see meaningful debug information. Also, the DiagnosticLog plug-in allows you to specify the number and maximum size of output files for logging. For details on what happens when the logged output exceeds a specified size, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_log_file_rotation">Log-file rotation</a>.<p>The XML vocabulary used by the configuration files is described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration_xml_element_catalog">Configuration XML: element catalog</a> and subsequent sections. Also see the IDiagLogConfigManager interface, which lets you programmatically vary many (but not all) of the properties specified in the XML.<h3><a class="anchor" id="id_symbol_database_file"></a> Symbol database file</h3><p>The symbol database file is an XML-based file named DiagnosticLogIDDB.xml, which contains look-up tables for the different ID spaces that the application supports, like kActionIDSpace, kClassIDSpace, and kServiceIDSpace. You can configure the DiagnosticLog plug-in to load this symbol database file via its configuration XML file. Alternately, you can force the DiagnosticLog plug-in to load the database file programmatically through the IDiagLogConfigManager API.<h3><a class="anchor" id="id_log_file_rotation"></a> Log-file rotation</h3><p>When a log file logs enough information to reach its file-size limit, the DiagnosticLog creates a new file if you chose to do so, until the maximum number of files specified is created; at this point, the DiagnosticLog plug-in starts overwriting the first file it created, and it continues to recycle the created files for output. DiagnosticLog also allows the user to specify the output buffer size, and it writes out the log in the size specified by this parameter. For more information, see the &lt;loggers&gt; element in the configuration file, described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_loggers">&lt;loggers&gt;</a>.<h2><a class="anchor" id="id_diagnostic_logger_architecture"></a> Diagnostic Logger architecture</h2><h3><a class="anchor" id="id_information_sources_and_event_generators"></a> Information sources and event generators</h3><p>There are several information sources or event generators within the application that can generate output that can be picked up by the diagnostic logger. These event generators were added specifically for the purpose of logging. The application events can be partitioned into contexts, where there is a definite beginning and end to the application event (like processing a command), and a message, which may report in any context; for example, a memory purge. For details, see id_contexts_and_messages &quot;Contexts and messages&quot;.<h3><a class="anchor" id="id_dispatcher"></a> Dispatcher</h3><p>The dispatcher component is part of the application core, delivered as a component in the Public shared library. The dispatcher is a mediator between the event generators and the logger component. It expects the logger plug-in to have the kDiagnosticLogPluginID identifier, and it requires the following interfaces to be implemented by that plug-in:<ul><li>IDiagnosticLog, added into <a class="el" href="classk_session_boss.html">kSessionBoss</a>.<li>IDiagLogConfigManager, on its own boss class.<li>IDiagLoggerManager, which can be on a different boss class than the IDiagLogConfigManager implementation.</ul><p>If there is a plug-in with the kDiagnosticLogPluginID identifier, information emitted by the event sources can be logged by that plug-in.<h3><a class="anchor" id="id_logger"></a> &lt;logger&gt;</h3><p>The logger component is a (sample) plug-in that shows how to interact with the dispatcher component. You can use the logger plug-in (DiagnosticLog) as a client or consumer of services implemented by the DiagnosticLog plug-in. For instance, you can use it to log information about application events; control how much information you want it to log through its API; and control whether you want text output, XML output, or both.<p>The logger plug-in also is an extensible component, since it enables third parties to add their own diagnostic-logger service (IDiagnosticLogger), which can be turned on and off through its XML-based configuration file. You also can implement a log-modifier service (IDiagLogModifier) to take control over what is logged at each logger service. For more details on these service types, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extension_patterns">Extension patterns</a>.<p>In principle, you can replace the logger component entirely with your own, as long as you reuse the plug-in identifier expected by the dispatcher component and implement the required interfaces for the dispatcher, described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_dispatcher">Dispatcher</a>. However, you should do this only after studying the implementation of the existing logger component, to be sure you understand the contract with the dispatcher component.<h3><a class="anchor" id="id_contexts_and_messages"></a> Contexts and messages</h3><p>The application events to which the logger responds can be broken into contexts and messages, in the terminology of the diagnostic logger. A context has a definite beginning and end; a message is sent out without regard for context.<p>Contexts are associated with extension patterns. The following contexts are supported by the logger:<ul><li>Action<li><a class="el" href="class_command.html">Command</a><li>Event<li>Idle task<li>Observer<li>Responder</ul><p>A message supplies information about an application event and is not as directly connected as contexts with particular extension patterns. A message sent to the logger is about one of the following:<ul><li><a class="el" href="class_command.html">Command</a> sequence<li>Tracking<li>Transaction level<li>Memory purge<li>Global error state<li>Text-damage mark</ul><h3><a class="anchor" id="id_crash_handling"></a> Crash handling</h3><p>Information buffered in memory is written to disk on an idle task (approximately every five seconds) and on a protective shut-down or other abnormal program termination, like a program crash.<h2><a class="anchor" id="id_logging_output_level"></a> Logging output level</h2><p>The following table shows what information is logged at different levels across the categories supported by the Diagnostic Logger. The minimum amount of information is shown for a logging level kDiagLogMinimum. Higher levels for some categories contribute additional information; for instance, for commands. There are categories where increasing the logging level does not yield extra information; for instance, actions. From this table, you can see that, for most categories, increasing the logging level does not yield any extra information for the particular category; commands and command sequences are the exceptions.<table class="doxtable"><tr><th rowspan="2">Category</th><th colspan="3">Logging level </th></tr><tr><th>kDiagLogMinimum</th><th>kDiagLogMedium </th><th>kDiagLogMaximum </th></tr><tr><td>Action</td><td>ActionID, action name</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td><a class="el" href="class_command.html">Command</a></td><td><a class="el" href="class_command.html">Command</a> ClassID</td><td><a class="el" href="class_command.html">Command</a> type, name, undoability</td><td>Creator ID, target database, input item list, output item list </td></tr><tr><td><a class="el" href="class_command.html">Command</a> sequence</td><td>Sequence name, sequence address (as ID)</td><td>Ending status (end, abort), undoability</td><td>Same as the previous level </td></tr><tr><td>Global error state</td><td>Current error code, new error code, error string, context string</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Idle task</td><td>Idle task ClassID, task name (see lIdleTask)</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Memory purge</td><td>Purge level</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Observer</td><td>Subject ClassID, message ID, protocol (interface) PMIID, observer ImplementationID</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Responder</td><td>ServiceID, signal manager ClassID, responder ImplementationID</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Text-damage mark</td><td>TextIndex of wax line, span of wax line</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Tracking</td><td>State (begin, end, abort), tracker ClassID</td><td>Same as the previous level</td><td>Same as the previous level </td></tr><tr><td>Transaction</td><td>Database ClassID, state (begin or end transaction), database filename</td><td>Same as the previous level</td><td>Same as the previous level </td></tr></table><h2><a class="anchor" id="id_client_api_of_the_logger"></a> Client API of the Logger</h2><h3><a class="anchor" id="id_required_interfaces_of_the_logger_component"></a> Required interfaces of the Logger component</h3><ul><li>IDiagLogConfigManager - Interface to control the behavior of the logger, as an alternative to manipulating the XML configuration file before the application loads. This is a required interface because it is used by the Dispatcher.<li>IDiagLoggerManager - Interface to manage individual logger services (IDiagnosticLogger). This is a required interface because it is used by the Dispatcher.<li>IDiagnosticLog - Interface the Dispatcher uses to acquire references to the logger manager (IDiagLoggerManager) and configuration manager (IDiagLogConfigManager).</ul><h3><a class="anchor" id="id_provided_interfaces_of_the_logger_component"></a> Provided interfaces of the Logger component</h3><ul><li>IDiagLogIDDatabase - Interface to translate a numeric ID value into a human-readable string. For instance, as a client, you might use FindID() to look up an identifier in a given ID space. For this to work in the release version, the symbol database file must have been loaded through either the configuration file or DiagnosticLog API (IDiagLogConfigManager).<li>IDiagLoggingAPI - Superclass for some of the service interfaces of DiagnosticLog plug-in.<li>IDiagnosticLogger - Service (provided) interface for a logger service, See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logger_service">Logger service</a>.<li>IDiagLogModifier - Service (provided) interface for a log-modifier service. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_log_modifier_service">Log-modifier service</a>.</ul><h2><a class="anchor" id="id_extension_patterns"></a> Extension patterns</h2><p>The DiagnosticLog plug-in is extensible. It offers several extension patterns; implement these to extend its basic capabilities. For instance, you can add a new type of logger service, for logging to a console or over the network. Alternately, you can modify (supplement or filter out) information sent to each logger service, by implementing a log-modifier service.<h3><a class="anchor" id="id_logger_service"></a> Logger service</h3><p>This extension service enables a new type of logger service to be added to the basic text and XML logger services supported by the DiagnosticLog plug-in. A logger service is implemented as a service provider, with the following characteristics:<ul><li>It implements the IDiagnosticLogger service interface (provided interface).<li>It implements the <a class="el" href="class_i_k2_service_provider.html">IK2ServiceProvider</a> required interface, with a ServiceID of kDiagnosticLoggerService. You can reuse an existing implementation (kDiagLoggerServiceProviderImpl), delivered by the DiagnosticLog plug-in.</ul><p>If you implement a logger service, your logger is sent information about application events by the dispatcher component. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_dispatcher">Dispatcher</a>.<h3><a class="anchor" id="id_log_modifier_service"></a> Log-modifier service</h3><p>This extension pattern lets you modify what is logged by each logger service. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logger_service">Logger service</a>. A log-modifier service is implemented as a service provider, with the following characteristics:<ul><li>It implements the IDiagLogModifier service interface (provided interface).<li>It implements the <a class="el" href="class_i_k2_service_provider.html">IK2ServiceProvider</a> required interface, with a ServiceID of kDiagLogModifierService. You can reuse an existing implementation (kDiagLogModifierServiceProviderImpl), delivered by the DiagnosticLog plug-in.</ul><p>The log manager (IDiagLogManager) within the DiagnosticLog plug-in delegates to a log modifier on the following messages from the dispatcher: EnterContext(), ExitContext(), and LogMessage().<h2><a class="anchor" id="id_configuration_xml_element_catalog"></a> Configuration XML: element catalog</h2><p>As mentioned in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration_xml_file">Configuration XML file</a>, the behavior of the DiagnosticLog plug-in and associated logger services can be controlled by an XML file, which is named DiagnosticLogConfiguration_&lt;*&gt;.xml, where &lt;*&gt; is &quot;debug&quot; or &quot;release.&quot; In this section, we consider the XML vocabulary of this configuration file and provide constraints on its structure and the values that its elements and attributes can take.<p>The following example shows an abridged form of the default XML configuration file for the DiagnosticLog plug-in. Ellipses (...) indicates content that was omitted to keep the example short. One point to note about the default configuration is that neither the text-logger service nor the XML-based logger service is turned on. This means that, unless you vary the default configuration to enable at least one of these loggers, you will not see any output to either log file.<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span> standalone=<span class="stringliteral">&quot;yes&quot;</span>?&gt;</div><div class="line">&lt;DiagnosticLogConfiguration&gt;</div><div class="line"> &lt;filelocation outputpath=<span class="stringliteral">&quot;/Users/auser/Library/Caches/Adobe InDesign/Version 9.0/en_US/DiagLog&quot;</span>&gt;&lt;/filelocation&gt;</div><div class="line"> &lt;!-- Configuration (<span class="keyword">this</span>) file location :&quot;/Users/auser/Library/Caches/Adobe InDesign/Version 9.0/en_US/DiagLog&quot; --&gt;</div><div class="line"> &lt;iddatabase name=&quot;DiagnosticLogIDDB.xml&quot; load=&quot;true&quot;&gt;&lt;/iddatabase&gt;</div><div class="line"> &lt;logging enabled=&quot;true&quot; level=&quot;kDiagLogMaximum&quot; timeinfo=&quot;false&quot; timethreshold=&quot;10&quot;&gt;</div><div class="line"> &lt;category name=&quot;kDiagLogAction&quot; enabled=&quot;true&quot;&gt;</div><div class="line"> &lt;includelist&gt;&lt;/includelist&gt;</div><div class="line"> &lt;excludelist&gt;&lt;/excludelist&gt;</div><div class="line"> &lt;/category&gt;</div><div class="line"> ... Other category elemendebugcocoa64|releasecocoa64ts omitted </div><div class="line"> &lt;category name=&quot;kDiagLogEvents&quot; enabled=&quot;true&quot;&gt;</div><div class="line"> &lt;eventtype name=&quot;kActivate&quot; enabled=&quot;true&quot;&gt;&lt;/eventtype&gt;</div><div class="line"> ... Other category elements omitted </div><div class="line"> &lt;/category&gt;</div><div class="line"> ... Other category elements omitted</div><div class="line"> &lt;/logging&gt;</div><div class="line"> &lt;loggers&gt;</div><div class="line"> &lt;!-- file size and buffer size are in kilobytes (KB) --&gt;</div><div class="line"> &lt;logger name=&quot;text&quot; enabled=&quot;false&quot; outputfilesize=&quot;2048&quot;outputfilecount=&quot;3&quot; outputfilebuffersize=&quot;256&quot;&gt;&lt;/logger&gt;</div><div class="line"> &lt;logger name=&quot;xml&quot; enabled=&quot;false&quot; outputfilesize=&quot;2048&quot;outputfilecount=&quot;3&quot; outputfilebuffersize=&quot;256&quot;&gt;&lt;/logger&gt;</div><div class="line"> &lt;/loggers&gt;</div><div class="line">&lt;/DiagnosticLogConfiguration&gt;</div></div><p>In the sections from <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_category">&lt;category&gt;</a> to <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logging">&lt;logging&gt;</a>, we consider the organization of the XML configuration file in more detail and indicate how to configure this file to make the logger behave the way you want. One representation of the logical structure of this file can be seen in the following figure, which shows parent-child relationships between elements. This shows a view of the content model for the XML configuration file. The root element (&lt;DiagnosticLogConfiguration&gt;) is at the left of the diagram, and the tree extends to the right. For instance, you can see that the &lt;category&gt; element can have &lt;includelist&gt; and &lt;excludelist&gt; children. This same information also is represented in the sections describing each element (that is, the sections from <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_category">&lt;category&gt;</a>), along with additional information specifying constraints.<p>This is the content model of the configuration XML: <div class="image"><img alt="itk-guide-34.gif" src="itk-guide-34.gif" /></div><h3><a class="anchor" id="id_category"></a> &lt;category&gt;</h3><p>The &lt;category&gt; element represents information that controls how activity is logged for different categories of event source. The event category lists all event types as elements. It also has two attributes: name and enabled. Users can enable or disable an event category using a flag. The enabled flag at the event category level determines whether individual &lt;eventtype&gt; enabled flags are used.<p><b>Content model</b><div class="fragment"><div class="line">category ::= (includelist?, excludelist?, eventtype*)</div></div><p><b>Parent</b><ul><li>&lt;logging&gt;</ul><p><b>Children</b><ul><li>&lt;excludelist&gt;<li>&lt;includelist&gt;<li>&lt;eventtype&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>name </td><td>CDATA </td><td>Name of the category. </td><td>Required </td></tr><tr><td>enabled </td><td>CDATA </td><td>Whether activity in this category is logged. </td><td>Required </td></tr></table><p><b>name</b><p>This is a string value that corresponds to the name of the category for which you want to log activity. The complete list of values is in the IDiagLogConfigManager.h header file. This list consists of the following contexts and messages (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_contexts_and_messages">Contexts and messages</a>):<div class="fragment"><div class="line">kDiagLogAction, kDiagLogCommand, kDiagLogIdleTask, kDiagLogObserver, kDiagLogResponder, kDiagLogEvents, kDiagLogTracking, kDiagLogTransaction, kDiagLogMemoryPurge, kDiagLogGlobalErrorState, kDiagLogTextDamageMark</div></div><p><b>enabled</b><p>This is a string value representing a Boolean, where &quot;true&quot; means logging is enabled for the category, and &quot;false&quot; means it is disabled. Enabling or disabling logging at the category level determines whether enabled attributes at the level of individual &lt;eventtype&gt; elements are used.<p><b>Example</b><p>The following example shows a populated &lt;category&gt; element without any dependents.<div class="fragment"><div class="line">&lt;category name=<span class="stringliteral">&quot;kDiagLogMemoryPurge&quot;</span> enabled=<span class="stringliteral">&quot;true&quot;</span>&gt;&lt;/category&gt;</div></div><h3><a class="anchor" id="id_diagnosticlogconfiguration"></a> &lt;DiagnosticLogConfiguration&gt;</h3><p>The &lt;DiagnosticLogConfiguration&gt; element is the root element of the configuration file.<p><b>Children</b><ul><li>&lt;filelocation&gt;<li>&lt;iddatabase&gt;<li>&lt;logging&gt;<li>&lt;loggers&gt;</ul><h3><a class="anchor" id="id_eventtype"></a> &lt;eventtype&gt;</h3><p>The &lt;eventtype&gt; element controls whether particular user-interface events within the category kDiagLogEvents are logged.<p>The enabled flag of the parent &lt;category&gt; flag determines whether a specification at the &lt;eventtype&gt; level is used; for instance, if the parent category is not enabled, the enabling of individual &lt;eventtype&gt; elements has no effect.<p><b>Content model</b><div class="fragment"><div class="line">eventtype ::= (EMPTY)</div></div><p><b>Parent</b><ul><li>&lt;category&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>name </td><td>CDATA </td><td>Event name. </td><td>Required </td></tr><tr><td>enabled </td><td>CDATA </td><td>Whether event activity should be logged. </td><td>Required </td></tr></table><p><b>name</b><p>This is a string value that identifies the event type to enable or disable. The values this attribute can have are in the <a class="el" href="class_i_event.html#a3205e5bb34ac588a8dea504cbbbe2bd8">IEvent::IEventType</a> enumeration. You should leave out the <a class="el" href="class_i_event.html">IEvent</a>: qualifier; hence, the values are as follows:<div class="fragment"><div class="line">kActivate, kDeactivate, ...</div></div><p><b>enabled</b><p>This is a string value representing a Boolean, where &quot;true&quot; means logging is enabled for the category, and &quot;false&quot; means it is disabled. Enabling or disabling events on the &lt;category&gt; parent determines whether this attribute on the &lt;eventtype&gt; is used.<p><b>Example</b><p>The following example shows a populated &lt;eventtype&gt; element in the scope of a &lt;category&gt; element. Other elements are indicated by ellipses (...).<div class="fragment"><div class="line">&lt;category name=<span class="stringliteral">&quot;kDiagLogEvents&quot;</span> enabled=<span class="stringliteral">&quot;true&quot;</span>&gt;</div><div class="line"> ...</div><div class="line"> &lt;eventtype name=<span class="stringliteral">&quot;kLButtonDn&quot;</span> enabled=<span class="stringliteral">&quot;true&quot;</span>&gt;&lt;/eventtype&gt;</div><div class="line"> ...</div><div class="line">&lt;/category&gt;</div></div><h3><a class="anchor" id="id_excludelist"></a> &lt;excludelist&gt;</h3><p>The &lt;excludelist&gt; element can be used to explicitly filter out some application events, so information about them is not logged. It applies only to the categories listed in the following table. To identify application events to filter out, &lt;id&gt; elements are used.<p>If the &lt;category&gt; has both &lt;excludelist&gt; and &lt;includelist&gt; elements, and there is contention between them, the &lt;includelist&gt; always takes precedence.<p>Specifying values for each category:<table class="doxtable"><tr><th>Category </th><th>Value </th><th>ID Space </th></tr><tr><td>kDiagLogAction </td><td>ActionID, in hex. </td><td>kActionIDSpace </td></tr><tr><td>kDiagLogCommand </td><td><a class="el" href="class_command.html">Command</a> boss ClassID, in hex. </td><td>kClassIDSpace </td></tr><tr><td>kDiagLogIdleTask </td><td>Idle-task boss ClassID, in hex. </td><td>kClassIDSpace </td></tr><tr><td>kDiagLogObserver </td><td>Observer ImplementationID, in hex. </td><td>kImplementationIDSpace </td></tr><tr><td>kDiagLogResponder </td><td>Responder ImplementationID, in hex. </td><td>kImplementationIDSpace </td></tr><tr><td>kDiagLogTracking </td><td>Tracker boss ClassID, in hex. </td><td>kClassIDSpace </td></tr></table><p><b>Content model</b><div class="fragment"><div class="line">excludelist ::= (id)*</div></div><p><b>Parent</b><ul><li>&lt;category&gt;</ul><p><b>Child</b><ul><li>&lt;id&gt;</ul><p><b>Attribute</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>value </td><td>CDATA </td><td>Hex value specifying an identifier in a particular ID space. </td><td>Required </td></tr></table><p><b>value</b><p>This must correspond to the hex value of the identifier; for instance, 0x1e0 would be used for <a class="el" href="classk_mouse_watcher_idle_task_boss.html">kMouseWatcherIdleTaskBoss</a>. The ID space is associated with the parent &lt;category&gt; element. See the &lt;excludelist&gt; table, which gives more information about the ID spaces in which numeric identifiers are defined, for the categories that support this element.<p><b>Example</b><p>The following example logs all the idle tasks, except one associated with ClassID of <a class="el" href="classk_mouse_watcher_idle_task_boss.html">kMouseWatcherIdleTaskBoss</a> (ClassID = 0x1e0).<div class="fragment"><div class="line">&lt;category name=<span class="stringliteral">&quot;kDiagLogIdleTask&quot;</span> enabled=<span class="stringliteral">&quot;true&quot;</span>&gt;</div><div class="line"> &lt;includelist&gt;&lt;/includelist&gt;</div><div class="line"> &lt;excludelist&gt;</div><div class="line"> &lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0x1e0&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div><div class="line"> &lt;/excludelist&gt;</div><div class="line">&lt;/category&gt;</div></div><h3><a class="anchor" id="id_filelocation"></a> &lt;filelocation&gt;</h3><p>The &lt;filelocation&gt; element specifies the directory where the generated files should be placed, and stores the path to itself when last loaded by the application.<p><b>Content model</b><div class="fragment"><div class="line">filelocation ::= (EMPTY)</div></div><p><b>Parent</b><ul><li>&lt;DiagnosticLogConfiguration&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>outputpath </td><td>CDATA </td><td>Folder where output files should go. </td><td>Required </td></tr></table><p><b>outputpath</b><p>This specifies the directory where the output file should go, as a platform-dependent path. Output files include all log file(s), the symbol-database file, and the run-time environment file.<p><b>Example</b><p>The following example shows a populated &lt;filelocation&gt; element for Mac OS.<div class="fragment"><div class="line">&lt;filelocation outputpath=<span class="stringliteral">&quot;/Users/auser/Library/Caches/Adobe InDesign/Version 9.0/en_US/DiagLog&quot;</span> &gt;</div></div><h3><a class="anchor" id="id_id"></a> &lt;id&gt;</h3><p>The &lt;id&gt; element specifies a category ID to be included or excluded in the include/exclude list.<p><b>Content model</b><div class="fragment"><div class="line"><span class="keywordtype">id</span> ::= (EMPTY)</div></div><p><b>Parent</b><ul><li>&lt;excludelist&gt; or &lt;includelist&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>value </td><td>CDATA </td><td>Hex-valued identifier. </td><td>Required </td></tr></table><p><b>value</b><p>This is a numeric identifier, as a hex value; for instance, 0x1e0 or 0x1E0. This should specify something that makes sense within the ID space. The value could be an ImplementationID, ActionID, or ClassID. For more details, see the table in &lt;excludelist&gt;.<p><b>Example</b><div class="fragment"><div class="line">&lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0x1e0&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div></div><h3><a class="anchor" id="id_iddatabase"></a> &lt;iddatabase&gt;</h3><p>The &lt;iddatabase&gt; element represents information about the logger&#39;s symbol database file, such as whether it should be loaded. A symbol database file always is created when the Diagnostic Logger is running in the debug environment. It enables you to map numeric identifiers (for example, 0xE05, in ID space 0x101) into symbolic identifiers (for example, <a class="el" href="classk_open_doc_cmd_boss.html">kOpenDocCmdBoss</a>).<p>If you do not load the symbol database file, you will not get numeric identifiers mapped to symbolic identifiers, even in the debug build. To ensure that numeric identifiers are resolved to symbolic ones in both debug and release builds, change the this element&#39;s load attribute from its default of &quot;false&quot; to &quot;true.&quot;<p><b>Parent</b><ul><li>&lt;DiagnosticLogConfiguration&gt;</ul><p><b>Content model</b><div class="fragment"><div class="line">iddatabase ::= (EMPTY)</div></div><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>name </td><td>CDATA </td><td>Name of associated symbol database file. </td><td>Required </td></tr><tr><td>load </td><td>CDATA </td><td>Whether the symbol database should be loaded. </td><td>Required </td></tr></table><p><b>name</b><p>This is the name of the symbol database file. This is expected to be in the folder specified by the outputpath attribute of the &lt;filelocation&gt; element.<p><b>load</b><p>This is a string value representing a Boolean, where &quot;true&quot; means the symbol database is to be loaded (used to map numeric values to symbolic identifiers), and &quot;false&quot; (the default) means no numeric-to-symbolic mapping occurs.<p><b>Example</b><p>The following example shows a populated &lt;iddatabase&gt; element, with a default name for the symbol database file, and the load attribute set to ensure that numeric identifiers also are logged as symbolic identifiers.<div class="fragment"><div class="line">&lt;iddatabase name=<span class="stringliteral">&quot;DiagnosticLogIDDB.xml&quot;</span> load=<span class="stringliteral">&quot;true&quot;</span>&gt;&lt;/iddatabase&gt;</div></div><h3><a class="anchor" id="id_includelist"></a> &lt;includelist&gt;</h3><p>The &lt;includelist&gt; element specifies particular application events that should be logged within a given category. If it is populated, other events in this category are ignored. It is a way of asserting the primacy of some application events within a particular category: if you add one or more application events to the &lt;includelist&gt;, all other events in the category are ignored. See the table in &lt;excludelist&gt; for the list of categories for which an &lt;includelist&gt;child is supported; it is the same as the list categories that support an &lt;excludelist&gt; element.<p>If the &lt;category&gt; has both &lt;excludelist&gt; and &lt;includelist&gt; elements, and there is contention between them, the &lt;includelist&gt; always takes precedence.<p><b>Content model</b><div class="fragment"><div class="line">includelist ::= (id)*</div></div><p><b>Parent</b><ul><li>&lt;category&gt;</ul><p><b>Child</b><ul><li>&lt;id&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>value </td><td>CDATA </td><td>Hex value specifying an identifier in a particular ID space. </td><td>Required </td></tr></table><p><b>value</b><p>This must correspond to the hex value of the identifier; for instance, 0xE05 would be used for <a class="el" href="classk_open_doc_cmd_boss.html">kOpenDocCmdBoss</a>. The ID space is associated with the parent &lt;category&gt; element. See the table in &lt;excludelist&gt; for more information about the ID spaces in which numeric identifiers are defined, for the categories that support this element.<p><b>Example</b><p>The following example shows a populated &lt;includelist&gt; element, The example specifies that only information about a small subset of commands should be captured by logger services.<div class="fragment"><div class="line">&lt;category name=<span class="stringliteral">&quot;kDiagLogCommand&quot;</span> enabled=<span class="stringliteral">&quot;true&quot;</span>&gt;</div><div class="line"> \&lt;includelist\&gt;</div><div class="line"> &lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0xe05&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div><div class="line"> &lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0xe06&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div><div class="line"> &lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0xe07&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div><div class="line"> &lt;<span class="keywordtype">id</span> value=<span class="stringliteral">&quot;0xe08&quot;</span>&gt;&lt;/<span class="keywordtype">id</span>&gt;</div><div class="line"> &lt;/includelist&gt;</div><div class="line"> ... </div><div class="line">&lt;/category&gt;</div></div><h3><a class="anchor" id="id_logger"></a> &lt;logger&gt;</h3><p>The &lt;logger&gt; element controls a particular logger service (IDiagnosticLogger). Each logger service must serialize its state to XML, and each logger should choose a different name attribute, enabling it to serialize its state to XML and deserialize its state from XML. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logger_service">Logger service</a>.<p><b>Content model</b><div class="fragment"><div class="line">logger ::= (EMPTY)</div></div><p><b>Parent</b><ul><li>&lt;category&gt;</ul><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>name </td><td>NMTOKEN </td><td></td><td>Required </td></tr><tr><td>Enabled </td><td>CDATA </td><td></td><td>Required </td></tr><tr><td>OutputFileSize </td><td>CDATA </td><td>Optional, specified only for the existing text and logger service. </td><td></td></tr><tr><td>OutputFileCount </td><td>CDATA </td><td>Optional, specified only for the existing text and logger service. </td><td></td></tr><tr><td>OutputFileBufferSize </td><td>CDATA </td><td>Optional, specified only for the existing text and logger service. </td><td></td></tr></table><p><b>name</b><p>This is associated with a particular logger service. The logger services delivered by the DiagnosticLog component itself are named &quot;text&quot; and &quot;xml.&quot; If you implement your own logger service, it would have a corresponding &lt;logger&gt; element with a unique name to identify it.<p><b>Enabled</b><p>This is a string value, where &quot;true&quot; means this logger is turned on, and &quot;false&quot; means it is off. The default is &quot;false&quot; for text and XML logger services.<p><b>OutputFileSize</b><p>This specifies the maximum allowable log-file size before rollover, in kilobytes. Clients can use this attribute, in conjunction with OutputFileCount, to control the maximum amount of data the logger can write, in terms of file size and number. This attribute is supported by the text and XML logger services. When the amount of data already logged exceeds OutputFileSize, the log is rolled over or rotated to another log file.<p>Suppose the text-based logger starts emitting output to DiagnosticLogOutput_1.txt. When it emits an amount equal to OutputFileSize, it rolls over to start writing to DiagnosticLogOutput_2.txt. When the number of log files created reaches OutputFileCount, the logger returns to DiagnosticLogOutput_1.txt. The log files are cyclic (a bounded set); there cannot be more log files than OutputFileCount, and the logger wraps around to start logging at the start of the log-file set when required.<p><b>OutputFileCount</b><p>This is the maximum number of files the log rollover uses. This attribute is supported by the text and XML logger services. It specifies the number of output files to be used by log services, as explained above.<p><b>OutputFileBufferSize</b><p>This is the memory cache size, in kilobytes.This attribute is supported by the text and XML logger services. It controls the size of the memory cache that the DiagnosticLog plug-in uses to buffer output; the larger the buffer, the less often it needs to be flushed to disk.<p><b>Example</b><div class="fragment"><div class="line">&lt;logger name=<span class="stringliteral">&quot;text&quot;</span> Enabled=<span class="stringliteral">&quot;true&quot;</span> OutputFileSize=<span class="stringliteral">&quot;2048&quot;</span> OutputFileCount=<span class="stringliteral">&quot;3&quot;</span> OutputFileBufferSize=<span class="stringliteral">&quot;256&quot;</span>&gt;&lt;/logger&gt;</div></div><h3><a class="anchor" id="id_loggers"></a> &lt;loggers&gt;</h3><p>The &lt;loggers&gt; element specifies a collection of &lt;logger&gt; elements with which the DiagnosticLog component works. Some of these can be added by third parties, and the text and XML loggers are those provided by default by the DiagnosticLog component. By default, neither text nor XML logger services is enabled, so if you do not change the Enabled flag, you see no output from either service.<p><b>Parent</b><ul><li>&lt;DiagnosticLogConfiguration&gt;</ul><p><b>Child</b><ul><li>&lt;logger&gt;</ul><p><b>Content model</b><div class="fragment"><div class="line">loggers ::= (logger)+</div></div><p><b>Example</b><div class="fragment"><div class="line">&lt;loggers&gt;</div><div class="line"> &lt;logger name=<span class="stringliteral">&quot;text&quot;</span> Enabled=<span class="stringliteral">&quot;true&quot;</span> OutputFileSize=<span class="stringliteral">&quot;2048&quot;</span> OutputFileCount=<span class="stringliteral">&quot;3&quot;</span> OutputFileBufferSize=<span class="stringliteral">&quot;256&quot;</span>&gt;&lt;/logger&gt;</div><div class="line"> ...</div><div class="line">&lt;/loggers&gt;</div></div><h3><a class="anchor" id="id_logging"></a> &lt;logging&gt;</h3><p>The &lt;logging&gt; element determines whether the DiagnosticLog component should create log files and specifies other parameters to control it, such as the logging level. It also contains a list of &lt;category&gt; elements, each controlling how application events of different types are logged.<p><b>Parent</b><ul><li>&lt;DiagnosticLogConfiguration&gt;</ul><p><b>Child</b><ul><li>&lt;category&gt;</ul><p><b>Content model</b><div class="fragment"><div class="line">logging ::= (category)+</div></div><p><b>Attributes</b><table class="doxtable"><tr><th>Attribute name </th><th>Type </th><th>Summary </th><th>Required? </th></tr><tr><td>enabled </td><td>CDATA </td><td>Whether logging is turned on. </td><td>Required </td></tr><tr><td>level </td><td>CDATA </td><td>Detail level of logging. </td><td>Required </td></tr><tr><td>timeinfo </td><td>CDATA </td><td>Whether to log with timestamps. </td><td>Required </td></tr><tr><td>timethreshold </td><td>CDATA </td><td>Closest spacing of timestamps (msec). </td><td>Required </td></tr></table><p><b>enabled</b><p>This is a string value representing a Boolean. It overrides all other enabling flags in its dependents, such as &lt;category&gt; elements. If this flag is &quot;false,&quot; no logging output takes place.<p><b>level</b><p>This is the detail level. It controls the detail about what is logged for different categories; see the table in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logging_output_level">Logging output level</a>. The attribute is a string that should be one of the following values:<div class="fragment"><div class="line">kDiagLogMinimumkDiagLogMediumkDiagLogMaximum</div></div><p><b>timeinfo</b><p>This indicates whether timestamp information is logged.This information is logged as distinct application events, rather than being associated with specific events like an action or command being executed. The smaller the timethreshold attribute is set, the closer these entries are spaced in the log file.<p><b>timethreshold</b><p>This specifies how closely spaced the timestamp messages that get logged will be in the log file. This attribute specifies the lower time limit that is recorded, in msec. For example, in the current implementation, we use std::clock for timing information; since the resolution of clock is about 10 msec, do not set a value below 10.<p><b>Example</b><p>The following example shows a populated &lt;logging&gt; element with logging turned on, at an intermediate detail level, and with time information turned on.<div class="fragment"><div class="line">&lt;logging enabled=<span class="stringliteral">&quot;true&quot;</span> level=<span class="stringliteral">&quot;kDiagLogMedium&quot;</span> timeinfo=<span class="stringliteral">&quot;true&quot;</span> timethreshold=<span class="stringliteral">&quot;10&quot;</span>&gt;</div><div class="line"> ... </div><div class="line">&lt;/logging&gt;</div></div><h2><a class="anchor" id="id_troubleshooting"></a> Troubleshooting</h2><p>The following table provides some troubleshooting tips.<table class="doxtable"><tr><th>Issue </th><th>Cause </th><th>Resolution or workaround </th></tr><tr><td>I turned on the &lt;eventtype&gt; element, but the DiagnosticLog does not log anything. </td><td>There is hierarchical control over what information is logged. The parent element &lt;category&gt; determines whether the settings of its dependents are used. </td><td>You need to also turn on the kDiagLogEvents &lt;category&gt; element, to have individual events logged. See &lt;category&gt;. </td></tr><tr><td>When I run InDesign with DiagnosticLog, it does not log anything. </td><td>There are at least three elements in the configuration file whose &quot;Enabled&quot; attributes need to be turned on before any log is output: &lt;logging&gt;, &lt;category&gt;, and &lt;logger&gt;. </td><td>None of the &lt;loggers&gt; is turned on by default. The only category turned on by default is the Action. So, first enable a &lt;loggers&gt;, then turn on the category in which you are interested. </td></tr><tr><td>When I run InDesign with DiagnosticLog for the first time, in the default output location, I cannot find the DiagnosticLogConfiguration_debug.xml configuration file. </td><td>The configuration file is not written until InDesign quits. </td><td>Quit InDesign, then check the default output location again. You also can force the file to be written out programmatically, by calling IDiagLogConfigManager::Save(). </td></tr><tr><td>When I choose XML as my logger output option, sometimes when I try to open the XML, my XML viewer complains it cannot validate the XML and cannot open the file. </td><td>In some cases (for example, when an idle task yields to another thread), the context enter/exit are mismatched. This results in an XML-based log failing to be validated. </td><td>Try using the non-XML-based logger. You may not see perfect context matching, but all the context and events are still logged chronologically. Alternately, if you know the context that is causing the mismatching, try to exclude it from the logging. </td></tr></table><h2><a class="anchor" id="id_logging-related_solutions"></a> Logging-related solutions</h2><h3><a class="anchor" id="id_selectively_logging_information_about_individual_commands_or_actions"></a> Selectively logging information about individual commands or actions</h3><p>Suppose you want to log information about only a one-application event or a small set of application events, and you know the ActionID or ClassID (of command) or other identifiers for these events.<p><b>Solution</b><p>One way to do this is to define an &lt;includelist&gt; element (see &lt;includelist&gt;) in the configuration XML file (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration_xml_file">Configuration XML file</a>). This lets you define one or more application events within a given category that are of interest to you. Only information about those events is logged, if you define anything in your &lt;includelist&gt;.<p>The &lt;includelist&gt; lets you specify the list of application events in which you are interested. For instance, you might want to log information about only the <a class="el" href="classk_set_redline_tracking_cmd_boss.html">kSetRedlineTrackingCmdBoss</a> command, associated with turning tracked changes on and off. You would set up the &lt;includelist&gt; for the &lt;category&gt; element kDiagLogCommand; see the IDiagLogConfigManager::DiagLogCategory enumeration for other types. This &lt;includelist&gt; would have an &lt;id&gt; element with the correct identifier; for instance, 0xa415 for <a class="el" href="classk_set_redline_tracking_cmd_boss.html">kSetRedlineTrackingCmdBoss</a>.<p>You should find that the log produced by the DiagnosticLog plug-in contains information about only the application event you specified, within the specified category.<p>If you are interested in all application events in a particular category, you do not need to define an &lt;includelist&gt; element in the configuration XML, or it can be included in the configuration XML but with no dependents.<p><b>See also</b><ul><li>&lt;includelist&gt;</ul><p><b>Sample code</b><ul><li>LoggerPreferences</ul><p><b>API</b><ul><li>IDiagLogConfigManager::AddCategoryList()</ul><h3><a class="anchor" id="id_mapping_numeric_values_to_symbolic_identifiers_in_logger_output"></a> Mapping numeric values to symbolic identifiers in logger output</h3><p>Suppose you are writing code intended for a release build, you have a numeric value for something like a ClassID (for example, 0xa40a, or 41994 in decimal), and you want to turn it into a symbolic form (for example, <a class="el" href="classk_deleted_text_boss.html">kDeletedTextBoss</a>).<p><b>Solution</b><p>The symbol database file (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_symbol_database_file">Symbol database file</a>), produced under the InDesign debug build by the DiagnosticLog component, contains key-value pairs mapping numeric values to symbolic identifiers within the ID spaces used in the InDesign API. Follow these steps:<ol type="1"><li>Run the InDesign debug build with DiagnosticLog loaded, so the symbol database file, DiagnosticLogIDDB.xml, is generated.<li>Configure the release build of the DiagnosticLog plug-in to load the symbol database file. See &lt;iddatabase&gt;.</ol><p><b>See also</b><ul><li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_symbol_database_file">Symbol database file</a></ul><p><b>Sample code</b><ul><li>LoggerPreferences</ul><p><b>API</b><ul><li>IDiagLogIDDatabase::FindID()</ul><h2><a class="anchor" id="id_sample_code_for_diagnostic_logger"></a> Sample code for Diagnostic Logger</h2><h3><a class="anchor" id="id_installing_and_building_the_samples"></a> Installing and building the samples</h3><p>There are plug-in samples provided in the ITK that implement the patterns described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_extension_patterns">Extension patterns</a> and/or use the Diagnostic Logger client API. To build these samples, you need to first copy their projects and source files from the ITK into an existing InDesign SDK; the following table shows where the files/folders should be moved. After the projects and source files are moved, they can be built as normal SDK samples.<table class="doxtable"><tr><th>Files/Folders to copy from ITK</th><th>Copy to CC SDK folder </th></tr><tr><td>&lt;ITK&gt;/build/mac|win/prj/ConsoleLogger.itk.(xcodeproj|vcxproj)</td><td>&lt;SDK&gt;/build/&lt;mac|win&gt;/prj/ </td></tr><tr><td>&lt;ITK&gt;/build/mac|win/prj/DetailSwitchLogger.itk.(xcodeproj|vcxproj)</td><td>&lt;SDK&gt;/build/&lt;mac|win&gt;/prj/ </td></tr><tr><td></td></tr><tr><td>&lt;ITK&gt;/build/mac|win/prj/LoggerPreferences.itk.(xcodeproj|vcxproj)</td><td>&lt;SDK&gt;/build/&lt;mac|win&gt;/prj/ </td></tr><tr><td>&lt;ITK&gt;/source/itksamples/</td><td>&lt;SDK&gt;/source/ </td></tr><tr><td>&lt;ITK&gt;/source/private/</td><td>&lt;SDK&gt;/source/ </td></tr></table><h3><a class="anchor" id="id_loggerpreferences"></a> LoggerPreferences</h3><p>LoggerPreferences provides a user interface to manipulate a subset of the settings that control the Diagnostic Logger. The main purpose of the plug-in is to demonstrate how to use the IDiagLogConfigManager interface to change settings for the Diagnostic Logger at run time.<p>The normal pattern of using Diagnostic Logger, described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration">Configuration</a>, requires you to first run InDesign and exit the application to generate an XML configuration file (if no previous configuration exists), turn on at least one logging service through this XML configuration file, then restart InDesign before logging output is produced. In other words, you must exit the application before you can change any settings that control the Diagnostic Logger component. By default, the XML configuration file is read only on start-up by the Diagnostic Logger, so changes to that XML file would affect only the next run of InDesign.<p>The LoggerPreferences plug-in allows you to configure the Diagnostic Logger dynamically; for instance, to turn on a particular logger and determine which categories of output to log, and potentially see logging information being output immediately when a logger is enabled. The LoggerPreferences user interface allows you to manipulate a subset of the configuration settings for Diagnostic Logger. For more complete control over its settings, you can modify the plug-in to provide a more comprehensive user interface.<p>LoggerPreferences has an option to enable the console log (Console Logger sample logger service), which is not one of the default logger services provided by the DiagnosticLog plug-in. Make sure the ConsoleLogger plug-in (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_consolelogger">ConsoleLogger</a>) is loaded when LoggerPreferences is executed.<p><b>Using the LoggerPreferences sample</b><p>To start working with the LoggerPreferences sample:<ol type="1"><li>Compile the ConsoleLogger and LoggerPreferences projects for the build of the application you are targeting.<li>Ensure that the ConsoleLogger and LoggerPreferences plug-ins will be loaded; for instance, put them in the InDesign plug-ins folder, then launch InDesign.<li>To invoke the LoggerPreferences plug-in after it is loaded, choose Plug-ins &gt; SDK &gt; LoggerPreferences &gt; Configure Log Preferences: <div class="image"><img alt="itk-guide-35.gif" src="itk-guide-35.gif" /></div> A dialog displays to let you manipulate the settings that control the Diagnostic Logger component: <div class="image"><img alt="itk-guide-36.gif" src="itk-guide-36.gif" /></div></ol><p>The first group of widgets on the LoggerPreferences user interface, &quot;Logging master switch,&quot; corresponds to the enabled attribute of the &lt;logging&gt; element in the configuration XML file (see &lt;logging&gt;). This master switch must be turned on before any log can be output.<p>The second group of widgets, &quot;Which log to turn on?&quot;, determines whether a given logging service is enabled and other global properties of the logging behavior. This corresponds to the Enabled attribute of the &lt;logger&gt; element (see &lt;logger&gt;). The &quot;Resolve symbols with database&quot; check box corresponds to the load attribute of the &lt;iddatabase&gt; element (see &lt;iddatabase&gt;). The &quot;Logging detail level&quot; drop-down list corresponds to the level attribute of the &lt;logging&gt; element (see &lt;logging&gt;).<p>To see some logging output, you must turn on at least one logger service (Text, XML, or Console).<p>The last group of widgets corresponds to the &lt;category&gt; element; see &lt;category&gt;. Three of the more frequently used categories were chosen for demonstration purposes. For command and action categories, there are &quot;exclude&quot; and &quot;include&quot; text-entry boxes, corresponding to the &lt;excludelist&gt; and &lt;includelist&gt; elements in the configuration file. You should enter the command/action IDs in hex format. Multiple IDs are supported; use commas to separate IDs. For the Event category, click on the event you want to log; for multiple events, hold down the command/control key while clicking.<dl class="section note"><dt>Note<dd>The LoggerPreferences cannot clear out the command/action&#39;s exclude and include lists between sessions; it adds on to whatever is in the configuration file. This is due to a limitation on the IDiagLogConfigManager, which lacks the API that returns the current exclude/include list IDs.</dl><p>After the LoggerPreferences dialog is dismissed by clicking the OK button, the options are written out to the configuration XML file, and some logging information may be output, if at least one logger service is enabled. For instance, if ConsoleLogger is loaded, and a console window is open as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_consolelogger">ConsoleLogger</a> and enabled in the LoggerPreferences user interface, you should see logging output in the console window.<h3><a class="anchor" id="id_consolelogger"></a> ConsoleLogger</h3><p>The ConsoleLogger sample plug-in implements a console-based logging service. On Mac OS, its output is written to Console.app (which must be running before InDesign). On Windows, the ConsoleLogger writes output to a command-prompt window launched by the plug-in itself.<p>ConsoleLogger implements an extension pattern described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_logger_service">Logger service</a> (also see IDiagnosticLogger).<p><b>Using ConsoleLogger</b><p>To turn on the ConsoleLogger for real-time logging feedback:<ol type="1"><li>Make sure you already compiled the LoggerPreferences sample for the build of the application you are targeting; see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_loggerpreferences">LoggerPreferences</a>.<li>On Mac OS, launch Console.app, located in the Application/Utilities folder. On Windows, a command-prompt window is launched automatically by the ConsoleLogger plug-in itself.<li>Ensure that the ConsoleLogger and LoggerPreferences plug-ins will be loaded; for instance, put them in the plug-ins folder within the InDesign installation folder, then launch InDesign.<li>Bring up LoggerPreferences, as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_loggerpreferences">LoggerPreferences</a>. Make sure the logging master switch is turned on, the Console log check box is turned on, and at least one category is turned on. For initial testing purposes, turn on at least the action category.<li>Click OK, to dismiss the LoggerPreferences dialog. Move the console window to somewhere you can observe while running InDesign, then execute a menu action; for example, create a new document. Observe the output in the console; you should see some logging output related to the operations being performed.<li>To see logging information related to Diagnostic Logger settings without the subset manipulated through the LoggerPreferences user interface, exit InDesign, modify the configuration XML file (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_configuration_xml_file">Configuration XML file</a>), then relaunch InDesign.</ol><h3><a class="anchor" id="id_detailswitchlogger"></a> DetailSwitchLogger</h3><p>The DetailSwitchLogger sample plug-in provided in the ITK implements an extension pattern described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_log_modifier_service">Log-modifier service</a> (also see IDiagLogModifier). In this sample, two extensibility scenarios for the Diagnostic Logger are illustrated:<ol type="1"><li>Event-driven configuration - Changing the Diagnostic Logger configuration when a particular application event occurs.<li>Customizing logging output - Modifying the information that is passed through to all logger services.</ol><p><b>Event-driven configuration</b><p>To demonstrate this feature, DetailSwitchLogger is hard-coded to wait for the menu item Layout &gt; Pages &gt; Add Page (action ID kAddNewPageActionID) to be executed. After this menu-item action is executed, the DetailSwitchLogger sample plug-in (if loaded) changes the logging detail to maximum.<p>To see the event-driven configuration in operation, follow these steps:<ol type="1"><li>Make sure the DetailSwitchLogger plug-in is in a position to be loaded by the application; for instance, copy the plug-ins into the InDesign plug-ins folder.<li>Make sure the logging level is minimal, using LoggerPreferences or the XML configuration file. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_loggerpreferences">LoggerPreferences</a> and &lt;logging&gt;, in particular the level attribute. Also turn on the action-category logging.<li>Create a new document.<li>Choose Layout &gt; Pages &gt; Add Page<li>Now, if you examine the log output for any enabled logger service, you should see the following output nested somewhere in the log: <div class="fragment"><div class="line">Action actionid=<span class="stringliteral">&quot;0x5f1a(kAddNewPageActionID)&quot;</span></div><div class="line">actionname=<span class="stringliteral">&quot;Add New Page&quot;</span></div><div class="line">DswLgrDiagLogModifier:= <span class="stringliteral">&quot;===== log detail level is about to change to maximum =====&quot;</span></div></div><li>Execute a few more actions or command. You can verify that the log level now is more detailed, because it was changed to maximum by DetailSwitchLogger.</ol><p><b>Customized Logger output</b><p>To demonstrate this feature, DetailSwitchLogger is hard-coded to wait for a particular command (<a class="el" href="classk_create_multi_column_item_cmd_boss.html">kCreateMultiColumnItemCmdBoss</a>) to be processed. After the command is processed, the DetailSwitchLogger sample plug-in (if loaded) gathers extra information from data interfaces on the command boss object, which propagates to the logger services.<p>To see customized logger output:<ol type="1"><li>Make sure the DetailSwitchLogger plug-in is in a position to be loaded by the application; for instance, copy the plug-ins into the InDesign plug-ins folder. Make sure command category logging is turned on.<li>Create a new document.<li>Using the text tool, create a new text frame.<li>Examine the output produced by any enabled logger service. You should see something like the following: <div class="fragment"><div class="line"><a class="code" href="class_command.html">Command</a> classid=<span class="stringliteral">&quot;0x264(kCreateMultiColumnItemCmdBoss)&quot;</span></div><div class="line">cmdtype=<span class="stringliteral">&quot;normal&quot;</span></div><div class="line">targetdb=<span class="stringliteral">&quot;&quot;</span></div><div class="line">creatorid=<span class="stringliteral">&quot;612&quot;</span></div><div class="line"><a class="code" href="class_command.html">Command</a> Status:=<span class="stringliteral">&quot;FALSE&quot;</span></div><div class="line">Frame orientation is =<span class="stringliteral">&quot;horizontal&quot;</span></div></div></ol><p>Note that the information on the frame orientation is not part of the default log output, but because the DiagnosticLog supplies a reference to the command (<a class="el" href="class_i_command.html">ICommand</a>) being processed to the log modifier, we can customize the log output with this additional information from the context of the log-modifier (IDiagLogModifier) implementation. If you want to log extra information through Diagnostic Logger about arbitrary commands being processed, you can implement a log modifier and follow the pattern illustrated in this scenario.<h1><a class="anchor" id="id_symbol_resolver"></a> Symbol Resolver</h1><p>This chapter discusses how to use the Adobe &reg; InDesign&reg; symbol files provided in the InDesign Tool Kit (ITK). It describes the process of resolving symbols for development purposes, and it discusses a tool (CrashResolver) provided with the ITK to help resolve symbols from crash dumps on Mac OS&reg;.<h2><a class="anchor" id="id_introduction"></a> Introduction</h2><p>Third-parties developers often have two major debugging concerns when developing and deploying InDesign-based applications:<ul><li>When the debugger breaks at a breakpoint in source file, the stack crawl usually is meaningless, because it contains only an address.<li>When an application crashes at the customer&#39;s site, it is very hard to get a snapshot of exactly what caused the crash.</ul><p>By providing most InDesign source symbols, we address these concerns and make the development process easier. The call stack provides information on how the program reached the breakpoint or crash; sometimes it can provide hints on performance issues.<p>We discuss how to debug with the InDesign symbols for two scenarios:<ul><li>The scenario in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_real_time_interactive_debugging">Real-time, interactive debugging</a> is useful when your plug-in is under development and you have the plug-in project file as the starting point for a debugging session.<li>The scenario in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_postmortem_debugging">Postmortem debugging</a> is relevant when your plug-ins are deployed at a customer site and you are trying to debug after a crash on a customer&#39;s machine.</ul><p>The Mac OS version of InDesign has a crash-reporting feature; it generates a crash report similar to Apple&#39;s CrashReporter, but instead of being routed to Apple, the Adobe crash report can be sent to Adobe. You also can use the Adobe or Apple crash report to gain some insight into the condition of InDesign at the time of crash.<ul><li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashreporter">Adobe CrashReporter</a> discusses the Adobe reporting tool.<li><a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a> introduces a tool in the ITK that can be used in conjunction with the symbols to decipher the crash report.</ul><h2><a class="anchor" id="id_terminology"></a> Terminology</h2><p>The following terms are related to the resolution of Adobe InDesign symbols:<ul><li>Adobe CrashReporter - A crash-reporting tool similar to the standard crash reporter included with Mac OS X and Windows. It provides back-trace and register information from the time of the crash.<li>Adobe CrashResolver - A tool provided with ITK that converts the call stack and register dumps in output from the Apple CrashReporter or Adobe CrashReporter into a useful symbolic form. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a>.<li>Call stack - The execution history of a program, making it easier and faster to determine the root and triggering causes of particular issues. This also is referred to as backtrace or stack crawl.<li>Core dump file - A file that contains information that can be used to analyze the crash. The core dump represents a snapshot of the program memory at the time of its crash. This also is referred to as a crash dump.<li>Debugging symbol file - Holds information needed to locate and relocate a program&#39;s symbolic definitions and references.</ul><h2><a class="anchor" id="id_installation"></a> Installation</h2><p>The symbols in the ITK are packaged in a compressed archive; decompress the archive into a folder in your hard drive. Move the symbols folder to a place where you can find it easily later, and make sure the debug and release symbols are labeled correctly. The symbols are distributed in a folder structure described in this section.<h3><a class="anchor" id="id_windows_symbols"></a> Windows symbols</h3><p>On Windows, the InDesign build process extracts the symbol (.pdb) files into one debug|debugx64|release|releasex64 folder in the ITK. For example, the binary for the required plug-in AppFramework is in the required folder inside the application install folder with this path: <div class="fragment"><div class="line">&lt;InDesign&gt;/Required/</div></div><p>You will find its symbol file, AppFramework.pdb, in the symbols folder in the ITK at the following location: <div class="fragment"><div class="line">&lt;ITK&gt;/symbols/win/&lt;debug|debugx64|release|releasex64&gt;/Required/</div></div><p>By default, the Visual Studio debugger searches for a symbol file in the same folder as the executable; however, that is not an absolute requirement, as you can always tell the debugger where to find a symbol file later. Similarly, when you load a symbol file and the debugger cannot find its corresponding executable, it asks you to locate the matching binary. It is not necessary, therefore, to move the symbols to be in the same folder as their binaries.<h3><a class="anchor" id="id_mac_os_symbols"></a> Mac OS symbols</h3><p>On Mac OS, all symbol files (.dSYM) are extracted into one debug|release folder in the ITK, which does not maintain the same application install folder structure. Xcode requires the symbol file to be located with the binary, so the debugger can find the symbol in a debugging session. Since the symbols are distributed in a flat folder, you will need to move them to be in the same folder as their binaries. For example, the binary for the required plug-in AppFramework is in the applicaInDesign CC 2014l folder (for example, &quot;Adobe InDesign CC&quot;) at this path: <div class="fragment"><div class="line">&lt;Adobe InDesign &lt;version&gt;.app&gt;/Contents/MacOS/Required/AppFramework.InDesignPlugin</div></div><p>You should move the symbol for AppFramework.InDesignPlugin (AppFramework.InDesignPlugin.dSYM) to the following path: <div class="fragment"><div class="line">&lt;Adobe InDesign &lt;version&gt;.app&gt;/Contents/MacOS/Required/AppFramework.InDesignPlugin.dSYM</div></div><p>If you have many symbol files to open, consider creating a script that copies your frequently used symbol files to the same folder as their binaries. If you use Adobe CrashResolver to resolve symbols from Adobe CrashReporter output, you do not have to organize the symbols as described above, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a>. To install CrashResolver, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_setup_and_preferences">Setup and preferences</a>.<h2><a class="anchor" id="id_symbol_files"></a> Symbol files</h2><p>When applications or libraries are linked during build, the linker that creates the application and the libraries&#39; executable files also can create several additional files, known as symbol files. Typically, you can configure the linker through project settings in the IDE to generate a symbol file. On Windows, Visual Studio generates symbol files with an extension of .pdb (program debug database). On Mac OS, Xcode can generate symbol files in different formats, InDesign is built with the DWARF symbol format, and the symbol file has an extension of .dSYM.<p>Symbol files store information about function names and the addresses of their entry points, local/global variables, and the memory address or registers that hold the values of the variables. Both real-time, interactive debugging and postmortem debugging require symbols. You must obtain the symbols corresponding to the application that you want to debug and load these symbols into the debugger, so the debugger can resolve the symbols into something more readable by people.<p>In addition to the external symbol file, Mac OS programs and libraries built with Xcode can be compiled with some debugging symbols embedded. There is an option in the linker preferences to include local symbols in the binary. With embedded symbols, Xcode debuggers can be used to display the stack crawl during execution of the program directly, without the dSYM file. The debugger can give you not only memory addresses but also the names of routines and variables. The inclusion of debugging symbols, however, enlarges a program or library significantly; hence, during the final release build of the program, most applications, including InDesign, are stripped of symbols.<p>It is necessary to distinguish between the external symbol files and the embedded symbol. When we refer to the symbol file in this chapter, we mean the external symbol files included with the ITK, namely .pdb and .dSYM files.<h2><a class="anchor" id="id_windows_release_symbol_files"></a> Windows release symbol files</h2><p>For space-saving optimization purpose on Windows, we set EnableCOMDATFolding= &quot;2&quot; for most of our projects in release project properties.<p>In Visual Studio, this behavior is called COMDAT folding, also known as &quot;code folding.&quot; Within a single linkage (a single plug-in or library), when multiple functions share the same object code, only one copy of the code actually appears in the final linked output.<p>This is useful to reduce code size when using common C++ accessor paradigms that cannot be inlined because they are virtual; for example, simple accessors that return a value in a class may share the same object code.<p>This also is very useful to fight template bloat. The downside of this behavior is that debugging is more difficult: only one symbol name survives, which is confusing when you expect another one. This results in some stack frames in release appearing to be incorrect. It is not a problem in the symbol files. You can get around this by using the debug symbol files.<h2><a class="anchor" id="id_real_time_interactive_debugging"></a> Real-time, interactive debugging</h2><p>In this section, we discuss how to use symbols while your plug-in is under development. We discuss how to debug InDesign and your plug-in with the symbols, so you can see the call stack and variables (availability varies) when a breakpoint is encountered in the required IDEs; i.e., Visual Studio on Windows and Xcode on Mac OS.<h3><a class="anchor" id="id_windows_visual_studio_debugger"></a> Windows: Visual Studio debugger</h3><p><b>Start a debug session from a plug-in vcxproj file</b><p>By default, the SDK projects were built with the option to generate a .pdb file, so if your vcxproj file is based on an SDK project, the pdb file is generated when you build your project. If the plug-in binary is in the same directory as the .pdb file, Visual Studio finds and loads the symbol file. To load the InDesign symbols supplied with the ITK:<ol type="1"><li>Open your plug-in&#39;s project in Visual Studio. Build the plug-in, and make sure InDesign will load it.<li>In Solution Explorer, right-click the project name (for example, not the solution) and select Properties. In Configuration Properties &gt; Debugging, set <a class="el" href="class_command.html">Command</a> to be the path to InDesign.exe.<li>Visual Studio will tell you that InDesign.exe does not contain debugging information. Click OK to continue debugging.<li>If you did not previously set a breakpoint in your plug-in&#39;s source file, set a breakpoint at the place where you want to see the stack crawl, and try to execute InDesign to the breakpoint. If the breakpoint is encountered, Visual Studio stops at the line of code where the breakpoint is set. If the call-stack window is not displayed, choose Debug &gt; Windows &gt; Call Stack from Visual Studio to bring up the call stack.<li>Some entries on the call stack are grayed out; this is because the symbol file for that function is not loaded. Because you have the InDesign symbols in your hard drive, you can tell Visual Studio where to load the symbol file by right-clicking the grayed-out entry, selecting Load Symbols... from the contextual menu, and navigating to the folder that contains the symbol file for the plug-in. When you click the Open button in the Find Symbols dialog, Visual Studio will try to find the symbol in that folder. For example, if the grayed-out entry is WidgetBin.dll!4d7e6be1, try to open the folder that contains WidgetBin.pdb. After the symbol file is loaded, the grayed-out entry resolves to a function name. Repeat this step as needed to load all the symbols you want to use.<li>When you double-click an entry in the call stack, Visual Studio probably will ask you to locate the source file. If the source file is in the SDK, you can point to the file so you can see the source for the corresponding symbol; otherwise, Visual Studio displays assembly code if you wish.</ol><p>Another way to reload an individual symbol file is to specify its path in the solution properties. Before starting the debugging session:<ol type="1"><li>Choose Tools &gt; Options... from the menu bar in Visual Studio.<li>Choose Debugging &gt; Symbols, to bring up a list of paths to search for symbol files.<li>If your symbol file&#39;s path is not in the list, click the New Line icon to select a path for Visual Studio to search for symbol files. Visual Studio does not search recursively from the folder you specify, so if you have nested folders to search, you need to explicitly specify them in the list.<li>After the search path is specified, you can start your debugging session as usual. When the program stops at a breakpoint or crashes, you will see a resolved call stack with the help of symbol files.</ol><p><b>Start a debug session by attaching to a running InDesign process</b><p>With Visual Studio, you also can debug a program without a project file. To do this, attach your debugging session to a running process:<ol type="1"><li>Launch InDesign.<li>If Visual Studio is not running, launch it.<li>Choose Tools &gt; Attach To Process... This brings up a list of processes currently running. Select InDesign.exe, and click the Attach... button.<li>Visual Studio creates a temporary solution for you. Choose Tools &gt; Options, and choose Debugging &gt; Symbols to specify symbols location.<li>Click the Debug Symbol Files tab, and specify the symbol paths as described earlier.<li>After the symbol files&#39; paths are specified, you can set a breakpoint by invoking the Debug &gt; New Breakpoint... dialog. The caveat is that you need to know the location where you want to set the breakpoint. If you use this method to start a debug session, very likely you do not have your plug-in project to start the session, so the location of the breakpoint might take some guesswork.<li>After the breakpoint and symbol search paths are specified, you can try to execute the running InDesign to the point where you think you will hit the breakpoint. If the breakpoint is encountered, execution is stopped and the debugger is brought up. You can examine the stack crawl, as long as the symbols are loaded.</ol><p>Instead of attaching the process from Visual Studio, you could start the debug session from the Windows Task Manager. Right-click InDesign.exe from the Processes tab, and select Debug from the contextual menu. This brings up a dialog listing possible debuggers that you can use to debug. Select Visual Studio, then follow the steps described earlier.<h3><a class="anchor" id="id_mac_os_xcode_debugger"></a> Mac OS: Xcode debugger</h3><p><b>Start a debug session from a plug-in project .xcodeproj file</b><ol type="1"><li>We assume that you are building your plug-in directly into InDesign&#39;s plug-in folder. Your plug-in is built as a framework package. In Xcode&#39;s Debug Information Format setting, you can choose the DWARF or DWARF with dSYM option. Also, you should have moved the symbols to be with their binaries.<li>Open your plug-in project in Xcode and select Product &gt; Scheme &gt; Edit Scheme...<li>If not already select, select the Info tab.<li>Using the Executable drop-down menu, select Other... and browse to select InDesign&#39;s app file. To close the dialog, click the OK button.<li>To start debugging, select Product &gt; Run.<li>After the application launches, switch to the Xcode. Set a breakpoint in the source file where you want to debug. Then return to InDesign, and try to run InDesign to the point where the breakpoint is encountered. You also can also set the break point before the application is launched.<li>When the debugger stops at the breakpoint that you set in step 6, you will see the stack crawl in the Stack pane of the InDesign main thread window. If you moved the dSym file to the proper location, you will see the stack crawl in solid black, often with variable values available for debugging. If an entry in the stack crawl is grayed out, that means Xcode cannot load the symbol file that contains that function; most likely, the symbol file is not in the right place.</ol><p><b>Start a debug session by attaching to a running InDesign process</b><p>Xcode allows you to debug a running process so you do not have to start up the application from the Xcode to debug. You still need a project file to attach to a running InDesign process. The most logical choice is the project file for your plug-in. You also need to set up the executable so Xcode can find the host that loads your plug-in:<ol type="1"><li>Launch the InDesign application with symbols installed properly.<li>Open your plug-in project in Xcode and select Product &gt; Attach to Process &gt; Adobe InDesign.<li>Set a breakpoint, as described in &quot;Start a debug session from a plug-in project .xcodeproj file&quot; (in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_mac_os_xcode_debugger">Mac OS: Xcode debugger</a>). When the breakpoint is encountered or a crash occurs in InDesign, the Xcode debugger is brought to the front of the window, with debugging information.</ol><h2><a class="anchor" id="id_postmortem_debugging"></a> Postmortem debugging</h2><h3><a class="anchor" id="id_windows_windbg"></a> Windows: WinDbg</h3><p>WinDbg is part of Debugging Tools for Windows from Microsoft &reg;, available from Microsoft&#39;s website. It provides source-level debugging through a graphical user interface that wraps around CDB/NTSD and KD, command-line debuggers that also are available from Debugging Tools for Windows. WinDbg also can read a core dump after an exception is thrown from an application. This feature is particularly useful for post-crash debugging. If you have the symbols and core-dump file, you can get a view into the memory, registers, and other debugging information at the time of the crash.<p>To set up WinDbg for postmortem debugging:<ol type="1"><li>Set WinDbg as the default debugger for postmortem debugging: at the command prompt, change directory (cd) to the WinDbg directory, and enter the following command: <div class="fragment"><div class="line">windbg -I</div></div><li>Now, if you run InDesign and it crashes, WinDbg is invoked. Specify your symbols path, and ask WinDbg to reload the symbols.<li>After the symbols are loaded, ask WinDbg to display the call stack, which should be resolved by the symbol files.<li>You also can ask WinDbg to save the core-dump file, by issuing the following WinDbg command in its command line. Then you can reopen the core dump file later, on another machine with the same symbol files. <div class="fragment"><div class="line">.dump /mfh myfile.dmp</div></div></ol><p>This procedure is not the only way to do postmortem debugging using WinDbg; there are many useful links in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_references">References</a> for further reading. The WinDbg help file also contains useful details about how to debug using the Windows debugging tool.<h3><a class="anchor" id="id_mac_os_gdb"></a> Mac OS: GDB</h3><p>The most effective postmortem debugger on Mac OS is GDB (the GNU project debugger). Mac OS X can generate a core dump after a program crashes, and GDB can then start a core-dump debugging session. The core dump does not contain symbolic information, so you must supply the symbols using the GDB add-symbol-file command. Remember that you can enable core dumps on a system-wide basis, by adding the line &quot;limit core unlimited&quot; to /etc/launchd.conf. Alternately, you can use the following shell command in Terminal to generate a core dump on a per-session basis (and you need to start the application from Terminal): <div class="fragment"><div class="line">ulimit -c unlimited</div></div><p>When using core dumps, be aware of the core dump file in the /cores folder. Each core file is large, so clean up the /cores folder often, especially when you enable the core dump on a system-wide basis: every time there is a program crash, several hundred megabytes of core dumps are added to your hard drive. The folder usually is hidden from the Finder.<p>For more information about debugging a core file using GDB, see Apple&#39;s technical note #2124, &quot;Mac OS X Debugging Magic.&quot; There might be a limitation on using GDB with a core file; for example, a bt command may not show an entire backtrace. Apple Radar bug 5046663 was logged to address this issue.<h2><a class="anchor" id="id_adobe_crashreporter"></a> Adobe CrashReporter</h2><p>CrashReporter is a package for recording crash logs out of Adobe applications. When an application linked with CrashReporter crashes, it gives the user the option of submitting the crash logs to Adobe via e-mail.<p>The CrashReporter log is in XML format. It contains several sections of information, discussed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_crashreporter_log">CrashReporter log</a>.<p>When InDesign crashes, the CrashReporter log is written to the ~/Library/Logs/Adobe/LogTransport folder, and the user is presented with the following dialog: <div class="image"><img alt="itk-guide-37.gif" src="itk-guide-37.gif" /></div><dl class="section note"><dt>Note<dd>When CrashReporter is installed and set to record a crash log, it takes over Apple&#39;s default crash report, so no log is sent to Apple. The default path for the Apple&#39;s CrashReporter is ~/Library/Logs/CrashReporter/.</dl><p>If the user clicks Cancel, he exits gracefully, and the log file is deleted. If the user clicks Continue, he is presented with the following dialog: <div class="image"><img alt="itk-guide-38.gif" src="itk-guide-38.gif" /></div><p>The Problem Description edit field is a user-editable field that allows the user to add any information about the crash.<p>The Privacy Policy link opens a browser window with Adobe&#39;s privacy policy.<p>The Crash Data link opens a text editor with a text file that is loaded from a temporary location. It contains all the information about the crash, including a stack crawl, registers, library load locations and sizes, and any application-specific data the application adds.<dl class="section note"><dt>Note<dd>All log files that are sent are kept in an archived folder located at ~/Library/Logs/Adobe/LogTransport/Archive/&lt;Product name&gt;=&quot;&quot;&gt;/&lt;version&gt;</dl><h3><a class="anchor" id="id_crashreporter_log"></a> CrashReporter log</h3><p>The first few elements in the CrashReporter log are basic information, like the computer system where the crash occurred and the application that crashed. The following example shows an XML snippet extracted from the crash report, showing the general information section. <div class="image"><img alt="itk-guide-39.gif" src="itk-guide-39.gif" /></div><p>The &lt;crash exception&gt;=&quot;&quot;&gt; element shows the crash as &quot;Read Only Memory Exception,&quot; and the &lt;backtrace&gt; element tells us that the backtrace for this crash is displayed in crash thread 0, which is discussed in the next section.<h3><a class="anchor" id="id_backtrace"></a> Backtrace</h3><p>The last line in the previous example shows that the crash process&#39;s backtrace is available in crash thread 0. The following example is extracted from that thread. <div class="image"><img alt="itk-guide-40.gif" src="itk-guide-40.gif" /></div><p>Each stackStatement element in the backtrace describes a nested-function invocation (also referred to as a stack frame), with the most recently executed function at the top and the least recently executed at the bottom. The address attribute of the stackStatement element is the program-counter address in the frame. For frame 0 (that is, stackStatement index 0), this typically is the address of the instruction that caused the exception. For higher frames, this is the return address for the frame. The symbolName attribute of the stackStatement element is the symbolic name for the program-counter address in the address attribute. In this example, some stack frames have resolved the function name, because the symbols are available at the time of the crash. Some stack frames have symbol name &quot;unknown,&quot; because the symbols are not available. In the final release build, the symbols are stripped; therefore, the symbolName attribute probably will be unknown (or the name of a nearby, exported function). To resolve this, see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a>.<h3><a class="anchor" id="id_registers_information"></a> Registers information</h3><p>The element following &lt;backtrace&gt; is &lt;registerSet&gt;, which is a snapshot of the register&#39;s state at the time of the crash. The following is an example of the register set. Apple developer technical note 2123 and &quot;Mach-O Runtime Architecture&quot; (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_references">References</a>) contain excellent information on how to decipher register values. One thing to note is that the register name &quot;PC&quot; in the Adobe CrashReporter is the &quot;srr0&quot; in the Apple CrashReporter, which is the program counter at the time the exception occurred. That address should be the same as the address you see in the backtrace stackStatement 0. <div class="image"><img alt="itk-guide-41.gif" src="itk-guide-41.gif" /></div><h3><a class="anchor" id="id_binary-image_description"></a> Binary-image description</h3><p>The final part of the CrashReporter log tells you which plug-ins/libraries are loaded in the process. The following example is part of a sample binaryImageSet element. <div class="fragment"><div class="line">&lt;binaryImageSet&gt;</div><div class="line"> &lt;binaryImage start=<span class="stringliteral">&quot;0x00001000&quot;</span> end=<span class="stringliteral">&quot;0x00007fff&quot;</span> type=<span class="stringliteral">&quot;__TEXT&quot;</span> path=<span class="stringliteral">&quot;/Volumes/Nagano/Basil 440/Packages/debug/Adobe InDesign CC 2014.app/Contents/ MacOS/Adobe InDesign CC&quot;</span>/&gt;</div><div class="line"> &lt;binaryImage start=<span class="stringliteral">&quot;0x0000b000&quot;</span> end=<span class="stringliteral">&quot;0x0000dfff&quot;</span> type=<span class="stringliteral">&quot;__TEXT&quot;</span> path=<span class="stringliteral">&quot;/Volumes/Nagano/Basil 440/Packages/debug/Adobe InDesign CC 2014.app/Contents/ MacOS/InDesignModel.framework/Versions/A/InDesignModel&quot;</span>/&gt;</div></div><p>There is a command-line tool that you can use to debug without symbols, as described in Apple developer technical note 2123 (see <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_references">References</a>). Because the final release build is stripped of symbols, however, the technique is not particularly useful for third-party developers; therefore, a tool was developed to help resolve symbol names in a CrashReporter log, which is discussed in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a>.<h2><a class="anchor" id="id_adobe_crashresolver"></a> Adobe CrashResolver</h2><p>You may wonder what to do when a final release build InDesign crashes on a Macintosh &reg; at a customer site. There is no easy way to determine what causes the crash. This section discusses an ITK tool called CrashResolver, which you can use in a situation like this to get a meaningful stack crawl.<p>CrashResolver is an application that converts the stack crawl and register dumps in an Apple CrashReporter or Adobe CrashReporter log into a more informative stack crawl with function names, source filenames, some variable values, and source code (if available). To do this, CrashResolver must have access to the actual libraries and dSYM files that correspond to the correct version of the application that produced the crash log. If the source files for the build also are available, CrashResolver also provides code snippets for each function in the stack crawl.<p>To reduce the size of the InDesign binaries, we build the final release target of InDesign with the per-function local symbol stripped off (this is achieved by turning on the target setting &quot;Strip Debug Symbols During Copy&quot;). With the symbols stripped, neither Adobe or Apple&#39;s crash report can resolve the stack crawl into meaningful function names; the crash reports contain only the hex address of the function (or the offset to the nearest exported function, which is not very useful). For example, if you strip the symbols of your plug-in, the backtrace for the function in your plug-in would be something like this: <div class="fragment"><div class="line">&lt;stackStatement index=<span class="stringliteral">&quot;0&quot;</span> address=<span class="stringliteral">&quot;0x13a8ccac&quot;</span> symbolname=<span class="stringliteral">&quot;unknown&quot;</span>/&gt;</div></div><p>You can resolve the plug-in name using CrashReporter with the address 0x0904a674 and look up the loaded binary image&#39;s address range. The dyld_stub_binding_helper is the nearest export symbol, which is not very useful in this case; even if you have symbol files, there is no way to tell the crash report to resolve the symbols. Therefore, Adobe CrashResolver is provided in the ITK. Along with the symbol files, it can resolve the address and report a human-readable backtrace with more information. An example follows.<p>With BasicDialog built with symbols stripped, and when we forced a crash in <a class="el" href="class_bsc_dlg_dialog_controller.html#a80ef89c40ec1252853a750b4d310b299">BscDlgDialogController::ApplyDialogFields</a>, the Adobe CrashReporter reported a crash trace as follows: <div class="fragment"><div class="line">&lt;stackStatement index=<span class="stringliteral">&quot;0&quot;</span> address=<span class="stringliteral">&quot;0x13a8ccac&quot;</span> symbolname=<span class="stringliteral">&quot;unknown&quot;</span>/&gt;</div><div class="line">&lt;stackStatement index=<span class="stringliteral">&quot;1&quot;</span> address=<span class="stringliteral">&quot;0x03042824&quot;</span> symbolname=<span class="stringliteral">&quot;__ZN15CDialogObserver6UpdateERK6IDTypeI11ClassID_tagEP8ISubjectRKS0_I9PMIID_tagEPv&quot;</span>/&gt;</div><div class="line">&lt;stackStatement index=<span class="stringliteral">&quot;2&quot;</span> address=<span class="stringliteral">&quot;0x13a8cda4&quot;</span> symbolname=<span class="stringliteral">&quot;unknown&quot;</span>/&gt;</div><div class="line">&lt;stackStatement index=<span class="stringliteral">&quot;3&quot;</span> address=<span class="stringliteral">&quot;0x0ee9ff9c&quot;</span> symbolname=<span class="stringliteral">&quot;_GetPlugIn&quot;</span>/&gt;</div></div><p>With the symbols resolver set to minimal detail level, it reported the following: <div class="fragment"><div class="line">[0] BasicDialog.sdk (-) : _ZN22BscDlgDialogController17ApplyDialogFieldsEP14IActiveContextRK6IDTypeI12WidgetID_tagE + 0x0000001C /Volumes/Nagano/Basil 440/Adobe InDesign CC Products SDK/source/sdksamples/basicdialog/<a class="code" href="class_bsc_dlg_dialog_controller.html">BscDlgDialogController</a>.cpp + 114 lines</div><div class="line"></div><div class="line">[1] &acirc;&#128;&cent;&acirc;&#128;&cent;WidgetBinLib.dylib (-) : 0x03042824 : __ZN15CDialogObserver6UpdateERK6IDTypeI11ClassID_tagEP8ISubjectRKS0_I9PMIID_tagEPv <span class="comment">// couldn&#39;t find SYM file</span></div><div class="line"></div><div class="line">[2] BasicDialog.sdk (-) : _ZN20BscDlgDialogObserver6UpdateERK6IDTypeI11ClassID_tagEP8ISubjectRKS0_I9PMIID_tagEPv + 0x00000024 /Volumes/Nagano/Basil 440/Adobe InDesign CC Products SDK/source/sdksamples/basicdialog/<a class="code" href="class_bsc_dlg_dialog_observer.html">BscDlgDialogObserver</a>.cpp + 155 lines</div><div class="line"></div><div class="line">[3] AppFramework (-) : _ZN14CChangeManager24UpdateMarkedDependenciesERK17CDependencyObject6IDTypeI11ClassID_tagES2_RKS3_I9PMIID_tagEPvlP8K2VectorI17CDependencyMarker11K2AllocatorISC_EEb + 0x0000039C /Development/Basil/source/components/appframework/messaging/CChangeManager.cpp + 747 lines</div></div><p>You can see the unknown function in Adobe CrashReporter is replaced by the mangled _ZN22BscDlgDialogController17ApplyDialogFields. Also, in some situations, the variable values can be reported if they are saved in registers. The second entry of the Adobe CrashReporter output shows a meaningful function name, because the function is an exported function located in WidgetBinLib.dylib. Most of the exported and imported functions from a dylib will be visible in a stack frame even without a symbol file.<h3><a class="anchor" id="id_setup_and_preferences"></a> Setup and preferences</h3><p>Before using CrashResolver, set up the application as described in this section.<p><b>Requirements</b><ul><li>Apple CrashReporter (in ~/Library/Logs/CrashReporter) or Adobe CrashReporter logs from version 10.5 or later of Mac OS X. You can save a copy of the Adobe CrashReporter log when it is displayed in TextEdit, after you choose to view the Crash Data in the Adobe CrashReporter; alternately, a sent log is archived in ~/Library/Logs/Adobe/LogTransport/Archive/Adobe InDesign &lt;version&gt;/&lt;version number&gt;=&quot;&quot;&gt;, as explained in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_adobe_crashresolver">Adobe CrashResolver</a>.<li>Symbol files and executables (application and shared libraries) that correspond exactly to the version of the application that produced the crash log. For a Mach-O application like InDesign, dSYM files and the CrashReporter log are all that are needed to resolve the log.<li>If your symbol files are in dSYM format, they need to be located in a writable volume, CrashResolver will write to the dSym&#39;s package folder when it parses the symbol. So, if you obtain the dSYM from a CD, you need to copy the symbols into a writable volume.</ul><dl class="section note"><dt>Note<dd>CrashResolver works not only for InDesign, it also resolves all log file that meet the requirement; therefore we use &quot;symbol&quot; in stead of &quot;dSYM&quot; in this section.</dl><p><b>Setting up CrashResolver</b><p>The version and build targets (debug, release, etc.) for the application and libraries also must match those of the application that produced the crash. Using versions of libraries and symbol files that do not exactly match that of the crashing application is likely to produce incorrect results. In addition, if the crash occurs in an application built without trace-back tables or built-in debugging symbols, the symbol files and libraries must have been built the same way.<p>Before using CrashResolver for the first time, launch it and go the Preferences dialog to set it up, as described in next section.<p><b>CrashResolver preferences</b><p>All set-up for CrashReporter is done through its Preferences dialog: <div class="image"><img alt="itk-guide-42.gif" src="itk-guide-42.gif" /></div><p>The top of the dialog shows the location and name of the CrashResolver application.<p>Output Mode specifies how the output is recorded and displayed. You have the option of logging the info to the DebugWindow application (part of the InDesign SDK installation) or the Apple console.app, or writing the log to a text file. If you select the File option, you also can choose to have each output file opened automatically in your default text editor when CrashResolver finishes (the TextEdit option). CrashResolver tries to write some information out of order (that is, it appends warning messages to the header as it evaluates the stack trace). It can do this only if the File option is selected; with the other output options, warnings are interspersed within the stack trace, which may make them more difficult to read. The defaults selected are File and TextEdit.<p>Detail Level specifies how much information is included in the output. Final Function Source Code displays a source-code snippet (if source code is available) for the top (crashed) function in the trace. All Source Code displays a source-code snippet for each function in the trace. Both these options also display the contents of register variables in the top function in the trace. Since this register-variables feature does not require source code, you probably will want to leave the detail level at the highest level. In addition, you will want to use the displayed source-code snippets to verify that the correct version of symbol files was used to resolve the crash log.<p>The tabs in the dialog lets you specify four different folder locations. Click the Set button to set a path for each of the following:<ul><li>Primary - This specifies the location (folder or application package) where CrashResolver searches for libraries and symbol files with which it resolves your crash logs. If this is not specified-or you click the Clear button-this is the CrashResolver application parent folder.<li>Alternate - This specifies an additional folder that CrashResolver searches for libraries and symbol files with which to resolve your crash logs. If libraries or symbol files with the same name are found in both the primary and alternate locations, those in the primary location are used. This option allows you to resolve crash logs using incomplete builds of an application. For example, to set up CrashResolver for an InDesign Master Archive (MA) release, set the Primary path to the folder containing the MA libs/SYMs and the Alternate path to the complete build of the application on which the MA is based. Click the Clear button to use only the primary search path.<li>Source Code - Symbol files can contain full paths for each source file from which the associated library was built. If the symbol files were not built on the local machine, the source-file paths in the symbol file are not correct. This path specifies where CrashResolver should look for source-code files when they cannot be found at the paths given in a symbol file. This search is faster and more accurate if the folder hierarchy (and folder names) on the local machine match the hierarchy of source folders used during the build. If you click the Clear button, CrashResolver does not try to search for source files that are not at the paths specified in the symbol file.<li>Output - This specifies where CrashResolver output files should be written (if you select the File output mode above). You also have the option of entering a name for the output files. If a file with the given name already exists in the output folder, CrashResolver appends a number to the name. CrashResolver never overwrites existing output files. If you click the Clear button, CrashResolver writes the output files into its parent folder.</ul><p>All but the last of these paths let you specify a Follow Aliases When Searching option. With this selected, CrashResolver also searches any folders referenced by aliases found in the search path.<p>If you change the primary or alternate library/symbol file folder in the preferences dialog, CrashResolver automatically updates itself to reflect the change when you close the dialog (searching the folders again). If you add, remove, or rebuild libraries or symbol files while CrashResolver is running, you must quit and relaunch CrashResolver for the changes to take effect.<p>For simplicity, CrashResolver is designed to work with only one version of an application. If you need to be able to resolve crash logs from different applications or different versions of an application, you must create duplicates of CrashResolver and set up each one accordingly. For this reason, CrashResolver is a completely self-contained application package. It stores its preferences in its internal /Contents/Resources folder.<p><b>Updating CrashResolver</b><p>Because CrashResolver stores its preferences inside its application package, you normally would have to set up your preferences again when you upgrade to a new version of CrashResolver; however, CrashResolver includes a means for retaining your preferences when upgrading to a new version. After dragging the new copy of CrashResolver to its desired location, drag the old copy of CrashResolver onto the new one. You will be asked whether you want to copy your preferences. Click OK, and the old preferences are copied to the new copy of CrashResolver.<h3><a class="anchor" id="id_using_the_crash_log"></a> Using the crash log</h3><p>Drag the CrashReporter log that you want to decipher onto the CrashResolver application. You get a log containing a stack crawl for each crash contained in the CrashReporter log (CrashReporter logs may be cumulative, containing all crashes of the given application). You also can copy a selection of a CrashReporter log, launch CrashResolver, and choose Edit &gt; Paste. (You can copy and paste only the stack-crawl portion of an Apple CrashReporter log; however, you will need to copy and paste an entire Adobe CrashReporter log.) Where and how the output is displayed depends on the option you selected in the preferences dialog. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_crashresolver_output">CrashResolver output</a>.<dl class="section note"><dt>Note<dd>If the application and libraries contain CFBundleShortVersionString version strings in their info.plists, these strings are included in the CrashReporter log for each library of the crashed application. CrashResolver checks these version strings against the versions of the libraries used to resolve the log. If there are any mismatches, the output file includes a warning in its header; however, CrashResolver still tries to resolve the crash log.</dl><p>It is important to visually verify that the crash log was resolved with the correct version of libraries and symbol files. If source files are available, CrashResolver displays a snippet of code at each function call in the stack crawl. By checking to see that the function indicated in this snippet matches the name of the function in the stack crawl above it, you can determine that the output probably is valid. See <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_crashresolver_output">CrashResolver output</a>.<p>If the CrashReporter log-stack crawl already includes local debugging symbols (function names), you can still run the file through CrashResolver to get additional information, like the source-code snippets and the values of any register variables in the crashed function.<p>Also, for MachO executables that include no debugging symbols, the CrashReporter log may instead give offsets relative to exported functions. These exported functions often are not the functions from which the calls in the stack crawl were made. Running these log files through CrashResolver gives you the names of the correct function calls.<h3><a class="anchor" id="id_crashresolver_output"></a> CrashResolver output</h3><p>You have several options for recording the output of CrashResolver, selected in the preferences dialog: trace to the DebugWindow application or the Mac Console.app, or log to a file. If this last option is selected, the log file is written to the output folder with the name selected in the CrashResolver preferences. Every CrashReporter log dragged to CrashResolver is written to a separate output file. If you choose to write to a file, you also have the option of having the file open automatically in your default text application (usually TextEdit) after it is created; this is the default behavior.<p>The format of CrashResolver output is described below.<p>The output file header is as follows: <div class="fragment"><div class="line">CrashResolver - version: 2.3 build: Jan 28, 2010</div><div class="line">Adobe Systems Incorporated</div><div class="line">File: &lt;the name of the crash log file being processed&gt;</div><div class="line">Using: &lt;the primary folder/app containing the libraries and SYM files used to resolve the log&gt;</div><div class="line">and: &lt;alternate folder of lib/SYM files (see the preferences dialog)&gt;</div><div class="line">Crash incidents in <span class="keyword">this</span> log: 1</div></div><p>The header is followed by a list of crash incidents. Some CrashReporter logs include all crashes that occurred with the given application since the log file was last deleted. Each incident is preceded by the following header: <div class="fragment"><div class="line">1) ------------------------------- CRASH ---------------------------------</div><div class="line">OS Version: &lt;Mac OS version at the time of the crash&gt;</div><div class="line">Report Version: &lt;CrashReporter version number&gt;</div><div class="line">Application Version: &lt;Crashed application version number&gt;</div><div class="line">Date: &lt;Date and time of the crash&gt;</div><div class="line">Exception: &lt;The exception from the log&gt;</div></div><p>The crash-incident header is immediately followed by any warning messages concerning CrashResolver&#39;s attempt to resolve the stack crawl, like a mismatch in version numbers between any libraries in the crashed application and the lib/symbol files used to resolve the log.<dl class="section note"><dt>Note<dd>The absence of warning messages does not necessarily mean that you are using the correct version of libraries and symbol files. You still should visually verify that the stack crawl looks correct.</dl><p>This is followed by the resolved stack crawl. The stack crawl includes one entry for each line in the stack crawl from the CrashReporter log. A stack-crawl entry is preceded by a line number in brackets. If the entry could not be resolved, the line number is followed by &quot;&acirc;&#128;&cent;&acirc;&#128;&cent;.&quot; The reason for the failure follows in a C-style comment. The stack crawl is displayed in the same order in which it is presented in the CrashReporter log, that is, crashed function at the top, and application entry point at the bottom. The &quot;lib version string&quot; displayed is the version string taken from the CrashReporter log (if available) and is the version of the library in the crashed application. <div class="fragment"><div class="line">[1] &lt;library name&gt; (&lt;lib version <span class="keywordtype">string</span>&gt;) : &lt;mangled C++ <span class="keyword">function</span> name&gt; + &lt;offset&gt;&lt;source file and path&gt; - line: &lt;source file line number&gt;</div></div><p>This entry header is followed by the source code, if the source code is available and the appropriate detail level is selected in the preferences. The line at which the jump to the next line in the stack crawl occurred is marked in this source code snippet with an asterisk (*). <div class="fragment"><div class="line"><span class="keywordflow">if</span> (lwProcessing)</div><div class="line">{</div><div class="line"><span class="comment">// bypass command manager*</span></div><div class="line"> cmd-&gt;LWDoImmediate();</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line"> cmdMgr-&gt;Do(cmd);</div></div><p>You can verify that the resolution of the stack crawl appears valid by matching the function name at this mark against the &quot;mangled C++ function name&quot; in the line above this one in the stack crawl. They should be the same; for example: <div class="fragment"><div class="line">[3] PublicDbgLib (-) : .LWDoImmediate__7CommandFv + 0x00000088 ...:dragontail_gm:source:public:commands:<a class="code" href="class_command.html">Command</a>.cpp - line: 548 (source snippet omitted)</div><div class="line">[4] AppFramework (-) : .CommonProcessCommand__16CommandFP8ICommandUc + 0x00001120 ...:appframework:commandmgmt:CommandProcessor.cpp - line: 341</div><div class="line">if (lwProcessing)</div><div class="line">{</div><div class="line"><span class="comment">// bypass command manager*</span></div><div class="line"> cmd-&gt;LWDoImmediate(); (matches <span class="stringliteral">&#39;.LWDoImmediate__7CommandFv&#39;</span> above)</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line"> cmdMgr-&gt;Do(cmd);</div></div><dl class="section note"><dt>Note<dd>The method for mangling C++ function names is not standardized. Sometimes, the class and method names are reversed; however, you should be able to recognize the pattern.</dl><h3><a class="anchor" id="id_how_crashresolver_works"></a> How CrashResolver works</h3><p>CrashResolver works by first searching the primary (and, possibly, alternate) directories and all their subdirectories for applications, shared libraries, and symbol files. Executables are matched to their corresponding symbol files by filename.<p>In addition to the symbol files, the libraries are needed for two reasons:<ul><li>Both MachO and CFM executables contain nonexecutable information in the header of the library file. The executable portion is offset from the start of the container file. All offsets in a symbol file are relative to the start of the executable portion, not the start of the file. The stack traces in (Apple) CrashReporter logs report offsets relative to the start of the executable file if it is CFM, but relative to the start of the executable portion if it is MachO. Since symbol files do not specify the offset of the executable portion from the start of the container file, the libraries themselves are needed (the MachO libraries are needed to verify they are MachO). If you do not specify the libraries, CrashResolver assumes Mach-O; so, if you will resolve an InDesign crash log with its dSYMs, you do not really need to specify the libraries,.<li>CrashResolver matches the version string (if any) stored with the library against the version string listed for the library in the CrashReporter log, to verify that they match.</ul><p>When a CrashReporter log is dragged onto a copy of CrashResolver, it searches for all libraries and symbol files (when it is first launched). It then parses the CrashReporter log, looking for each stack trace corresponding to a crash. For each line in the stack trace, CrashResolver uses the symbol file of the corresponding name to determine the function name, source file, and (for the function at the top of the stack trace) the values of any variables stored in registers.<p>CrashResolver requires that the CrashReporter log contain both library names and offsets. Mac OS X 10.3 was the first version that included library names in CrashReporter logs. Crash logs from previous versions of Mac OS cannot be deciphered.<p>CrashResolver also can use the source files from which the application was built, if they are available. Whether CrashResolver looks for the source files depends on the &quot;Detail Level&quot; you selected in the preferences dialog. If you select a high level of detail and the source files are not available, the additional information they would have provided is not logged. CrashResolver uses the source files to calculate source-line numbers for each function in a stack trace. Also, having the source available allows CrashResolver to display a code snippet at each function call in the stack trace. This provides a convenient way to verify that the output looks correct; that is, the version of the symbol files used matches the version of the crashed application.<p>Because CrashReporter logs contain a dump of the contents of the registers at the time of the crash, CrashResolver can provide the values of any variables stored in registers at the time of the crash. CrashReporter stack traces, however, do not always end with the function in which the crash occurred: they sometimes stop with the function that called the crashing function. If this is the case, the variable values listed may not be correct.<h2><a class="anchor" id="id_frequently_asked_questions"></a> Frequently asked questions</h2><h3><a class="anchor" id="id_can_i_access_symbols_from_a_server"></a> Can I access symbols from a server?</h3><p>You should be able to open a symbol file located on a server, as long as you have access to the server. Both Xcode and Visual Studio support remote debugging. For set-up information, see the IDE&#39;s debugging manual.<h3><a class="anchor" id="id_after_i_load_the_symbol_file_why_dont_i_see_the_source_code"></a> After I load the symbol file, why don&#39;t I see the source code?</h3><p>The symbol file does not contain source code. If you want to do true, source-level debugging, you still need the original source code used to compile the project. The presence of symbols lets you examine the call stack and variables.<h3><a class="anchor" id="id_can_i_disable_the_adobe_crashreporter"></a> Can I disable the Adobe CrashReporter?</h3><p>CrashReporter can be set to any of three modes:<ul><li>Always show this dialog.<li>Don&#39;t show this dialog again and always send crashes to Adobe.<li>Don&#39;t show this dialog again and never send crashes to Adobe.</ul><p>Use the Adobe Crash Reporter Preference Chooser to set the InDesign CC 2014ow packInDesign CC 2014 for /Applications/Adobe InDesign CC/Adobe InDesign CC.<ol type="1"><li>Run: <div class="fragment"><div class="line">Contents/Frameworks/AdobeCrashReporter.framework/Versions/A/Resources/Adobe Crash Reporter. </div></div><li>Set the mode.</ol><h3><a class="anchor" id="id_why_dont_i_see_adobe_crashreporter_output_generated_on_the_mac_after_a_crash"></a> Why don&#39;t I see Adobe CrashReporter output generated on the Mac after a crash?</h3><p>Check the option described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_can_i_disable_the_adobe_crashreporter">Can I disable the Adobe CrashReporter?</a> to make sure Adobe CrashReporter is not disabled. Also, if you run the application from within a debugger, Adobe CrashReporter output is not generated after a crash.<h3><a class="anchor" id="id_how_can_i_suppress_the_adobe_crashreporter_dialog_box"></a> How can I suppress the Adobe CrashReporter dialog box?</h3><p>See the Apple Technical Q&amp;A on suppressing &quot;unexpected quit&quot; alerts: <a href="http://developer.apple.com/qa/qa2001/qa1288.html">http://developer.apple.com/qa/qa2001/qa1288.html</a><p>Adobe CrashReporter respects this setting.<h3><a class="anchor" id="id_why_dont_i_see_any_core_dump_file_generated_on_the_macintosh_after_a_crash"></a> Why don&#39;t I see any core dump file generated on the Macintosh after a crash?</h3><p>Apple&#39;s Technical Note TN2124 has the latest information on how to generate a core dump. To summarize, you should do one of the following:<ul><li>Add a &quot;limit core unlimited&quot; line to your /etc/launchd.conf file.<li>From Terminal, raise the core dump size limit by &quot;ulimit -c unlimited,&quot; then launch your program from the Terminal. If the program crashes, a core dump should be created in /cores.</ul><p>If neither of these methods works, try to disable Adobe Crash Reporter as described in <a class="el" href="id_adobe_indesign_cc_tool_kit_guide.html#id_can_i_disable_the_adobe_crashreporter">Can I disable the Adobe CrashReporter?</a>. The CrashReporter may have intercepted the crash signal. (The latest CrashReporter should not do this, but the older version may exhibit this behavior.)<h3><a class="anchor" id="id_why_doesnt_crashresolver_display_the_variable_value_all_the_time"></a> Why doesn&#39;t CrashResolver display the variable value all the time?</h3><p>CrashResolver relies on the CrashReporter and symbols to provide the information. During a crash, the CrashReporter captures the values in registers, so if the variable is stored in the register, CrashResolver can display the variable value. Not all variables are stored in registers; they could be in the stack/heap. Also, it depends on the type of the variable: the content of the register may contain an address to the real data. So, the variable value is not always available.<h3><a class="anchor" id="id_when_i_am_debugging_an_attached_windows_process_why_doesnt_the_debugger_stop_at_the_breakpoint"></a> When I am debugging an attached Windows process, why doesn&#39;t the debugger stop at the breakpoint?</h3><p>Most likely, Visual Studio cannot find the symbol file. Perhaps you did not specify the symbol search path, or you set the breakpoint before you specified the path. Try to delete the breakpoint, make sure the debug symbol path covers the path of your symbol, then set the breakpoint again. When a breakpoint is in effect, you should see a red dot next to the breakpoint name in the Breakpoints window.<h2><a class="anchor" id="id_references"></a> References</h2><ul><li>Using debugging tools for Windows; debugger.chm available from Debugging Tools for Windows, downloadable from:<ul><li><a href="http://www.microsoft.com/whdc/devtools/debugging/install64bit.mspx">http://www.microsoft.com/whdc/devtools/debugging/install64bit.mspx</a></ul><li>Microsoft&#39;s Debugging Tools and Symbols: Getting Started page:<ul><li><a href="http://www.microsoft.com/whdc/devtools/debugging/debugstart.mspx">http://www.microsoft.com/whdc/devtools/debugging/debugstart.mspx</a></ul><li>Mac OSX Reference Library:<ul><li><a href="http://developer.apple.com/mac/library/navigation/index.html">http://developer.apple.com/mac/library/navigation/index.html</a></ul><li>GDB manual:<ul><li><a href="http://developer.apple.com/documentation/DeveloperTools/gdb/gdb/gdb_toc.html">http://developer.apple.com/documentation/DeveloperTools/gdb/gdb/gdb_toc.html</a></ul><li>Apple Developer Technical Note 2123, CrashReporter:<ul><li><a href="http://developer.apple.com/technotes/tn2004/tn2123.html#SECNOSYMBOLS">http://developer.apple.com/technotes/tn2004/tn2123.html#SECNOSYMBOLS</a></ul></ul></div></div></div><div class="navpath" id="nav-path"><ul><li class="footer">Generated on Sat Sep 22 2018 10:53:03 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
