<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_text_attribute_run_iterator</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_text_attribute_run_iterator.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-methods">Public Member Functions</a> | <a href="class_text_attribute_run_iterator-members.html">List of all members</a></div><div class="headertitle"><div class="title">TextAttributeRunIterator Class Reference</div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_text_attribute_run_iterator_8h_source.html">TextAttributeRunIterator.h</a>&gt;</code><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a7f813acef4bfe412094605aea285017a"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a7f813acef4bfe412094605aea285017a">TextAttributeRunIterator</a> (<a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_in_design_1_1_text_range.html">InDesign::TextRange</a> &gt;::const_iterator firstRange, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_in_design_1_1_text_range.html">InDesign::TextRange</a> &gt;::const_iterator endOfRanges, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt;::const_iterator firstAttributeClass, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt;::const_iterator endOfAttributeClasses)</td></tr><tr class="separator:a7f813acef4bfe412094605aea285017a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a4a1e062de1f56b74e31192ed5aeed7d6"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a4a1e062de1f56b74e31192ed5aeed7d6">TextAttributeRunIterator</a> (const <a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a> &amp;other)</td></tr><tr class="separator:a4a1e062de1f56b74e31192ed5aeed7d6"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5bb2e516160e03a73d54f1593bebbdc9"><td align="right" class="memItemLeft" valign="top">const <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a5bb2e516160e03a73d54f1593bebbdc9">operator*</a> () const </td></tr><tr class="separator:a5bb2e516160e03a73d54f1593bebbdc9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a751e2ec84c6f9697634491fc6caee62e"><td align="right" class="memItemLeft" valign="top">const <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a751e2ec84c6f9697634491fc6caee62e">operator-&gt;</a> () const </td></tr><tr class="separator:a751e2ec84c6f9697634491fc6caee62e"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a6f3069eb9080fadac6a83b71d8a124ed"><td align="right" class="memItemLeft" valign="top"><a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a6f3069eb9080fadac6a83b71d8a124ed">operator++</a> ()</td></tr><tr class="separator:a6f3069eb9080fadac6a83b71d8a124ed"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a82e46868e0def4f79d8a2e91cda5e604"><td align="right" class="memItemLeft" valign="top">bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a82e46868e0def4f79d8a2e91cda5e604">operator&lt;</a> (const <a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a> &amp;other) const </td></tr><tr class="separator:a82e46868e0def4f79d8a2e91cda5e604"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a130b04d05ffe6fd16632617634cccff7"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a130b04d05ffe6fd16632617634cccff7">operator bool</a> ()</td></tr><tr class="separator:a130b04d05ffe6fd16632617634cccff7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aebf2924d388c1a4bec71b26103106ba8"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#aebf2924d388c1a4bec71b26103106ba8">ApplyAttributes</a> (const boost::shared_ptr&lt; <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> &gt; &amp;attributes, const <a class="el" href="class_i_d_type.html">ClassID</a> &amp;which=<a class="el" href="classk_char_attr_strand_boss.html">kCharAttrStrandBoss</a>)</td></tr><tr class="separator:aebf2924d388c1a4bec71b26103106ba8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a886b47b1da20aa1c40cddb9c35589ca7"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#a886b47b1da20aa1c40cddb9c35589ca7">ApplyAttribute</a> (<a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *attribute, const <a class="el" href="class_i_d_type.html">ClassID</a> &amp;which=<a class="el" href="classk_char_attr_strand_boss.html">kCharAttrStrandBoss</a>)</td></tr><tr class="separator:a886b47b1da20aa1c40cddb9c35589ca7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ac891b22a19aec1e85180a34c724bb37b"><td align="right" class="memItemLeft" valign="top"><a class="el" href="class_range_data.html">RangeData</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_text_attribute_run_iterator.html#ac891b22a19aec1e85180a34c724bb37b">GetRunRange</a> () const </td></tr><tr class="separator:ac891b22a19aec1e85180a34c724bb37b"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><pre class="fragment">The TextAttributeRunIterator class is very handy for walking through one or more text ranges,

examining the value of one or more text attributes within the ranges and optionally applying

different attributes to the ranges.



Here&#39;s a simple example for increasing the point size of text by &quot;incrementAmt&quot; relative to whatever

size it was to begin with.  Note that this works when the selection contains mixed point sizes since

the iterator &quot;walks&quot; to each range of text that has one consistent set of values for the given attributes.

(In this case each span of text that has the same point size with in the given set of ranges.)



    K2Vector&lt;ClassID&gt; attributeClasses;

    attributeClasses.reserve(1);

    attributeClasses.push_back(kTextAttrPointSizeBoss);



    TextAttributeRunIterator runIter(textRanges.begin(), textRanges.end(), attributeClasses.begin(), attributeClasses.end());



    while (runIter)

        {

</pre><p> At this point the only attribute in the <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> at *runIter is a <a class="el" href="classk_text_attr_point_size_boss.html">kTextAttrPointSizeBoss</a>. If the iterator had been constructed with more than one attribute in the attributeClasses vector, then QueryByClassID would be used to access the desired text attribute (i.e. runIter-&gt;QueryByClassID(kTextAttrPointSizeBoss, ITextAttrRealNumber::kDefaultIID)). <pre class="fragment">        InterfacePtr&lt;const ITextAttrRealNumber&gt; originalAttr(static_cast&lt;const ITextAttrRealNumber *&gt;(runIter-&gt;QueryBossN(0, ITextAttrRealNumber::kDefaultIID)));

</pre><p>Create a new attribute with an incremented point size. InterfacePtr&lt;ITextAttrRealNumber&gt; newAttr(this-&gt;CreateRealNumberAttribute(attributeClass, originalAttr-&gt;Get() + incrementAmt));<p>Apply the new point size to the range that had the previous point size. runIter.ApplyAttribute(newAttr);<p>++runIter; }<p>This iterator class is used extensively by the various implementations of <a class="el" href="class_i_text_attribute_suite.html">ITextAttributeSuite</a> to implement the increase/decrease and toggle attribute value features.<p>Applying attributes via the iterator doesn&#39;t invalidate the iterator. However, applying attributes outside the iterator, editing styles or performing text edits (insert/delete) do invalidate the iterator and will result in unpredicatable behavior. If you need to mix these operations with using a <a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a>, you should destruct and construct a new iterator after each &quot;external&quot; operation. </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2><a class="anchor" id="a7f813acef4bfe412094605aea285017a"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">TextAttributeRunIterator::TextAttributeRunIterator </td><td>(</td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_in_design_1_1_text_range.html">InDesign::TextRange</a> &gt;::const_iterator&nbsp;</td><td class="paramname"><em>firstRange</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_in_design_1_1_text_range.html">InDesign::TextRange</a> &gt;::const_iterator&nbsp;</td><td class="paramname"><em>endOfRanges</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt;::const_iterator&nbsp;</td><td class="paramname"><em>firstAttributeClass</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt;::const_iterator&nbsp;</td><td class="paramname"><em>endOfAttributeClasses</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Construct an interator by passing in iterators for the start and end of a range of <a class="el" href="class_in_design_1_1_text_range.html">InDesign::TextRange</a> objects within a vector. The TextRange vector can represent multiple ranges within a single text model (i.e. table cells), multiple ranges in different text models (i.e. text frame pointer tool selection), or just a single range in a single text model. And pass the same style of begin/end iterators into a vector of the ClassIDs of the text attributes to be considered when breaking the text into runs. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">firstRange</td><td>the first TextRange of those to be iterated. </td></tr><tr><td class="paramname">endOfRanges</td><td>the last+1th TextRange of those to be iterated. </td></tr><tr><td class="paramname">firstAttributeClass</td><td>the first attribute ClassID of those to be considered as part of a &quot;run&quot;. </td></tr><tr><td class="paramname">endOfAttributeClasses</td><td>the last+1th attributes ClassID of those to be consider as part of a &quot;run&quot;. </td></tr></table></dl></div></div><a class="anchor" id="a4a1e062de1f56b74e31192ed5aeed7d6"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">TextAttributeRunIterator::TextAttributeRunIterator </td><td>(</td><td class="paramtype">const <a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a> &amp;&nbsp;</td><td class="paramname"><em>other</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Copy constructor </div></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a886b47b1da20aa1c40cddb9c35589ca7"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode TextAttributeRunIterator::ApplyAttribute </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="paramname"><em>attribute</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_d_type.html">ClassID</a> &amp;&nbsp;</td><td class="paramname"><em>which</em> = <code><a class="el" href="classk_char_attr_strand_boss.html">kCharAttrStrandBoss</a></code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Applies a single text attributes to the range of text at the current position of the iterator. </div></div><a class="anchor" id="aebf2924d388c1a4bec71b26103106ba8"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode TextAttributeRunIterator::ApplyAttributes </td><td>(</td><td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>attributes</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_d_type.html">ClassID</a> &amp;&nbsp;</td><td class="paramname"><em>which</em> = <code><a class="el" href="classk_char_attr_strand_boss.html">kCharAttrStrandBoss</a></code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Applies the given set of text attributes to the range of text at the current position of the iterator. </div></div><a class="anchor" id="ac891b22a19aec1e85180a34c724bb37b"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname"><a class="el" href="class_range_data.html">RangeData</a> TextAttributeRunIterator::GetRunRange </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Returns the range of the current span of text at the iterator. </div></div><a class="anchor" id="a130b04d05ffe6fd16632617634cccff7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">TextAttributeRunIterator::operator bool </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Used to indicate when the iterator has fallen of the end of the list of ranges </div></div><a class="anchor" id="a5bb2e516160e03a73d54f1593bebbdc9"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">const <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a>&amp; TextAttributeRunIterator::operator* </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></div><div class="memdoc"><p>Returns an <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> at the current location of the iterator. WARNING: This const &amp; is only valid as long as the iterator is in scope and is altered by advancing (operator++) the iterator. If you wish to compare the attributes of consecutive runs, you need to either use 2 iterators or be sure to make a copy of the <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> before calling operator++. </div></div><a class="anchor" id="a6f3069eb9080fadac6a83b71d8a124ed"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname"><a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a>&amp; TextAttributeRunIterator::operator++ </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></div><div class="memdoc"><p>Advances the iterator to the next span of text where the list of attributes passed to the constructor all have the same values, and silently walks from each of the passed in text ranges to the next. </div></div><a class="anchor" id="a751e2ec84c6f9697634491fc6caee62e"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">const <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a>* TextAttributeRunIterator::operator-&gt; </td><td>(</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></div><div class="memdoc"><p>Allows for iter-&gt; usage to access the member functions of the <a class="el" href="class_attribute_boss_list.html">AttributeBossList</a> at the iterator location. </div></div><a class="anchor" id="a82e46868e0def4f79d8a2e91cda5e604"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">bool16 TextAttributeRunIterator::operator&lt; </td><td>(</td><td class="paramtype">const <a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a> &amp;&nbsp;</td><td class="paramname"><em>other</em></td><td>)</td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Compare the locations of two text iterators. This is really only meaningful if the iterators are in the same text model. </div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_text_attribute_run_iterator.html">TextAttributeRunIterator</a><li class="footer">Generated on Sat Sep 22 2018 10:56:32 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
