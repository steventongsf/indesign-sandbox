<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_auto_g_save</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_auto_g_save.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-methods">Public Member Functions</a> | <a href="class_auto_g_save-members.html">List of all members</a></div><div class="headertitle"><div class="title">AutoGSave Class Reference</div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_auto_g_save_8h_source.html">AutoGSave.h</a>&gt;</code><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:abbe232e8cc852e460819025f26c18325"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_auto_g_save.html#abbe232e8cc852e460819025f26c18325">AutoGSave</a> (<a class="el" href="class_i_graphics_port.html">IGraphicsPort</a> *graphicsPort)</td></tr><tr class="separator:abbe232e8cc852e460819025f26c18325"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a916504bb0e4ebdc899eca428d43bc651"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_auto_g_save.html#a916504bb0e4ebdc899eca428d43bc651">~AutoGSave</a> ()</td></tr><tr class="separator:a916504bb0e4ebdc899eca428d43bc651"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><pre class="fragment">Automatically calls IGraphicsPort::gsave in constructor and IGraphicsPort::grestore in destructor

so you donot have to explicitly call gsave and grestore. Just create an Object of AutoGSave with

in the scope and you are done.



e.g.

the following code



    InterfacePtr&lt;IGraphicsPort&gt; gPort(gc.GetViewPort(), IID_IGRAPHICSPORT);

    gPort-&gt;gsave();

    ...

    gPort-&gt;grestore();



would become



    InterfacePtr&lt;IGraphicsPort&gt; gPort(gc.GetViewPort(), IID_IGRAPHICSPORT);

    AutoGSave autoGSave(gPort);

</pre><p>!!! <a class="el" href="class_points.html">Points</a> to remember while using <a class="el" href="class_auto_g_save.html">AutoGSave</a><pre class="fragment">  Use AutoGSave only when you have gPort-&gt;gsave() and gPort-&gt;grestore() in the same scope.

  Do not use AutoGSave when you have some IGraphicsPort call after grestore().



e.g.



{

    port-&gt;setrgbcolor(0, 1, 0);

    port-&gt;gsave();

    port-&gt;setrgbcolor(1, 0, 0);

    port-&gt;rectfill(0, 0, 10, 10);

    port-&gt;grestore();

    port-&gt;rectfill(10, 0, 10, 10);

}



should not be converted to



{

    port-&gt;setrgbcolor(0, 1, 0);

    AutoGSave foo(port);

    port-&gt;setrgbcolor(1, 0, 0);

    port-&gt;rectfill(0, 0, 10, 10);

    port-&gt;rectfill(10, 0, 10, 10);

}



As the second call to rectfill will now draw a green rectangle, not a red one as intended.



  Do not forget to remove grestore() from all exit points.



e.g.



   void Foo(IGraphicsPort *port)

   {

       AutoGSave foo(port);

       ...

       if (abort) // whatever

       {

</pre><p> Do NOT call port-&gt;grestore() here! return; } ... }<p>Do not use <a class="el" href="class_auto_g_save.html">AutoGSave</a> whenever there are multiple gsave/grestore calls in the same scope. e.g. { gPort-&gt;gsave(); ... gPort-&gt;grestore(); ... gPort-&gt;gsave(); ... gPort-&gt;grestore(); }<p>You should avoid using gsave/grestore (or the <a class="el" href="class_auto_g_save.html">AutoGSave</a> utility) excessively - as it can have a dramatic impact on performance and on the quality of exported/printed content. There are no real hard and fast rules about its use, but you shouldn&#39;t use it without considering whether you truly need it. </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2><a class="anchor" id="abbe232e8cc852e460819025f26c18325"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">AutoGSave::AutoGSave </td><td>(</td><td class="paramtype"><a class="el" href="class_i_graphics_port.html">IGraphicsPort</a> *&nbsp;</td><td class="paramname"><em>graphicsPort</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span></td></tr></table></div><div class="memdoc"><p>Constructor </div></div><a class="anchor" id="a916504bb0e4ebdc899eca428d43bc651"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">AutoGSave::~AutoGSave </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">inline</span></span></td></tr></table></div><div class="memdoc"><p>Destructor </div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_auto_g_save.html">AutoGSave</a><li class="footer">Generated on Sat Sep 22 2018 10:53:10 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
