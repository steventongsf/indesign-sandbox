<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_app_prefs_import_delegate</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_app_prefs_import_delegate.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_app_prefs_import_delegate-members.html">List of all members</a></div><div class="headertitle"><div class="title">IAppPrefsImportDelegate Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_app_prefs_import_delegate_8h_source.html">IAppPrefsImportDelegate.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IAppPrefsImportDelegate:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_app_prefs_import_delegate.png" usemap="#IAppPrefsImportDelegate_map" /><map id="IAppPrefsImportDelegate_map" name="IAppPrefsImportDelegate_map"><area alt="IPMUnknown" coords="0,0,152,24" href="class_i_p_m_unknown.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:ad601e036e95dae5647b4d0f41d401251"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IAPPPREFSIMPORTDELEGATE }</td></tr><tr class="separator:ad601e036e95dae5647b4d0f41d401251"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab53d92b06f04431c88dc5f1f0dbabdc7"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">AttributeAction</a> { <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7a4801d6edf3bcf9ca709ee08d978077df">kApplyAttributes</a>, <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7afa14dbb5390d6644e46e1de5cd545ea3">kDontApplyAttributes</a>, <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7a8cd3532482d196361a66e9c496f2f626">kApplyNewAttributes</a> }</td></tr><tr class="separator:ab53d92b06f04431c88dc5f1f0dbabdc7"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:ad8caacd2eb6b0eb89e2eb66371915aed"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_app_prefs_import_delegate.html#ad8caacd2eb6b0eb89e2eb66371915aed">ShouldCreateNewElement</a> (bool16 defaultBehavior, IAppPrefsImportOptions::ListImportMatchAction importAction, <a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *parent, <a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *childToUse, const <a class="el" href="class_wide_string.html">WideString</a> &amp;elementName, const IDOMElement::AttributeList &amp;attributes)=0</td></tr><tr class="separator:ad8caacd2eb6b0eb89e2eb66371915aed"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad77f12ebd81a5125bf9d8b3bfd4530c4"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">AttributeAction</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_app_prefs_import_delegate.html#ad77f12ebd81a5125bf9d8b3bfd4530c4">ModifyAttributes</a> (<a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *elementFragment, <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">AttributeAction</a> defaultAttributeAction, const IDOMElement::AttributeList &amp;attributes, IDOMElement::AttributeList &amp;newAttributes)</td></tr><tr class="separator:ad77f12ebd81a5125bf9d8b3bfd4530c4"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a33f4236af34c60060b45d556803b056d"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_d_type.html">ScriptID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_app_prefs_import_delegate.html#a33f4236af34c60060b45d556803b056d">CompareElementsUsingProperty</a> (<a class="el" href="class_i_d_type.html">ScriptID</a> elementScriptID)</td></tr><tr class="separator:a33f4236af34c60060b45d556803b056d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a47e9edc7f71b09522d456f76ba75484f"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_app_prefs_import_delegate.html#a47e9edc7f71b09522d456f76ba75484f">ShouldDeleteElement</a> (<a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *domElement, bool16 defaultShouldDeleteValue) const =0</td></tr><tr class="separator:a47e9edc7f71b09522d456f76ba75484f"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>This is an interface for customizing the Import of Application Preferences The methods in this interfaces are callbacks from the import process that allows the client to have a say in the import </div><h2 class="groupheader">Member Enumeration Documentation</h2><a class="anchor" id="ab53d92b06f04431c88dc5f1f0dbabdc7"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">enum <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">IAppPrefsImportDelegate::AttributeAction</a></td></tr></table></div><div class="memdoc"><p>What should be done with the specified attributes <table class="fieldtable"><tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ab53d92b06f04431c88dc5f1f0dbabdc7a4801d6edf3bcf9ca709ee08d978077df"></a>kApplyAttributes</em>&nbsp;</td><td class="fielddoc"><p>apply the original attributes to the element </td></tr><tr><td class="fieldname"><em><a class="anchor" id="ab53d92b06f04431c88dc5f1f0dbabdc7afa14dbb5390d6644e46e1de5cd545ea3"></a>kDontApplyAttributes</em>&nbsp;</td><td class="fielddoc"><p>will cause the element to remain unchanged </td></tr><tr><td class="fieldname"><em><a class="anchor" id="ab53d92b06f04431c88dc5f1f0dbabdc7a8cd3532482d196361a66e9c496f2f626"></a>kApplyNewAttributes</em>&nbsp;</td><td class="fielddoc"><p>apply the attributes returned in the newAttributes parameter </td></tr></table></div></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a33f4236af34c60060b45d556803b056d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_d_type.html">ScriptID</a> IAppPrefsImportDelegate::CompareElementsUsingProperty </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_type.html">ScriptID</a>&nbsp;</td><td class="paramname"><em>elementScriptID</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">virtual</span></span></td></tr></table></div><div class="memdoc"><p>When looking for existing items that match the item imported, we use specific properties to handle the match. For most list items, the property used to &quot;match&quot; items is the name property. This callback will be called when looking for a match of an incoming element. The most common usage of this callback is to return &#39;p_Name&#39; when a 3rd party list item is the elementScriptID. If you add a list element, it won&#39;t automatically use the name as a way to match items, you must use this callback to specify the property element you&#39;d like to use as the matching property. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">elementScriptID</td><td>the ScriptID of the element we are looking to match </td></tr></table></dl><dl class="section return"><dt>Returns<dd>return the ScriptID of the property you&#39;d like used as the matching property. &#39;p_Name&#39; is the most common. return kInvalidScriptID to get default behavior </dl></div></div><a class="anchor" id="ad77f12ebd81a5125bf9d8b3bfd4530c4"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">AttributeAction</a> IAppPrefsImportDelegate::ModifyAttributes </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *&nbsp;</td><td class="paramname"><em>elementFragment</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_app_prefs_import_delegate.html#ab53d92b06f04431c88dc5f1f0dbabdc7">AttributeAction</a>&nbsp;</td><td class="paramname"><em>defaultAttributeAction</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const IDOMElement::AttributeList &amp;&nbsp;</td><td class="paramname"><em>attributes</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">IDOMElement::AttributeList &amp;&nbsp;</td><td class="paramname"><em>newAttributes</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">virtual</span></span></td></tr></table></div><div class="memdoc"><p>When an object is imported, the attributes on the imported XML element are used to set the properties of the item This callback allows the delegate to change the XML attributes before they are applied to the newly created object or to the matching object. Changing the attribute list should be done very carefully as it can easily lead to problematic scenarios. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">elementFragment</td><td>the IDOMElement* of the item to which the attributes will be applied </td></tr><tr><td class="paramname">defaultAttributeAction</td><td>this is the default behavior. If you want default behavior, return this parameter </td></tr><tr><td class="paramname">attributes</td><td>these are the attributes that were imported from the XML </td></tr><tr><td class="paramname">newAttributes</td><td>this is a list of new attributes, if AttributeAction returned is kApplyNewAttributes, the attributes in this list will be applied instead of the original attributes</td></tr></table></dl><dl class="section return"><dt>Returns<dd>kApplyAttributes will apply the original attributes to the element. kDontApplyAttributes will cause the element to remain unchanged, no attributes will be applied. kApplyNewAttributes will apply the attributes returned in the newAttributes parameter. return defaultAttributeAction to get default behavior </dl></div></div><a class="anchor" id="ad8caacd2eb6b0eb89e2eb66371915aed"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IAppPrefsImportDelegate::ShouldCreateNewElement </td><td>(</td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>defaultBehavior</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">IAppPrefsImportOptions::ListImportMatchAction&nbsp;</td><td class="paramname"><em>importAction</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *&nbsp;</td><td class="paramname"><em>parent</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *&nbsp;</td><td class="paramname"><em>childToUse</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_wide_string.html">WideString</a> &amp;&nbsp;</td><td class="paramname"><em>elementName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const IDOMElement::AttributeList &amp;&nbsp;</td><td class="paramname"><em>attributes</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This method is called for each root object(direct child of application) read in during the import process to gove the delegate a chance to decide if the match found should be used or if a new element should be created. Returning kTrue does not always work, some objects, like regular preferences, cannot be created <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">defaultBehavior</td><td>to get default behavior, return this value </td></tr><tr><td class="paramname">importAction</td><td>the current preference for reusing the existing element or replacing the element </td></tr><tr><td class="paramname">parent</td><td>the IDOMElement* of the parent element of the matching element </td></tr><tr><td class="paramname">childToUse</td><td>the IDOMElement* of the matching item </td></tr><tr><td class="paramname">elementName</td><td>the XML element name of the element that represents the object </td></tr><tr><td class="paramname">attributes</td><td>the XML attributes associated with elementName</td></tr></table></dl><dl class="section return"><dt>Returns<dd>kTrue to create a new object instead of using the match, kFalse to use the matching object that was passed in </dl></div></div><a class="anchor" id="a47e9edc7f71b09522d456f76ba75484f"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IAppPrefsImportDelegate::ShouldDeleteElement </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_o_m_element.html">IDOMElement</a> *&nbsp;</td><td class="paramname"><em>domElement</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>defaultShouldDeleteValue</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td> const</td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>When we&#39;ve imported all the objects, we go thru the list of all children of the application object and call this callback to determine if the item should be deleted. The default behavior is passed in defaultShouldDeleteValue and you can return that to get default behavior. This will use the DOM delete which may not work for all element types, so another use is to check defaultShouldDeleteValue and delete an element yourself, then return kFalse. Also, note that not all element types can be deleted, so returning kTrue for some element types may cause errors. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">domElement</td><td>the element in question. Should this element be deleted or not? </td></tr><tr><td class="paramname">defaultShouldDeleteValue</td><td>default behavior. This is what would normally happen if there was no delegate </td></tr></table></dl><dl class="section return"><dt>Returns<dd>return kTrue to have the element deleted via the import process, kFalse to tell the import process not to delete. To get default behavior, return defaultShouldDeleteValue </dl></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_app_prefs_import_delegate.html">IAppPrefsImportDelegate</a><li class="footer">Generated on Sat Sep 22 2018 10:53:50 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
