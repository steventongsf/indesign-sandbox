<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_snapshot_utils_ex</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_snapshot_utils_ex.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="#pro-attribs">Protected Attributes</a> | <a href="class_snapshot_utils_ex-members.html">List of all members</a></div><div class="headertitle"><div class="title">SnapshotUtilsEx Class Reference</div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_snapshot_utils_ex_8h_source.html">SnapshotUtilsEx.h</a>&gt;</code><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a8670ca90e6e75ac6d175c6dcc08340e3"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a> { <b>kCsGray</b>, <b>kCsRGB</b>, <b>kCsCMYK</b>, <b>kCsLab</b> }</td></tr><tr class="separator:a8670ca90e6e75ac6d175c6dcc08340e3"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a8d3e5e63be715bcc49afa179a5cde5dc"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a8d3e5e63be715bcc49afa179a5cde5dc">SnapshotUtilsEx</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;itemUIDRef, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;xScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;yScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;desiredRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;minRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;bleedAmount=0.0, <a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a> colorSpace=kCsRGB, bool8 addTransparencyAlpha=kFalse, bool8 simulateOverprint=kFalse)</td></tr><tr class="separator:a8d3e5e63be715bcc49afa179a5cde5dc"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:acd701c6bc7addc32f12a7d30402b3114"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#acd701c6bc7addc32f12a7d30402b3114">SnapshotUtilsEx</a> (const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;clippingBounds, const <a class="el" href="class_p_m_matrix.html">PMMatrix</a> &amp;boundsToSpreadMatrix, const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;itemUIDRef, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;xScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;yScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;desiredRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;minRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;bleedAmount=0.0, <a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a> colorSpace=kCsRGB, bool8 addTransparencyAlpha=kFalse, bool8 simulateOverprint=kFalse)</td></tr><tr class="separator:acd701c6bc7addc32f12a7d30402b3114"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af067c52e29ce581e04a6047d13f998e3"><td align="right" class="memItemLeft" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#af067c52e29ce581e04a6047d13f998e3">SnapshotUtilsEx</a> (const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;clippingBounds, const <a class="el" href="class_p_m_matrix.html">PMMatrix</a> &amp;boundsToSpreadMatrix, <a class="el" href="class_i_data_base.html">IDataBase</a> *database, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;xScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;yScaleFactor=1.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;desiredRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;minRes=72.0, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;bleedAmount=0.0, <a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a> colorSpace=kCsRGB, bool8 addTransparencyAlpha=kFalse, bool8 simulateOverprint=kFalse)</td></tr><tr class="separator:af067c52e29ce581e04a6047d13f998e3"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a1c6dae481ca9445e111b846336da63cf"><td align="right" class="memItemLeft" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a1c6dae481ca9445e111b846336da63cf">~SnapshotUtilsEx</a> ()</td></tr><tr class="separator:a1c6dae481ca9445e111b846336da63cf"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aae2d859788908fe159aef2a29af46d37"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#aae2d859788908fe159aef2a29af46d37">Draw</a> (int32 flags=<a class="el" href="class_i_shape.html#aa9e07a92fd22dc760e7f04a582c16683a113121acc1b1e40704fd5d331ca9532e">IShape::kPreviewMode</a>, bool32 fullResolutionGraphics=kFalse, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;greekBelowPtSize=7.0, bool32 enableAntiAliasing=kTrue, SnapshotUtils::Transparencies transparencyQuality=SnapshotUtils::kXPHigh, <a class="el" href="class_idle_timer.html">IdleTimer</a> *abortCheck=nil, VPAttrMap *pVPAttrMap=nil, bool32 bDrawNonPrintingObjects=kTrue)</td></tr><tr class="separator:aae2d859788908fe159aef2a29af46d37"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:afba2b3f0fe8b8dd7e2da93811b54176a"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#afba2b3f0fe8b8dd7e2da93811b54176a">Draw</a> (<a class="el" href="class_i_d_type.html">UID</a> pageItem, int32 flags, bool32 fullResolutionGraphics, const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;greekBelowPtSize, bool32 enableAntiAliasing, SnapshotUtils::Transparencies transparencyQuality, <a class="el" href="class_idle_timer.html">IdleTimer</a> *abortCheck=nil, VPAttrMap *pVPAttrMap=nil, bool32 bDrawNonPrintingObjects=kTrue)</td></tr><tr class="separator:afba2b3f0fe8b8dd7e2da93811b54176a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a377b63debee96bc890474a4a0ae3bc84"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a377b63debee96bc890474a4a0ae3bc84">ExportImage</a> (<a class="el" href="class_i_d_type.html">ClassID</a> formatClass, <a class="el" href="class_i_p_m_stream.html">IPMStream</a> *writeStream, bool8 colorMapped)</td></tr><tr class="separator:a377b63debee96bc890474a4a0ae3bc84"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa0b9039b572c6ffa53db89870df5648c"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#aa0b9039b572c6ffa53db89870df5648c">ExportImageToJPEG</a> (<a class="el" href="class_i_p_m_stream.html">IPMStream</a> *writeStream, SnapshotUtils::SSJPEGEncoding encoding=SnapshotUtils::kSSJPEGBaseline, SnapshotUtils::SSJPEGQuality quality=SnapshotUtils::kSSJPEGExcellentQuality, bool embedColorProfile=false)</td></tr><tr class="separator:aa0b9039b572c6ffa53db89870df5648c"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a8e2822b1cbf57c59baec7f8e53bfc2d0"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a8e2822b1cbf57c59baec7f8e53bfc2d0">ExportImageToTIFF</a> (<a class="el" href="class_i_p_m_stream.html">IPMStream</a> *writeStream, SnapshotUtils::PaletteType paletteType=SnapshotUtils::kNoPalette, bool embedColorProfile=false)</td></tr><tr class="separator:a8e2822b1cbf57c59baec7f8e53bfc2d0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a261c425cfd7a860f27b5a6a89f3581b1"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a261c425cfd7a860f27b5a6a89f3581b1">ExportImageToGIF</a> (<a class="el" href="class_i_p_m_stream.html">IPMStream</a> *writeStream, SnapshotUtils::PaletteType paletteType=SnapshotUtils::kTryExactThenAdaptivePalette, bool8 interlaced=kFalse)</td></tr><tr class="separator:a261c425cfd7a860f27b5a6a89f3581b1"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:abc5452bb64add47b7651c24b07deb36a"><td align="right" class="memItemLeft" valign="top">ErrorCode&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#abc5452bb64add47b7651c24b07deb36a">ExportImageToPNG</a> (<a class="el" href="class_i_p_m_stream.html">IPMStream</a> *writeStream, uint32 compression=5)</td></tr><tr class="separator:abc5452bb64add47b7651c24b07deb36a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a892f9586f0bbcb80f3e5fb70514d2998"><td align="right" class="memItemLeft" valign="top"><a class="el" href="class_a_g_m_graphics_context_with.html">AGMGraphicsContext</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a892f9586f0bbcb80f3e5fb70514d2998">GetGraphicsContext</a> (void) const </td></tr><tr class="separator:a892f9586f0bbcb80f3e5fb70514d2998"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af5a3f91fd9f22569fd94b1b8e1428060"><td align="right" class="memItemLeft" valign="top"><a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#af5a3f91fd9f22569fd94b1b8e1428060">CreateAGMImageAccessor</a> (void) const </td></tr><tr class="separator:af5a3f91fd9f22569fd94b1b8e1428060"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0498a1c0b02fced643e78077f937a4f1"><td align="right" class="memItemLeft" valign="top"><a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_snapshot_utils_ex.html#a0498a1c0b02fced643e78077f937a4f1">CreateAlphaAGMImageAccessor</a> (void) const </td></tr><tr class="separator:a0498a1c0b02fced643e78077f937a4f1"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a> Protected Attributes</h2></td></tr><tr class="memitem:a720b25f049fb2bd5c095441b829e9bb7"><td align="right" class="memItemLeft" valign="top"><a class="anchor" id="a720b25f049fb2bd5c095441b829e9bb7"></a> SnapshotUtilsExImpl *&nbsp;</td><td class="memItemRight" valign="bottom"><b>fImpl</b></td></tr><tr class="separator:a720b25f049fb2bd5c095441b829e9bb7"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p><a class="el" href="class_snapshot_utils_ex.html">SnapshotUtilsEx</a> is a utility class of routines designed to create an offscreen of a pageitem, page or spread and export it as a JPEG, GIF or TIFF. The client has options for colorspace, whether or not to include a transparency alpha, and options for bleed, image quality, and scaling. </div><h2 class="groupheader">Member Enumeration Documentation</h2><a class="anchor" id="a8670ca90e6e75ac6d175c6dcc08340e3"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">enum <a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SnapshotUtilsEx::SSColorSpaceFamily</a></td></tr></table></div><div class="memdoc"><p>ColorSpace options </div></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2><a class="anchor" id="a8d3e5e63be715bcc49afa179a5cde5dc"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">SnapshotUtilsEx::SnapshotUtilsEx </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>itemUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>xScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>yScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>desiredRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>minRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>bleedAmount</em> = <code>0.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a>&nbsp;</td><td class="paramname"><em>colorSpace</em> = <code>kCsRGB</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>addTransparencyAlpha</em> = <code>kFalse</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>simulateOverprint</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Calculates the bounds of the given item and creates a snapshot. This constructor is used to create an image of a complete spread, page or page item. Note that when itemUIDRef references a page (<a class="el" href="classk_page_boss.html">kPageBoss</a>) a snapshot is made of the items on the spread that intersect the page bounds. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">itemUIDRef</td><td>- IN - The spread, page or page item to draw </td></tr><tr><td class="paramname">xScaleFactor</td><td>- IN - X Scale </td></tr><tr><td class="paramname">yScaleFactor</td><td>- IN - Y Scale </td></tr><tr><td class="paramname">desiredRes</td><td>- IN - desired resolution of resulting snapshot </td></tr><tr><td class="paramname">minRes</td><td>- IN - minimum resolution of resulting snapshot </td></tr><tr><td class="paramname">bleedAmount</td><td>- IN - Extend the bounds of the area to be drawn by the given amount of bleed </td></tr><tr><td class="paramname">colorSpace</td><td>- IN - The colorspace of the snapshot. </td></tr><tr><td class="paramname">addTransparencyAlpha</td><td>- IN - kTrue to store transparency as an alpha channel, kFalse no alpha channel The alpha is a mask which identifies the non-transparent portions of the snapshot area &ndash; that is, the areas where page items are not. This alpha is usefull if for example this snapshot is to be used as a TIFF preview for an EPS. If you were to place the resulting EPS into InDesign, or even QuarkXPress, the transparent areas would be preserved when drawing in Proxy mode. </td></tr><tr><td class="paramname">simulateOverprint</td><td>- IN - kTrue to simulate overprint, ie the equivalent of turning on overprint preview. Uses more memory and somewhat slower. </td></tr></table></dl></div></div><a class="anchor" id="acd701c6bc7addc32f12a7d30402b3114"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">SnapshotUtilsEx::SnapshotUtilsEx </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;&nbsp;</td><td class="paramname"><em>clippingBounds</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_matrix.html">PMMatrix</a> &amp;&nbsp;</td><td class="paramname"><em>boundsToSpreadMatrix</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>itemUIDRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>xScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>yScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>desiredRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>minRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>bleedAmount</em> = <code>0.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a>&nbsp;</td><td class="paramname"><em>colorSpace</em> = <code>kCsRGB</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>addTransparencyAlpha</em> = <code>kFalse</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>simulateOverprint</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Creates a snapshot of the parts of the given item that intersect the area specified by clippingBounds. This constructor is used to draw part of a spread, page or page item. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">clippingBounds</td><td>- IN - Bounding box in spread co-ordinates of the area to be drawn </td></tr><tr><td class="paramname">itemUIDRef</td><td>- IN - The spread, page or page item to draw </td></tr><tr><td class="paramname">xScaleFactor</td><td>- IN - X Scale </td></tr><tr><td class="paramname">yScaleFactor</td><td>- IN - Y Scale </td></tr><tr><td class="paramname">desiredRes</td><td>- IN - desired resolution of resulting snapshot </td></tr><tr><td class="paramname">minRes</td><td>- IN - minimum resolution of resulting snapshot </td></tr><tr><td class="paramname">bleedAmount</td><td>- IN - Extend the bounds of the area to be drawn by the given amount of bleed </td></tr><tr><td class="paramname">colorSpace</td><td>- IN - The colorspace of the snapshot. </td></tr><tr><td class="paramname">addTransparencyAlpha</td><td>- IN - kTrue to store transparency as an alpha channel, kFalse no alpha channel The alpha is a mask which identifies the non-transparent portions of the snapshot area &ndash; that is, the areas where page items are not. This alpha is usefull if for example this snapshot is to be used as a TIFF preview for an EPS. If you were to place the resulting EPS into InDesign, or even QuarkXPress, the transparent areas would be preserved when drawing in Proxy mode. </td></tr><tr><td class="paramname">simulateOverprint</td><td>- IN - kTrue to simulate overprint, ie the equivalent of turning on overprint preview. Uses more memory and somewhat slower. </td></tr></table></dl></div></div><a class="anchor" id="af067c52e29ce581e04a6047d13f998e3"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">SnapshotUtilsEx::SnapshotUtilsEx </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;&nbsp;</td><td class="paramname"><em>clippingBounds</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_matrix.html">PMMatrix</a> &amp;&nbsp;</td><td class="paramname"><em>boundsToSpreadMatrix</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_data_base.html">IDataBase</a> *&nbsp;</td><td class="paramname"><em>database</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>xScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>yScaleFactor</em> = <code>1.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>desiredRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>minRes</em> = <code>72.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>bleedAmount</em> = <code>0.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_snapshot_utils_ex.html#a8670ca90e6e75ac6d175c6dcc08340e3">SSColorSpaceFamily</a>&nbsp;</td><td class="paramname"><em>colorSpace</em> = <code>kCsRGB</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>addTransparencyAlpha</em> = <code>kFalse</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>simulateOverprint</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Create a graphics context for the area specified by clippingBounds into which items from the given database will later be drawn by the caller. Only items that intersect the clippingBounds will be drawn.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">clippingBounds</td><td>- IN - Bounding box in spread co-ordinates of the area to be drawn </td></tr><tr><td class="paramname">database</td><td>- IN - The database containing the items to be drawn </td></tr><tr><td class="paramname">xScaleFactor</td><td>- IN - X Scale </td></tr><tr><td class="paramname">yScaleFactor</td><td>- IN - Y Scale </td></tr><tr><td class="paramname">desiredRes</td><td>- IN - desired resolution of resulting snapshot </td></tr><tr><td class="paramname">minRes</td><td>- IN - minimum resolution of resulting snapshot </td></tr><tr><td class="paramname">bleedAmount</td><td>- IN - Extend the bounds of the area to be drawn by the given amount of bleed </td></tr><tr><td class="paramname">colorSpace</td><td>- IN - The colorspace of the snapshot. </td></tr><tr><td class="paramname">addTransparencyAlpha</td><td>- IN - kTrue to store transparency as an alpha channel, kFalse no alpha channel The alpha is a mask which identifies the non-transparent portions of the snapshot area &ndash; that is, the areas where page items are not. This alpha is usefull if for example this snapshot is to be used as a TIFF preview for an EPS. If you were to place the resulting EPS into InDesign, or even QuarkXPress, the transparent areas would be preserved when drawing in Proxy mode. </td></tr><tr><td class="paramname">simulateOverprint</td><td>- IN - kTrue to simulate overprint, ie the equivalent of turning on overprint preview. Uses more memory and somewhat slower. </td></tr></table></dl></div></div><a class="anchor" id="a1c6dae481ca9445e111b846336da63cf"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual SnapshotUtilsEx::~SnapshotUtilsEx </td><td>(</td><td class="paramname"></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">virtual</span></span></td></tr></table></div><div class="memdoc"><p>Destructor. Destroy the snapshot <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">none</td><td></td></tr></table></dl><dl class="section return"><dt>Returns<dd></dl></div></div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="af5a3f91fd9f22569fd94b1b8e1428060"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname"><a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a>* SnapshotUtilsEx::CreateAGMImageAccessor </td><td>(</td><td class="paramtype">void&nbsp;</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></div><div class="memdoc"><p>CreateAGMImageAccessor returns a pointer to an <a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a> which can be used to obtain information about the actual offscreen bitmap used to create the snapshot. The caller of this routine is responsible for calling &#39;delete&#39; on the returned <a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a>. Note that this method will return nil if we are tiling due to not being able to hold an in-memory offscreen for the entire snapshot. <dl class="section see"><dt>See Also<dd><a class="el" href="class_snapshot_utils_ex.html#a892f9586f0bbcb80f3e5fb70514d2998">GetGraphicsContext</a>. </dl></div></div><a class="anchor" id="a0498a1c0b02fced643e78077f937a4f1"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname"><a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a>* SnapshotUtilsEx::CreateAlphaAGMImageAccessor </td><td>(</td><td class="paramtype">void&nbsp;</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></div><div class="memdoc"><p>CreateAlphaAGMImageAccessor returns a greyscale representation of the transparency alpha generated during the snapshot. If the snapshot was constructed passing False for the &#39;addTransparencyAlpha&#39; argument, then nil will be returned. If kXPOff is passed for the &#39;transparencyQuality&#39; argument, then each pixel will be either 0 (black) or 255(white). The caller of this routine is responsible for calling &#39;delete&#39; on the returned <a class="el" href="class_a_g_m_image_accessor.html">AGMImageAccessor</a>. Note that this method will return nil if we are tiling due to not being able to hold an in-memory offscreen for the entire snapshot. <dl class="section see"><dt>See Also<dd><a class="el" href="class_snapshot_utils_ex.html#a892f9586f0bbcb80f3e5fb70514d2998">GetGraphicsContext</a>. </dl></div></div><a class="anchor" id="aae2d859788908fe159aef2a29af46d37"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::Draw </td><td>(</td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>flags</em> = <code><a class="el" href="class_i_shape.html#aa9e07a92fd22dc760e7f04a582c16683a113121acc1b1e40704fd5d331ca9532e">IShape::kPreviewMode</a></code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>fullResolutionGraphics</em> = <code>kFalse</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>greekBelowPtSize</em> = <code>7.0</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>enableAntiAliasing</em> = <code>kTrue</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::Transparencies&nbsp;</td><td class="paramname"><em>transparencyQuality</em> = <code>SnapshotUtils::kXPHigh</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_idle_timer.html">IdleTimer</a> *&nbsp;</td><td class="paramname"><em>abortCheck</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">VPAttrMap *&nbsp;</td><td class="paramname"><em>pVPAttrMap</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>bDrawNonPrintingObjects</em> = <code>kTrue</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Construct the bitmap using the arguments passed into the constructor and then draw using the drawing arguments passed to this routine. If a constructor containing a <a class="el" href="class_u_i_d_ref.html">UIDRef</a> was used, then the <a class="el" href="class_i_shape.html">IShape</a> implementation of that <a class="el" href="class_u_i_d_ref.html">UIDRef</a> will be asked to draw its hierarchy. That is, the <a class="el" href="class_u_i_d_ref.html">UIDRef</a> and its children will draw. If no <a class="el" href="class_u_i_d_ref.html">UIDRef</a> was used, then all page items intersecting the clippingBounds will be drawn.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">flags</td><td>- IN - Drawing flags (kPreviewMode suppresses drawing of margins and guides) </td></tr><tr><td class="paramname">fullResolutionGraphics</td><td>- IN - kTrue forces images and graphics to draw at full resolution, kFalse to draw proxies </td></tr><tr><td class="paramname">greekBelowPtSize</td><td>- IN - Point size at which text will be greeked if its points size multiplied by the scaling is less than the greek below value. </td></tr><tr><td class="paramname">enableAntiAliasing</td><td>- IN - kTrue to anti-alias the drawing of all page items. </td></tr><tr><td class="paramname">transparencyQuality</td><td>- IN - Controls the quality level of transparency effects such as drop shadows, feathers, and blending modes. Use kXPOff to disable transparency effects. </td></tr><tr><td class="paramname">abortCheck</td><td>- IN - This argument is a callback which will be called before each page item is drawn. If you need to abort the generation of this snapshot because too much time has elapsed, there is a pending event that you want to handle, or any other reason, then pass in an <a class="el" href="class_idle_timer.html">IdleTimer</a>. If the call to (*abortCheck)() equal zero, then the draw operation will be aborted and an error code of kCancel will be returned.</td></tr></table></dl><dl class="section see"><dt>See Also<dd><a class="el" href="_i_idle_task_8h_source.html">IIdleTask.h</a> for the definition of <a class="el" href="class_idle_timer.html">IdleTimer</a>. </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">pVPAttrMap</td><td>- IN - This argument is a pointer to a map of view port attributes and values corresponding to them. If you want to control the content of the snapshot that gets drawn, you can pass a map of various viewport attributes class IDs (like kPrintBaselineGridsVPAttr, kPrintLayersVPAttr, or kXPFlattenerOffVPAttr) and their corresponding values. This function would iterate the various mappings and set the values corresponding to them in the view port attributes of the graphics port, before actually drawing on it. </td></tr><tr><td class="paramname">bDrawNonPrintingObjects</td><td>- IN - If true, then page items marked as non-printing will draw. If false, non-printing page items will be ignored. This setting does not affect non-printing layers. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="afba2b3f0fe8b8dd7e2da93811b54176a"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::Draw </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_type.html">UID</a>&nbsp;</td><td class="paramname"><em>pageItem</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>flags</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>fullResolutionGraphics</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>greekBelowPtSize</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>enableAntiAliasing</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::Transparencies&nbsp;</td><td class="paramname"><em>transparencyQuality</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_idle_timer.html">IdleTimer</a> *&nbsp;</td><td class="paramname"><em>abortCheck</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">VPAttrMap *&nbsp;</td><td class="paramname"><em>pVPAttrMap</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool32&nbsp;</td><td class="paramname"><em>bDrawNonPrintingObjects</em> = <code>kTrue</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Construct the bitmap using the arguments passed into the constructor and then draw using the drawing arguments passed to this routine. Typically, this method is called when the constructor WITHOUT a <a class="el" href="class_u_i_d_ref.html">UIDRef</a> is used.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">pageItem</td><td>- IN - the page item to draw. </td></tr><tr><td class="paramname">flags</td><td>- IN - Drawing flags (kPreviewMode suppresses drawing of margins and guides) </td></tr><tr><td class="paramname">fullResolutionGraphics</td><td>- IN - kTrue forces images and graphics to draw at full resolution, kFalse to draw proxies </td></tr><tr><td class="paramname">greekBelowPtSize</td><td>- IN - Point size at which text will be greeked if its points size multiplied by the scaling is less than the greek below value. </td></tr><tr><td class="paramname">enableAntiAliasing</td><td>- IN - kTrue to anti-alias the drawing of all page items. </td></tr><tr><td class="paramname">transparencyQuality</td><td>- IN - Controls the quality level of transparency effects such as drop shadows, feathers, and blending modes. Use kXPOff to disable transparency effects. </td></tr><tr><td class="paramname">abortCheck</td><td>- IN - This argument is a callback which will be called before each page item is drawn. If you need to abort the generation of this snapshot because too much time has elapsed, there is a pending event that you want to handle, or any other reason, then pass in an <a class="el" href="class_idle_timer.html">IdleTimer</a>. If the call to (*abortCheck)() equal zero, then the draw operation will be aborted and an error code of kCancel will be returned.</td></tr></table></dl><dl class="section see"><dt>See Also<dd><a class="el" href="_i_idle_task_8h_source.html">IIdleTask.h</a> for the definition of <a class="el" href="class_idle_timer.html">IdleTimer</a>. </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">pVPAttrMap</td><td>- IN - This argument is a pointer to a map of view port attributes and values corresponding to them. If you want to control the content of the snapshot that gets drawn, you can pass a map of various viewport attributes class IDs (like kPrintBaselineGridsVPAttr, kPrintLayersVPAttr, or kXPFlattenerOffVPAttr) and their corresponding values. This function would iterate the various mappings and set the values corresponding to them in the view port attributes of the graphics port, before actually drawing on it. </td></tr><tr><td class="paramname">bDrawNonPrintingObjects</td><td>- IN - If true, then page items marked as non-printing will draw. If false, non-printing page items will be ignored. This setting does not affect non-printing layers. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="a377b63debee96bc890474a4a0ae3bc84"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::ExportImage </td><td>(</td><td class="paramtype"><a class="el" href="class_i_d_type.html">ClassID</a>&nbsp;</td><td class="paramname"><em>formatClass</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_p_m_stream.html">IPMStream</a> *&nbsp;</td><td class="paramname"><em>writeStream</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>colorMapped</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>Exports the bitmap to a stream using the given image write format service (these filters are registered in the service registry under ServiceID==kImageWriteFormatService). USE ExportImageToJPEG, ExportImageToTIFF, ExportImageToPNG or ExportImageToGIF unless you have your own formatClass.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">formatClass</td><td>- IN - ClassID of the export format (e.g. <a class="el" href="classk_t_i_f_f_image_write_format_boss.html">kTIFFImageWriteFormatBoss</a>, <a class="el" href="classk_j_p_e_g_image_write_format_boss.html">kJPEGImageWriteFormatBoss</a>, <a class="el" href="classk_g_i_f_image_write_format_boss.html">kGIFImageWriteFormatBoss</a>) </td></tr><tr><td class="paramname">writeStream</td><td>- OUT - Stream to receive the bitmap data </td></tr><tr><td class="paramname">colorMapped</td><td>- IN - kTrue to make the resulting image indexed, kFalse otherwise </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="a261c425cfd7a860f27b5a6a89f3581b1"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::ExportImageToGIF </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_stream.html">IPMStream</a> *&nbsp;</td><td class="paramname"><em>writeStream</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::PaletteType&nbsp;</td><td class="paramname"><em>paletteType</em> = <code>SnapshotUtils::kTryExactThenAdaptivePalette</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool8&nbsp;</td><td class="paramname"><em>interlaced</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>GIFs support transparency and are always indexed <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writeStream</td><td>- OUT - Stream to receive the bitmap data </td></tr><tr><td class="paramname">paletteType</td><td>- IN - What kind of color palette do you want </td></tr><tr><td class="paramname">interlaced</td><td>- IN - interlacing is usefull when an application needs to fade an image in while loading it but in general takes causes the reader to take longer to display the image. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="aa0b9039b572c6ffa53db89870df5648c"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::ExportImageToJPEG </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_stream.html">IPMStream</a> *&nbsp;</td><td class="paramname"><em>writeStream</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::SSJPEGEncoding&nbsp;</td><td class="paramname"><em>encoding</em> = <code>SnapshotUtils::kSSJPEGBaseline</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::SSJPEGQuality&nbsp;</td><td class="paramname"><em>quality</em> = <code>SnapshotUtils::kSSJPEGExcellentQuality</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool&nbsp;</td><td class="paramname"><em>embedColorProfile</em> = <code>false</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>JPEG is very small and depending on the &#39;quality&#39; setting can be very high quality. But it cannot be indexed and it does not support transparency.<dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writeStream</td><td>- OUT - Stream to receive the bitmap data </td></tr><tr><td class="paramname">encoding</td><td>- IN - JPEG encoding: kSSJPEGProgressive or kSSJPEGBaseline </td></tr><tr><td class="paramname">quality</td><td>- IN - kSSJPEGLowQuality, kSSJPEGGoodQuality, kSSJPEGExcellentQuality, kSSJPEGGreatQuality </td></tr><tr><td class="paramname">embedColorProfile</td><td>- IN - true to embed the color profile in the JPEG, false to strip it. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="abc5452bb64add47b7651c24b07deb36a"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::ExportImageToPNG </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_stream.html">IPMStream</a> *&nbsp;</td><td class="paramname"><em>writeStream</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">uint32&nbsp;</td><td class="paramname"><em>compression</em> = <code>5</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><p>PNG supports transparency. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writeStream</td><td>- OUT - Stream to receive the bitmap data </td></tr><tr><td class="paramname">compression</td><td>- IN - Legal values are 0..9. Out of range values are (silently) clipped to a valid range. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="a8e2822b1cbf57c59baec7f8e53bfc2d0"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname">ErrorCode SnapshotUtilsEx::ExportImageToTIFF </td><td>(</td><td class="paramtype"><a class="el" href="class_i_p_m_stream.html">IPMStream</a> *&nbsp;</td><td class="paramname"><em>writeStream</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">SnapshotUtils::PaletteType&nbsp;</td><td class="paramname"><em>paletteType</em> = <code>SnapshotUtils::kNoPalette</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool&nbsp;</td><td class="paramname"><em>embedColorProfile</em> = <code>false</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></div><div class="memdoc"><pre class="fragment">Supports transparency

</pre><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writeStream</td><td>- OUT - Stream to receive the bitmap data </td></tr><tr><td class="paramname">paletteType</td><td>- OUT - What kind of color palette do you want </td></tr><tr><td class="paramname">embedColorProfile</td><td>- IN - true to embed the color profile in the JPEG, false to strip it. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>ErrorCode </dl></div></div><a class="anchor" id="a892f9586f0bbcb80f3e5fb70514d2998"></a><div class="memitem"><div class="memproto"><table class="memname"><tr><td class="memname"><a class="el" href="class_a_g_m_graphics_context_with.html">AGMGraphicsContext</a>* SnapshotUtilsEx::GetGraphicsContext </td><td>(</td><td class="paramtype">void&nbsp;</td><td class="paramname"></td><td>)</td><td> const</td></tr></table></div><div class="memdoc"><p>The AGMGraphicsContext returned from <a class="el" href="class_snapshot_utils_ex.html#a892f9586f0bbcb80f3e5fb70514d2998">GetGraphicsContext()</a> can be used to obtain the Windows HDC or the Mac GrafPtr of the offscreen containing the offscreen bitmap. Note that this method will return nil if the offscreen will not fit into memory. <a class="el" href="class_snapshot_utils_ex.html">SnapshotUtilsEx</a> can still successfully create and export a snapshot even if it cannot hold the snapshot as an in-memory offscreen by tiling. That is, <a class="el" href="class_snapshot_utils_ex.html">SnapshotUtilsEx</a> will offscreen the snapshot in tiles and export each tile sequentially. </div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_snapshot_utils_ex.html">SnapshotUtilsEx</a><li class="footer">Generated on Sat Sep 22 2018 10:56:27 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
