<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_command_sequence</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_command_sequence.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="class_i_command_sequence-members.html">List of all members</a></div><div class="headertitle"><div class="title">ICommandSequence Class Reference</div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_command_sequence_8h_source.html">ICommandSequence.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for ICommandSequence:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_command_sequence.png" usemap="#ICommandSequence_map" /><map id="ICommandSequence_map" name="ICommandSequence_map"><area alt="I_Base_CommandSequence" coords="0,0,168,24" href="class_i___base___command_sequence.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a> Additional Inherited Members</h2></td></tr><tr class="inherit_header pub_methods_class_i___base___command_sequence"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i___base___command_sequence&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i___base___command_sequence.html">I_Base_CommandSequence</a></td></tr><tr class="memitem:ac1d9b6c9730998a79370a36b35e87abe inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_command.html#a9b7f77ae8c7947d4dcf20b808a2c9f37">ICommand::Undoability</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#ac1d9b6c9730998a79370a36b35e87abe">GetUndoability</a> () const =0</td></tr><tr class="separator:ac1d9b6c9730998a79370a36b35e87abe inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a3b056ab5f17f0a6ea1e7c8d217ccd477 inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#a3b056ab5f17f0a6ea1e7c8d217ccd477">SetUndoability</a> (<a class="el" href="class_i_command.html#a9b7f77ae8c7947d4dcf20b808a2c9f37">ICommand::Undoability</a> newUndoability)=0</td></tr><tr class="separator:a3b056ab5f17f0a6ea1e7c8d217ccd477 inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ad2d3fa36243cfb97a4fd13c4abe878e2 inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#ad2d3fa36243cfb97a4fd13c4abe878e2">GetName</a> (<a class="el" href="class_p_m_string.html">PMString</a> *name) const =0</td></tr><tr class="separator:ad2d3fa36243cfb97a4fd13c4abe878e2 inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a396cfdf862d68eda9c24fbb532dadf74 inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#a396cfdf862d68eda9c24fbb532dadf74">SetName</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;newName)=0</td></tr><tr class="separator:a396cfdf862d68eda9c24fbb532dadf74 inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a2bfad578109ef2ccfb53cfff2f20682a inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#a2bfad578109ef2ccfb53cfff2f20682a">AddReference</a> ()=0</td></tr><tr class="separator:a2bfad578109ef2ccfb53cfff2f20682a inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a3ca8f3d2f3d59e5aca4881970e0b20e1 inherit pub_methods_class_i___base___command_sequence"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i___base___command_sequence.html#a3ca8f3d2f3d59e5aca4881970e0b20e1">ReleaseReference</a> ()=0</td></tr><tr class="separator:a3ca8f3d2f3d59e5aca4881970e0b20e1 inherit pub_methods_class_i___base___command_sequence"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><pre class="fragment">A regular command sequence groups any number of commands to a single undoable 

step in the command history. When the sequence ends, the changes made by 

the commands within the sequence are committed if the global error code is 

kSuccess, otherwise the database is rolled back to its state before the 

sequence started.



Stack-based helper classes CmdUtils::SequencePtr and CmdUtils::SequenceContext

make it easier to write a sequence and avoid having to call

CmdUtils::BeginCommandSequence() and CmdUtils::EndCommandSequence(ICommandSequence *)

yourself. For example:

&lt;pre&gt;

{

</pre><p> The SequencePtr constructor creates a new sequence. SequencePtr seq; seq-&gt;SetName(<a class="el" href="class_p_m_string.html">PMString</a>(&quot;Your Sequence Name&quot;)); if (ProcessFirstCommand() == kSuccess)) { ProcessSecondCommand(); } When the SequencePtr object goes out of scope the destructor ends the sequence. } <p>Alternatively call <a class="el" href="class_cmd_utils.html#a6b11ea77d40620d2231f9fc4523c2bc2">CmdUtils::BeginCommandSequence()</a> to create a new sequence. After you are done with processing commands call <a class="el" href="class_cmd_utils.html#a4449513fbe55f8b70da53dd159b230bb">CmdUtils::EndCommandSequence(ICommandSequence *)</a>. Do not use the sequence again afterwards.<dl class="section see"><dt>See Also<dd><a class="el" href="class_cmd_utils_1_1_sequence_context.html">CmdUtils::SequenceContext</a><dd><a class="el" href="class_cmd_utils_1_1_sequence_ptr.html">CmdUtils::SequencePtr</a><dd><a class="el" href="class_cmd_utils.html#a6b11ea77d40620d2231f9fc4523c2bc2">CmdUtils::BeginCommandSequence</a><dd><a class="el" href="class_cmd_utils.html#a4449513fbe55f8b70da53dd159b230bb">CmdUtils::EndCommandSequence(ICommandSequence *)</a><dd><a class="el" href="class_error_utils.html#ad32805d9e73399357297c07e60fde65a">ErrorUtils::PMGetGlobalErrorCode</a><dd><a class="el" href="class_i_cmd_history.html">ICmdHistory</a><dd><a class="el" href="class_i_command.html">ICommand</a><dd><a class="el" href="class_cmd_utils.html">CmdUtils</a></dl></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_command_sequence.html">ICommandSequence</a><li class="footer">Generated on Sat Sep 22 2018 10:54:00 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
