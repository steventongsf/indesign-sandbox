<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_run_in_styles_utils</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_run_in_styles_utils.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_run_in_styles_utils-members.html">List of all members</a></div><div class="headertitle"><div class="title">IRunInStylesUtils Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_run_in_styles_utils_8h_source.html">IRunInStylesUtils.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IRunInStylesUtils:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_run_in_styles_utils.png" usemap="#IRunInStylesUtils_map" /><map id="IRunInStylesUtils_map" name="IRunInStylesUtils_map"><area alt="IPMUnknown" coords="0,0,104,24" href="class_i_p_m_unknown.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a99131377d7bc82d20f8754507fd551d1"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IRUNINSTYLESUTILS }</td></tr><tr class="separator:a99131377d7bc82d20f8754507fd551d1"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a8a154a76309369ad9d6c124d8ec2bc95"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_run_in_styles_utils.html#a8a154a76309369ad9d6c124d8ec2bc95">ParseParagraphForRunInStyles</a> (const <a class="el" href="class_i_text_model.html">ITextModel</a> *model, TextIndex position, const <a class="el" href="class_i_composition_style.html">ICompositionStyle</a> *paragraphStyle, <a class="el" href="class_run_in_style_results.html">RunInStyleResults</a> &amp;results, int32 *pParagraphLengthLeft=nil, bool16 moveBackwards=kFalse)=0</td></tr><tr class="separator:a8a154a76309369ad9d6c124d8ec2bc95"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aaa2c9a23c31caa099191bff438f4ebef"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_run_in_styles_utils.html#aaa2c9a23c31caa099191bff438f4ebef">MapExpressionToPMString</a> (const <a class="el" href="class_wide_string.html">WideString</a> &amp;expression, <a class="el" href="class_p_m_string.html">PMString</a> *pOutput, int32 *pCount, bool16 *pInclusive)=0</td></tr><tr class="separator:aaa2c9a23c31caa099191bff438f4ebef"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5513c643b6294c622e5a4c13c3b2f360"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_run_in_styles_utils.html#a5513c643b6294c622e5a4c13c3b2f360">MapPMStringToExpression</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;nicePhrase, int32 count, bool16 inclusive, <a class="el" href="class_wide_string.html">WideString</a> *pExpression)=0</td></tr><tr class="separator:a5513c643b6294c622e5a4c13c3b2f360"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab099e2eb03b870ab94701ffd6ca0b7e9"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_run_in_styles_utils.html#ab099e2eb03b870ab94701ffd6ca0b7e9">ToggleExpressionInclusion</a> (const <a class="el" href="class_wide_string.html">WideString</a> &amp;original, <a class="el" href="class_wide_string.html">WideString</a> *pToggled)=0</td></tr><tr class="separator:ab099e2eb03b870ab94701ffd6ca0b7e9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a662552da71fdf19172c939b599440e40"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_run_in_styles_utils.html#a662552da71fdf19172c939b599440e40">CalculateDropCapCount</a> (const <a class="el" href="class_text_iterator.html">TextIterator</a> &amp;beginPosition, int16 baseCharCount, <a class="el" href="class_wide_string.html">WideString</a> *dcText)=0</td></tr><tr class="separator:a662552da71fdf19172c939b599440e40"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p>Some utility functions to aid in processing run-in styles </div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="a662552da71fdf19172c939b599440e40"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IRunInStylesUtils::CalculateDropCapCount </td><td>(</td><td class="paramtype">const <a class="el" href="class_text_iterator.html">TextIterator</a> &amp;&nbsp;</td><td class="paramname"><em>beginPosition</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int16&nbsp;</td><td class="paramname"><em>baseCharCount</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_wide_string.html">WideString</a> *&nbsp;</td><td class="paramname"><em>dcText</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>calculate actual number of char that dropcap need to be applied (adjusted for hidden character at the beginning of paragraph) <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">beginPosition</td><td>beginning position for dropcap evaluation (usually beginning position of paragraph) </td></tr><tr><td class="paramname">baseCharCount</td><td>number of dropcap char specified by user </td></tr><tr><td class="paramname">dcText</td><td>actual text string used for dropcap </td></tr></table></dl><dl class="section return"><dt>Returns<dd>actual number of char dropcap will be applied starting beginning position </dl><dl class="section see"><dt>See Also<dd><a class="el" href="class_run_in_style_rule.html">RunInStyleRule</a></dl></div></div><a class="anchor" id="aaa2c9a23c31caa099191bff438f4ebef"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IRunInStylesUtils::MapExpressionToPMString </td><td>(</td><td class="paramtype">const <a class="el" href="class_wide_string.html">WideString</a> &amp;&nbsp;</td><td class="paramname"><em>expression</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> *&nbsp;</td><td class="paramname"><em>pOutput</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32 *&nbsp;</td><td class="paramname"><em>pCount</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16 *&nbsp;</td><td class="paramname"><em>pInclusive</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>map the attribute&#39;s expression string into a <a class="el" href="class_p_m_string.html">PMString</a> for readibility. The attribute is split into the characters to match and the count. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">expression</td><td>the attribute&#39;s value describing the rule </td></tr><tr><td class="paramname">pOutput</td><td>the string that should contain a readable version of the rule </td></tr><tr><td class="paramname">pCount</td><td>the number of TIMES that the expression should be found before switching styles </td></tr><tr><td class="paramname">pInclusive</td><td>will be return whether the style INCLUDES the final trigger </td></tr></table></dl><dl class="section see"><dt>See Also<dd><a class="el" href="class_run_in_style_rule.html">RunInStyleRule</a></dl></div></div><a class="anchor" id="a5513c643b6294c622e5a4c13c3b2f360"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IRunInStylesUtils::MapPMStringToExpression </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>nicePhrase</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>count</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>inclusive</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_wide_string.html">WideString</a> *&nbsp;</td><td class="paramname"><em>pExpression</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>map a user description of a rule PLUS a count into an attribute&#39;s expression string <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">nicePhrase</td><td>a <a class="el" href="class_p_m_string.html">PMString</a> version of the rule </td></tr><tr><td class="paramname">count</td><td>the number of time the rule should be satisfied </td></tr><tr><td class="paramname">pExpression</td><td>the attribute&#39;s rule string the describes the input. </td></tr><tr><td class="paramname">inclusive</td><td>declares whether the style INCLUDES the final trigger </td></tr></table></dl><dl class="section see"><dt>See Also<dd><a class="el" href="class_run_in_style_rule.html">RunInStyleRule</a></dl></div></div><a class="anchor" id="a8a154a76309369ad9d6c124d8ec2bc95"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IRunInStylesUtils::ParseParagraphForRunInStyles </td><td>(</td><td class="paramtype">const <a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>model</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>position</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_i_composition_style.html">ICompositionStyle</a> *&nbsp;</td><td class="paramname"><em>paragraphStyle</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_run_in_style_results.html">RunInStyleResults</a> &amp;&nbsp;</td><td class="paramname"><em>results</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32 *&nbsp;</td><td class="paramname"><em>pParagraphLengthLeft</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>moveBackwards</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Calculate the Run-In style transition points for the given paragraph <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">model</td><td>the text model of the story being examined </td></tr><tr><td class="paramname">position</td><td>usually the starting index of the paragraph being examined </td></tr><tr><td class="paramname">paragraphStyle</td><td>the paragraph attributes for the paragraph. If the paragraphStyle is nil, then everything is fine and the position can be arbitrary. If the paragraphStyle is NOT file, then it position should be == to paragraph start. </td></tr><tr><td class="paramname">results</td><td>a list of run-in styles for this paragraph specified as an ordered list of &lt;character style UID, number of characters&gt; pairs </td></tr><tr><td class="paramname">ignoreUnsetLines</td><td>specifies whether to ignore &quot;lines&quot; nested styles or to set that style over the entire remaining paragraph. In already-composed paragraphs, this parameter is ignored, but in uncomposed paragraphs, the choice exists. Generally, they are ignored except by composition itself. </td></tr><tr><td class="paramname">pParagraphLengthLeft</td><td>should be SET to the paragraph length if the paragraphStyle was passed in, otherwise, it&#39;s for occasional callers who need to know the rest of the paragraph&#39;s length too. </td></tr><tr><td class="paramname">moveBackwards</td><td>specifies the direction in which rest of the paragraph&#39;s length is to be reported. The value is kTrue for backwards direction and kFalse for forward direction. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>kTrue if the paragraph at the position has runins (results could be empty if position past the affected range) </dl></div></div><a class="anchor" id="ab099e2eb03b870ab94701ffd6ca0b7e9"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IRunInStylesUtils::ToggleExpressionInclusion </td><td>(</td><td class="paramtype">const <a class="el" href="class_wide_string.html">WideString</a> &amp;&nbsp;</td><td class="paramname"><em>original</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_wide_string.html">WideString</a> *&nbsp;</td><td class="paramname"><em>pToggled</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>toggle whether the rule include the character that triggers the switch or not <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">original</td><td>the original expression from the run-in style list </td></tr><tr><td class="paramname">pToggled</td><td>the new expression, with the inclusion toggled </td></tr></table></dl><dl class="section return"><dt>Returns<dd>some expressions are not toggle-able and if original == *pToggled this will return kFalse </dl><dl class="section see"><dt>See Also<dd><a class="el" href="class_run_in_style_rule.html">RunInStyleRule</a></dl></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_run_in_styles_utils.html">IRunInStylesUtils</a><li class="footer">Generated on Sat Sep 22 2018 10:54:26 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
