<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_galley_utils</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">14.0.0</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('class_i_galley_utils.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="summary"><a href="#pub-types">Public Types</a> | <a href="#pub-methods">Public Member Functions</a> | <a href="class_i_galley_utils-members.html">List of all members</a></div><div class="headertitle"><div class="title">IGalleyUtils Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div></div><div class="contents"><p><code>#include &lt;<a class="el" href="_i_galley_utils_8h_source.html">IGalleyUtils.h</a>&gt;</code><div class="dynheader"> Inheritance diagram for IGalleyUtils:</div><div class="dyncontent"><div class="center"><img alt="" src="class_i_galley_utils.png" usemap="#IGalleyUtils_map" /><map id="IGalleyUtils_map" name="IGalleyUtils_map"><area alt="IPMUnknown" coords="0,0,85,24" href="class_i_p_m_unknown.html" shape="rect" /></map></div></div><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a> Public Types</h2></td></tr><tr class="memitem:a12561b85d5111fa84581a811ea29560f"><td align="right" class="memItemLeft" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <b>kDefaultIID</b> = IID_IGALLEYUTILS }</td></tr><tr class="separator:a12561b85d5111fa84581a811ea29560f"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><table class="memberdecls"><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a> Public Member Functions</h2></td></tr><tr class="memitem:a6ade9ca428c9463713189b9960800f73"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a6ade9ca428c9463713189b9960800f73">GetWritingWidget</a> (<a class="el" href="class_i_panel_control_data.html">IPanelControlData</a> *panelData, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> storyRef)=0</td></tr><tr class="separator:a6ade9ca428c9463713189b9960800f73"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a6fbfe5a17b4050e49e7d9496e2746f08"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a6fbfe5a17b4050e49e7d9496e2746f08">GetStoryRef</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *writingWidget)=0</td></tr><tr class="separator:a6fbfe5a17b4050e49e7d9496e2746f08"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a5e597cb0a40f6490ba908434ab8400c7"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a5e597cb0a40f6490ba908434ab8400c7">GetFrameRef</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *writingWidget)=0</td></tr><tr class="separator:a5e597cb0a40f6490ba908434ab8400c7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:adb382fbbd672d8084c90edcfcaf6184e"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#adb382fbbd672d8084c90edcfcaf6184e">GetStoryIndex</a> (<a class="el" href="class_i_text_lines.html">ITextLines</a> *textLines, <a class="el" href="class_i_text_model.html">ITextModel</a> *textModel)=0</td></tr><tr class="separator:adb382fbbd672d8084c90edcfcaf6184e"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a1729a5452061fb992c61143394e44c27"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a1729a5452061fb992c61143394e44c27">FindGalleyView</a> (<a class="el" href="class_i_document.html">IDocument</a> *document)=0</td></tr><tr class="separator:a1729a5452061fb992c61143394e44c27"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a704af557d515295e08256312356f4328"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a704af557d515295e08256312356f4328">MeasureText</a> (<a class="el" href="class_i_font_instance.html">IFontInstance</a> *fontInstance, const <a class="el" href="class_p_m_string.html">PMString</a> &amp;data, <a class="el" href="class_p_m_real.html">PMReal</a> *xWidth, <a class="el" href="class_p_m_real.html">PMReal</a> *yWidth)=0</td></tr><tr class="separator:a704af557d515295e08256312356f4328"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a436ed398ac3fa47a654f6c2abd487c52"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a436ed398ac3fa47a654f6c2abd487c52">FindFrontmostGalleyPresentation</a> (<a class="el" href="class_i_document.html">IDocument</a> *document=nil)=0</td></tr><tr class="separator:a436ed398ac3fa47a654f6c2abd487c52"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa2f7e2234940eeb4c8dc769ea9971f89"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aa2f7e2234940eeb4c8dc769ea9971f89">FindFrontmostLayoutPresentation</a> (<a class="el" href="class_i_document.html">IDocument</a> *document=nil)=0</td></tr><tr class="separator:aa2f7e2234940eeb4c8dc769ea9971f89"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ae9a1a2d6c1c136db726c7749425f35f9"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_u_i_d_list.html">UIDList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#ae9a1a2d6c1c136db726c7749425f35f9">GetGalleyPanels</a> (<a class="el" href="class_u_i_d_ref.html">UIDRef</a> onDocRef=<a class="el" href="class_u_i_d_ref.html">UIDRef</a>())=0</td></tr><tr class="separator:ae9a1a2d6c1c136db726c7749425f35f9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a38e7f3afb5af44d582ea1ead9cf186fb"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a38e7f3afb5af44d582ea1ead9cf186fb">GetFontOfStyle</a> (<a class="el" href="class_p_m_string.html">PMString</a> fontFamilyName, IFontMgr::FontStyleBits fontStyle)=0</td></tr><tr class="separator:a38e7f3afb5af44d582ea1ead9cf186fb"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aaf912cf0713b605461586b3745a5862f"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_font.html">IPMFont</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aaf912cf0713b605461586b3745a5862f">QueryInterfaceFont</a> (bool16 hilite)=0</td></tr><tr class="separator:aaf912cf0713b605461586b3745a5862f"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:acd17b462f7edd18518eb0f66057a5c8e"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#acd17b462f7edd18518eb0f66057a5c8e">DrawInterfaceString</a> (const <a class="el" href="class_p_m_string.html">PMString</a> &amp;string, <a class="el" href="class_i_control_view.html">IControlView</a> *drawInView, <a class="el" href="class_i_graphics_port.html">IGraphicsPort</a> *gPort, const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;textBounds, const <a class="el" href="class_p_m_point.html">PMPoint</a> &amp;textLoc, const <a class="el" href="class_real_a_g_m_color.html">RealAGMColor</a> &amp;textColor, const <a class="el" href="class_real_a_g_m_color.html">RealAGMColor</a> &amp;backgroundColor, bool16 hilite=kFalse)=0</td></tr><tr class="separator:acd17b462f7edd18518eb0f66057a5c8e"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af2ed3937022ab06b82bb9a30d10b224b"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#af2ed3937022ab06b82bb9a30d10b224b">GetXMeasureUnitList</a> (<a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt; &amp;unitList)=0</td></tr><tr class="separator:af2ed3937022ab06b82bb9a30d10b224b"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9fd604e03b42ad4c43a2c016e0261e11"><td align="right" class="memItemLeft" valign="top">virtual <br class="typebreak" /><a class="el" href="class_i_text_data_validation.html#aed36cd10fdb74b25f6b6048c2bdec9b6">ITextDataValidation::RangeError</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a9fd604e03b42ad4c43a2c016e0261e11">ParseLineRange</a> (<a class="el" href="class_k2_vector.html">K2Vector</a>&lt; int32 &gt; &amp;rangeList, <a class="el" href="class_p_m_string.html">PMString</a> rangeText, int32 start, int32 end)=0</td></tr><tr class="separator:a9fd604e03b42ad4c43a2c016e0261e11"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aacb5874000f42121d800863b7d7a25c2"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aacb5874000f42121d800863b7d7a25c2">GetFontName</a> (<a class="el" href="class_p_m_string.html">PMString</a> &amp;fontName, <a class="el" href="class_p_m_string.html">PMString</a> &amp;fontFamilyName, <a class="el" href="class_p_m_string.html">PMString</a> &amp;style)=0</td></tr><tr class="separator:aacb5874000f42121d800863b7d7a25c2"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0a100bcb87f62740f3144a86587de763"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a0a100bcb87f62740f3144a86587de763">GetFontStyleList</a> (<a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; &amp;StyleList, <a class="el" href="class_p_m_string.html">PMString</a> &amp;fontFamily)=0</td></tr><tr class="separator:a0a100bcb87f62740f3144a86587de763"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a75c0bcc7aa57ea546231c8b180c224c7"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a75c0bcc7aa57ea546231c8b180c224c7">GetFontNameList</a> (<a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; &amp;fontList, bool16 filterSymbolFonts=kTrue, <a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; *translatedFontList=nil)=0</td></tr><tr class="separator:a75c0bcc7aa57ea546231c8b180c224c7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a7363b5a3d48a5a8782fa4aa04a05f17d"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a7363b5a3d48a5a8782fa4aa04a05f17d">GetFontFamilyAndStyle</a> (<a class="el" href="class_p_m_string.html">PMString</a> &amp;fontName, <a class="el" href="class_p_m_string.html">PMString</a> &amp;fontFamily, <a class="el" href="class_p_m_string.html">PMString</a> &amp;fontStyle)=0</td></tr><tr class="separator:a7363b5a3d48a5a8782fa4aa04a05f17d"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a2136baad6e302de52b0931de550b2c39"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a2136baad6e302de52b0931de550b2c39">InGalleyOrStory</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:a2136baad6e302de52b0931de550b2c39"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af3d30c48625db681489b3b1da3017113"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#af3d30c48625db681489b3b1da3017113">InGalley</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:af3d30c48625db681489b3b1da3017113"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a324882109f076b2d6ef57abcac9887d7"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a324882109f076b2d6ef57abcac9887d7">InStory</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:a324882109f076b2d6ef57abcac9887d7"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a369f6f615a4b19e55842cd3ee1afab1c"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a369f6f615a4b19e55842cd3ee1afab1c">InLayout</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:a369f6f615a4b19e55842cd3ee1afab1c"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:af8b746c9f545ef734ac30ed20554660a"><td align="right" class="memItemLeft" valign="top">virtual <br class="typebreak" /><a class="el" href="class_i_in_copy_view_prefs.html#a05ade85e2ab8503b788a76ded1d7cdc1">IInCopyViewPrefs::ActiveView</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#af8b746c9f545ef734ac30ed20554660a">GetViewMode</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:af8b746c9f545ef734ac30ed20554660a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab2ec6eca32eebd3a9ddb3a1578c37ce9"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#ab2ec6eca32eebd3a9ddb3a1578c37ce9">SetViewMode</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres, <a class="el" href="class_i_in_copy_view_prefs.html#a05ade85e2ab8503b788a76ded1d7cdc1">IInCopyViewPrefs::ActiveView</a> viewMode)=0</td></tr><tr class="separator:ab2ec6eca32eebd3a9ddb3a1578c37ce9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9a4d93b82bc2a884eee488ef5c655e97"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a9a4d93b82bc2a884eee488ef5c655e97">SetGalleyTextSelection</a> (TextIndex nStart, TextIndex nEnd, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> storyRef, <a class="el" href="class_i_control_view.html">IControlView</a> *forView=nil, bool16 ownedItemAllowed=kFalse)=0</td></tr><tr class="separator:a9a4d93b82bc2a884eee488ef5c655e97"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aceba518a5d4a197377943d2970853d53"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aceba518a5d4a197377943d2970853d53">SetLayoutTextSelection</a> (TextIndex nStart, TextIndex nEnd, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> storyRef, bool16 ownedItemAllowed=kFalse)=0</td></tr><tr class="separator:aceba518a5d4a197377943d2970853d53"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aaac79ed5f1fdc5cdf89a3cc9a7beae84"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aaac79ed5f1fdc5cdf89a3cc9a7beae84">GetCurrentTextSelection</a> (TextIndex &amp;nStart, TextIndex &amp;nEnd, <a class="el" href="class_u_i_d_ref.html">UIDRef</a> *storyRef, <a class="el" href="class_i_control_view.html">IControlView</a> *view=nil)=0</td></tr><tr class="separator:aaac79ed5f1fdc5cdf89a3cc9a7beae84"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a51080b4c67a75e195dd5bf0278d2d6d8"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a51080b4c67a75e195dd5bf0278d2d6d8">GetListOfUserStories</a> (<a class="el" href="class_i_document.html">IDocument</a> *document, <a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;stories, bool16 stripGraphicStories=kFalse)=0</td></tr><tr class="separator:a51080b4c67a75e195dd5bf0278d2d6d8"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ae47c2d147103a2d2411f035e96f37d0b"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#ae47c2d147103a2d2411f035e96f37d0b">IsStoryCollapsedInGalley</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;storyRef)=0</td></tr><tr class="separator:ae47c2d147103a2d2411f035e96f37d0b"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a96659cea1229fbb6450eb51ba676bbac"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a96659cea1229fbb6450eb51ba676bbac">GetNonCollapsedStoryList</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres, <a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;storyList)=0</td></tr><tr class="separator:a96659cea1229fbb6450eb51ba676bbac"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a103c06693be8ad310382729f54f5f9c0"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a103c06693be8ad310382729f54f5f9c0">GetPageNumberString</a> (TextIndex pageNumberCharIndex, <a class="el" href="class_i_text_model.html">ITextModel</a> *model)=0</td></tr><tr class="separator:a103c06693be8ad310382729f54f5f9c0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a362f74d4b93f96948a9802200c360026"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a362f74d4b93f96948a9802200c360026">GetTrueOversetLineLength</a> (<a class="el" href="class_i_text_model.html">ITextModel</a> *model, TextIndex startModelOffset, int32 averageLineLength, int32 primarySpan, bool16 &amp;endsInForceBreak)=0</td></tr><tr class="separator:a362f74d4b93f96948a9802200c360026"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa329b101a1c2962194d9808f8025c4e4"><td align="right" class="memItemLeft" valign="top">virtual int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aa329b101a1c2962194d9808f8025c4e4">EstimateOversetLineLengths</a> (<a class="el" href="class_i_text_model.html">ITextModel</a> *model)=0</td></tr><tr class="separator:aa329b101a1c2962194d9808f8025c4e4"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ae78d55045edd05cb53b021474a5883a0"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#ae78d55045edd05cb53b021474a5883a0">IsBreakCharacter</a> (const <a class="el" href="class_u_t_f32_text_char.html">UTF32TextChar</a> &amp;character, bool16 &amp;forceBreak, <a class="el" href="class_i_drawing_style.html">IDrawingStyle</a> *drawStyle=nil, <a class="el" href="class_i_text_model.html">ITextModel</a> *model=nil, TextIndex position=0L)=0</td></tr><tr class="separator:ae78d55045edd05cb53b021474a5883a0"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a48966308d2d2c63ecec36ff311e92d12"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a48966308d2d2c63ecec36ff311e92d12">RefreshAllText</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *writingView, bool16 justInval, bool16 ignoreILE, bool16 backgroundCompose=kFalse)=0</td></tr><tr class="separator:a48966308d2d2c63ecec36ff311e92d12"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0cb4ecdee74898bb5ce620b02f4cfeb9"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a0cb4ecdee74898bb5ce620b02f4cfeb9">InvalInfoColumn</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *writingView)=0</td></tr><tr class="separator:a0cb4ecdee74898bb5ce620b02f4cfeb9"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a6424f0950cdba2f362e4f7be68bf3aa2"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a6424f0950cdba2f362e4f7be68bf3aa2">SuspendPlayPendingInvals</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:a6424f0950cdba2f362e4f7be68bf3aa2"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0f5316c548512f8cd1b8c8fe73cb3e79"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a0f5316c548512f8cd1b8c8fe73cb3e79">ResumePlayPendingInvals</a> (<a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *pres=nil)=0</td></tr><tr class="separator:a0f5316c548512f8cd1b8c8fe73cb3e79"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:afe507a24da93eeca50af21d546f11910"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#afe507a24da93eeca50af21d546f11910">SuspendPlayPendingInvals</a> (<a class="el" href="class_u_i_d_ref.html">UIDRef</a> viewRef=UIDRef::gNull)=0</td></tr><tr class="separator:afe507a24da93eeca50af21d546f11910"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a0ffcbe50b7b3ed9546ae02f31c1e5cba"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a0ffcbe50b7b3ed9546ae02f31c1e5cba">ResumePlayPendingInvals</a> (<a class="el" href="class_u_i_d_ref.html">UIDRef</a> viewRef=UIDRef::gNull)=0</td></tr><tr class="separator:a0ffcbe50b7b3ed9546ae02f31c1e5cba"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aecac08e97dc186f84ecf38243f03f88f"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#aecac08e97dc186f84ecf38243f03f88f">CorrectFakedSpaceWidth</a> (const <a class="el" href="class_u_t_f32_text_char.html">UTF32TextChar</a> &amp;character, <a class="el" href="class_p_m_real.html">PMReal</a> ptSize, <a class="el" href="class_i_font_instance.html">IFontInstance</a> *fontInstance, <a class="el" href="class_p_m_real.html">PMReal</a> &amp;charWidth)=0</td></tr><tr class="separator:aecac08e97dc186f84ecf38243f03f88f"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a2d26d3930e050fb2c0414cd48cc5f698"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a2d26d3930e050fb2c0414cd48cc5f698">ScrollToCursor</a> (<a class="el" href="class_i_control_view.html">IControlView</a> *writingView, bool16 forceScroll=kFalse)=0</td></tr><tr class="separator:a2d26d3930e050fb2c0414cd48cc5f698"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:ab9c6aa7d1c34e855dfe15c73ca863f64"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#ab9c6aa7d1c34e855dfe15c73ca863f64">GetInCopyStoriesForGalley</a> (<a class="el" href="class_i_document.html">IDocument</a> *theDoc, <a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;filteredStories, bool16 stripGraphicStories)=0</td></tr><tr class="separator:ab9c6aa7d1c34e855dfe15c73ca863f64"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a6c65e8a9125b5b8679b552d5f4e9779a"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a6c65e8a9125b5b8679b552d5f4e9779a">WriteStoryListFile</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;docRef)=0</td></tr><tr class="separator:a6c65e8a9125b5b8679b552d5f4e9779a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a3b4a22ff0d74d68b50bbabad710367c1"><td align="right" class="memItemLeft" valign="top">virtual bool16&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a3b4a22ff0d74d68b50bbabad710367c1">ReadStoryListFile</a> (const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;docRef)=0</td></tr><tr class="separator:a3b4a22ff0d74d68b50bbabad710367c1"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a99b36142eca74d6df9d9201ecd6f9e6a"><td align="right" class="memItemLeft" valign="top">virtual std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a99b36142eca74d6df9d9201ecd6f9e6a">GetFontOfStyleAsStdStr</a> (<a class="el" href="class_p_m_string.html">PMString</a> fontFamilyName, IFontMgr::FontStyleBits fontStyle)=0</td></tr><tr class="separator:a99b36142eca74d6df9d9201ecd6f9e6a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a4945569062dd5dd8c2856bd77b6bf03a"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_galley_utils.html#a4945569062dd5dd8c2856bd77b6bf03a">GetFontNameAsStdStr</a> (std::string &amp;fontName, <a class="el" href="class_p_m_string.html">PMString</a> &amp;fontFamilyName, <a class="el" href="class_p_m_string.html">PMString</a> &amp;style)=0</td></tr><tr class="separator:a4945569062dd5dd8c2856bd77b6bf03a"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="inherit_header pub_methods_class_i_p_m_unknown"><td colspan="2" onclick="javascript:toggleInherit(&#39;pub_methods_class_i_p_m_unknown&#39;)"><img alt="-" src="closed.png" />&nbsp;Public Member Functions inherited from <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a></td></tr><tr class="memitem:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual <a class="el" href="class_i_p_m_unknown.html">IPMUnknown</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aaa3b657383c4699900aaec5dc7348864">QueryInterface</a> (<a class="el" href="class_i_d_type.html">PMIID</a> interfaceID) const =0</td></tr><tr class="separator:aaa3b657383c4699900aaec5dc7348864 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#aa90872f1896d2f2623cbb6f0bff98443">AddRef</a> () const =0</td></tr><tr class="separator:aa90872f1896d2f2623cbb6f0bff98443 inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr><tr class="memitem:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td align="right" class="memItemLeft" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_p_m_unknown.html#a9365365afb903ae6a6450593930a0f9c">Release</a> () const =0</td></tr><tr class="separator:a9365365afb903ae6a6450593930a0f9c inherit pub_methods_class_i_p_m_unknown"><td class="memSeparator" colspan="2">&nbsp;</td></tr></table><a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2><div class="textblock"><p><a class="el" href="class_i_galley_utils.html">IGalleyUtils</a> is an aggregrate of many different utility functions centered around the document window and galley sub window.<p>A writing widget is identified by having a ITEXTLINES and IQUICKCOMPOSER interface The user interface shows three tabs in the document window, one layout, one galley, and one story. But the widget hierarchy actually only contains a layout view and a writing widget that has two modes: Accurate line endings (Galley) and innaccurate line endings (Story). Some of the helper functions below attempt to mimic what the user sees rather than how it is implemented, i.e. there are three constants for the view, kLayout, kStory, kGalley.<p>All references to the writing widget really refer to the composite widget that can either be showing accurate line endings or innaccurate line endings.<p>A writing widget can contain multiple stories but only one story has text focus at a time. The story with text focus is the active story. </div><h2 class="groupheader">Member Function Documentation</h2><a class="anchor" id="aecac08e97dc186f84ecf38243f03f88f"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::CorrectFakedSpaceWidth </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_t_f32_text_char.html">UTF32TextChar</a> &amp;&nbsp;</td><td class="paramname"><em>character</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a>&nbsp;</td><td class="paramname"><em>ptSize</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_font_instance.html">IFontInstance</a> *&nbsp;</td><td class="paramname"><em>fontInstance</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a> &amp;&nbsp;</td><td class="paramname"><em>charWidth</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This is a helper method that will give back widths of different types of space characters. You may pass any character to it if the character is not of a type this routine knows something about the charWidth parameter will not be adjusted if it is then the charWidth parameter may be modified to give the width of the special type space character. Faked space characters are things like emspace, enspace, thinspace etc. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">character</td><td>Character code of the character to check </td></tr><tr><td class="paramname">ptSize</td><td>display font point size (used to determine m space widths and other spaces based on m spaces) </td></tr><tr><td class="paramname">fontInstance</td><td>instance of font that we are displaying text with. </td></tr><tr><td class="paramname">charWidth</td><td>the width of the space character is returned in this parameter. This value is not changed if the character is not recognized by this routine. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if resume was successful. </dl></div></div><a class="anchor" id="acd17b462f7edd18518eb0f66057a5c8e"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::DrawInterfaceString </td><td>(</td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>string</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>drawInView</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_graphics_port.html">IGraphicsPort</a> *&nbsp;</td><td class="paramname"><em>gPort</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_rect.html">PMRect</a> &amp;&nbsp;</td><td class="paramname"><em>textBounds</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_point.html">PMPoint</a> &amp;&nbsp;</td><td class="paramname"><em>textLoc</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_real_a_g_m_color.html">RealAGMColor</a> &amp;&nbsp;</td><td class="paramname"><em>textColor</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_real_a_g_m_color.html">RealAGMColor</a> &amp;&nbsp;</td><td class="paramname"><em>backgroundColor</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>hilite</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Draws a string in the interface font appropriate for the platform. This is necessary because agm doesn&#39;t render the interface font properly. textBounds is the area the string draws into in gPorts coordinates. textLoc specifies the baseline in relation to text bounds. 0,0 would put the baseline at the top left of textBounds. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">string</td><td>The text string to render. </td></tr><tr><td class="paramname">drawInView</td><td>The view we are drawing the string in. All coordinates are local to this view. </td></tr><tr><td class="paramname">gPort</td><td>The graphics port to render into. </td></tr><tr><td class="paramname">textBounds</td><td>The area the string draws in the port. </td></tr><tr><td class="paramname">textLoc</td><td>The baseline in relation to textBounds. 0,0 would be at the top left of textBounds. </td></tr><tr><td class="paramname">textColor</td><td>The color to render the string in. </td></tr><tr><td class="paramname">backgroundColor</td><td>The color to fill behind the text. </td></tr><tr><td class="paramname">hilite</td><td>Indicates whether to use the normal (kFalse) or bold (kTrue) interface font. </td></tr></table></dl></div></div><a class="anchor" id="aa329b101a1c2962194d9808f8025c4e4"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IGalleyUtils::EstimateOversetLineLengths </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>model</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Estimates the average line length the normal composer used when composing this text model. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">model</td><td>The text model to use. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The average line length. </dl></div></div><a class="anchor" id="a436ed398ac3fa47a654f6c2abd487c52"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a>* IGalleyUtils::FindFrontmostGalleyPresentation </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the front most document window associated with the document. If document is nil then it finds the window associated with the front most document. If the front most window of the document is in kLayout mode then this function will return nil. In other words, this method is a combination InGalleyOrStory and FindGalleyView. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>The document to find the front most document window. If document is nil then it uses the front most document window </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The front most document window of document. Nil if the front most document window is in kLayout mode. </dl></div></div><a class="anchor" id="aa2f7e2234940eeb4c8dc769ea9971f89"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a>* IGalleyUtils::FindFrontmostLayoutPresentation </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the front most layout window associated with the document. If document is nil then it finds the frontmost layout window associated with the active context document. If there are no layout windows open this function will return nil. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>The document to find the front most layout window. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The front most layout window of document. Nil if there are no layout windows. </dl></div></div><a class="anchor" id="a1729a5452061fb992c61143394e44c27"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_control_view.html">IControlView</a>* IGalleyUtils::FindGalleyView </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Finds the writing widget in the front most document window of the passed in document. This method does not AddRef the writing widget. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>The document to find the widget from. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The writing widget. Caller does not need to release the writing widget. </dl></div></div><a class="anchor" id="aaac79ed5f1fdc5cdf89a3cc9a7beae84"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetCurrentTextSelection </td><td>(</td><td class="paramtype">TextIndex &amp;&nbsp;</td><td class="paramname"><em>nStart</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex &amp;&nbsp;</td><td class="paramname"><em>nEnd</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a> *&nbsp;</td><td class="paramname"><em>storyRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>view</em> = <code>nil</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Get the current selection regardless of which mode the document window is in. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">nStart</td><td>OUT The start index of the selection. </td></tr><tr><td class="paramname">nEnd</td><td>OUT The end index of the selection. </td></tr><tr><td class="paramname">storyRef</td><td>OUT The story the selection is in. </td></tr></table></dl></div></div><a class="anchor" id="a7363b5a3d48a5a8782fa4aa04a05f17d"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetFontFamilyAndStyle </td><td>(</td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontFamily</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontStyle</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Given a full font name return the family and style. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontName</td><td>The font name to look up the family and style for. </td></tr><tr><td class="paramname">fontFamily</td><td>OUT The family of the specified font. </td></tr><tr><td class="paramname">fontStyle</td><td>OUT The style of the specified font. </td></tr></table></dl></div></div><a class="anchor" id="aacb5874000f42121d800863b7d7a25c2"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetFontName </td><td>(</td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontFamilyName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>style</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000003">Deprecated:</a></b><dd>This API is deprecated. Please use GetFontNameStdStr() instead A more generic way to find a font and style. Some fonts have non-standard styles that can only be specified by a string. This method finds the font fontFamilyName of style style and returns it. </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontName</td><td>OUT The returned postscript font name if a font is found. </td></tr><tr><td class="paramname">fontFamilyName</td><td>The font family name such as Times. </td></tr><tr><td class="paramname">style</td><td>The font style such as Bold. </td></tr></table></dl></div></div><a class="anchor" id="a4945569062dd5dd8c2856bd77b6bf03a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetFontNameAsStdStr </td><td>(</td><td class="paramtype">std::string &amp;&nbsp;</td><td class="paramname"><em>fontName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontFamilyName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>style</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>A more generic way to find a font and style. Some fonts have non-standard styles that can only be specified by a string. This method finds the font fontFamilyName of style style and returns it. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontName</td><td>OUT The returned postscript font name if a font is found. </td></tr><tr><td class="paramname">fontFamilyName</td><td>The font family name such as Times. </td></tr><tr><td class="paramname">style</td><td>The font style such as Bold. </td></tr></table></dl></div></div><a class="anchor" id="a75c0bcc7aa57ea546231c8b180c224c7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetFontNameList </td><td>(</td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>fontList</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>filterSymbolFonts</em> = <code>kTrue</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; *&nbsp;</td><td class="paramname"><em>translatedFontList</em> = <code>nil</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns a list of all the fonts installed in the font manager. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">List</td><td>OUT The list of all the fonts. </td></tr><tr><td class="paramname">filterSymbolFonts</td><td>if True it will filter out some known symbol fonts otherwise it will return a full list </td></tr><tr><td class="paramname">translatedFontList</td><td>will return a list of the fonts with translated names for ui display </td></tr></table></dl></div></div><a class="anchor" id="a38e7f3afb5af44d582ea1ead9cf186fb"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_p_m_string.html">PMString</a> IGalleyUtils::GetFontOfStyle </td><td>(</td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="paramname"><em>fontFamilyName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">IFontMgr::FontStyleBits&nbsp;</td><td class="paramname"><em>fontStyle</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000002">Deprecated:</a></b><dd>This API is deprecated. Please use GetFontOfStyleStdStr() instead. Returns the name of the font given the family name and style. Fonts often have font variants for the bold, italic, bolditalic, all caps, and small caps. For example, Times and Times Bold are two different fonts but you may only want to refer to Times and ask for the variant by ID (fontStyle). This method will attempt to find the variant that contains the style asked for. </dl><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontFamilyName</td><td>The font family name. </td></tr><tr><td class="paramname">fontStyle</td><td>The style of the font such as kBold. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The postscript name of the font having the style. </dl></div></div><a class="anchor" id="a99b36142eca74d6df9d9201ecd6f9e6a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual std::string IGalleyUtils::GetFontOfStyleAsStdStr </td><td>(</td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="paramname"><em>fontFamilyName</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">IFontMgr::FontStyleBits&nbsp;</td><td class="paramname"><em>fontStyle</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the name of the font given the family name and style. Fonts often have font variants for the bold, italic, bolditalic, all caps, and small caps. For example, Times and Times Bold are two different fonts but you may only want to refer to Times and ask for the variant by ID (fontStyle). This method will attempt to find the variant that contains the style asked for. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontFamilyName</td><td>The font family name. </td></tr><tr><td class="paramname">fontStyle</td><td>The style of the font such as kBold. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The postscript name of the font having the style. </dl></div></div><a class="anchor" id="a0a100bcb87f62740f3144a86587de763"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetFontStyleList </td><td>(</td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_p_m_string.html">PMString</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>StyleList</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>fontFamily</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the entire font family given a family name. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">StyleList</td><td>OUT The list of fonts that are in the family. </td></tr><tr><td class="paramname">fontFamily</td><td>The font family such as Times. </td></tr></table></dl></div></div><a class="anchor" id="a5e597cb0a40f6490ba908434ab8400c7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a> IGalleyUtils::GetFrameRef </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>writingWidget</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the frame corresponding to the given writing widget. If the text is threaded through several frames then this is the first frame in the thread. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writingWidget</td><td>The writing widget used to get the active story and then frame. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The frame that corresponds to the active story. </dl></div></div><a class="anchor" id="ae9a1a2d6c1c136db726c7749425f35f9"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_u_i_d_list.html">UIDList</a> IGalleyUtils::GetGalleyPanels </td><td>(</td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>onDocRef</em> = <code><a class="el" href="class_u_i_d_ref.html">UIDRef</a>()</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns a list of writing widgets for the dococument. This is a list because there can be more than one document window open and therefore more than one writing widget. If there are N document windows open then there will be N writing widgets in the return value. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">onDocRef</td><td>The document to find the writing widgets. If empty then the method gets the front most document. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>A <a class="el" href="class_u_i_d_list.html">UIDList</a> of the writing widgets. </dl></div></div><a class="anchor" id="ab9c6aa7d1c34e855dfe15c73ca863f64"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetInCopyStoriesForGalley </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>theDoc</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;&nbsp;</td><td class="paramname"><em>filteredStories</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>stripGraphicStories</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Get the stories to display in the galley and story views while running in InCopy. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">theDoc</td><td>document to retrieve stories for </td></tr><tr><td class="paramname">filteredStories</td><td>list of stories to display in story and galley is returned in this variable </td></tr><tr><td class="paramname">stripGraphicStories</td><td>want to pass true for this parameter story and galley don&#39;t support graphic stories. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>none </dl></div></div><a class="anchor" id="a51080b4c67a75e195dd5bf0278d2d6d8"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetListOfUserStories </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document.html">IDocument</a> *&nbsp;</td><td class="paramname"><em>document</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;&nbsp;</td><td class="paramname"><em>stories</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>stripGraphicStories</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the list of InCopy stories in the document. This method uses the InCopy story list but filters out any InCopy stories which are inline stories of other InCopy stories. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>The document to get the stories for. </td></tr><tr><td class="paramname">stories</td><td>OUT The return list of stories. </td></tr><tr><td class="paramname">stripGraphicStoris</td><td>IN A flag to indicate if graphic stories should be stripped. </td></tr></table></dl></div></div><a class="anchor" id="a96659cea1229fbb6450eb51ba676bbac"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetNonCollapsedStoryList </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_list.html">UIDList</a> &amp;&nbsp;</td><td class="paramname"><em>storyList</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>For the given document window return the list of expanded stories. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window from which to find the writing widget. Can be the document window or the galley window. </td></tr><tr><td class="paramname">storyList</td><td>OUT Returns the list of expanded stories. </td></tr></table></dl></div></div><a class="anchor" id="a103c06693be8ad310382729f54f5f9c0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_p_m_string.html">PMString</a> IGalleyUtils::GetPageNumberString </td><td>(</td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>pageNumberCharIndex</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>model</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the page number string for the given index. Essentially maps the index to a frame and computes the page that frame is on. Assumes that we have the position of a page number character. If this is true then it will return the string representation of the page number this character is on. Only will work in galley or layout. Story does not have the information available to calculate page numbers. Routine IS NOT fast don&#39;t call it unnecessarily. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">pageNumberCharIndex</td><td>The text index to check. </td></tr><tr><td class="paramname">model</td><td>The text model to check in. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The page number string. </dl></div></div><a class="anchor" id="adb382fbbd672d8084c90edcfcaf6184e"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IGalleyUtils::GetStoryIndex </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_lines.html">ITextLines</a> *&nbsp;</td><td class="paramname"><em>textLines</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>textModel</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><pre class="fragment">Get the story index for a galley/story editor story.

</pre><dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">textLines</td><td>IN the <a class="el" href="class_i_text_lines.html">ITextLines</a> interface. </td></tr><tr><td class="paramname">textModel</td><td>IN the text model. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>story index for this story. -1 if not found. </dl></div></div><a class="anchor" id="a6fbfe5a17b4050e49e7d9496e2746f08"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_u_i_d_ref.html">UIDRef</a> IGalleyUtils::GetStoryRef </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>writingWidget</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the active story for the given writing widget. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writingWidget</td><td>The writing widget used to get the active story. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The active story. </dl></div></div><a class="anchor" id="a362f74d4b93f96948a9802200c360026"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual int32 IGalleyUtils::GetTrueOversetLineLength </td><td>(</td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>model</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>startModelOffset</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>averageLineLength</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>primarySpan</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16 &amp;&nbsp;</td><td class="paramname"><em>endsInForceBreak</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Calculates the overset line lengths. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">model</td><td>The text model to compute from. </td></tr><tr><td class="paramname">startModelOffset</td><td>The text index to start from. </td></tr><tr><td class="paramname">averageLineLength</td><td>The average line length to use computing the line lengths. </td></tr><tr><td class="paramname">primarySpan</td><td>The length of the primary span. </td></tr><tr><td class="paramname">endsInForceBreak</td><td>Returns whether the line ends because of a break character or not. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns the index of where the line broke. </dl></div></div><a class="anchor" id="af8b746c9f545ef734ac30ed20554660a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_in_copy_view_prefs.html#a05ade85e2ab8503b788a76ded1d7cdc1">IInCopyViewPrefs::ActiveView</a> IGalleyUtils::GetViewMode </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the ViewMode (kStory, kGalley, or kLayout) of the window. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to check. If nil this method uses the front most document window. </td></tr></table></dl></div></div><a class="anchor" id="a6ade9ca428c9463713189b9960800f73"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_control_view.html">IControlView</a>* IGalleyUtils::GetWritingWidget </td><td>(</td><td class="paramtype"><a class="el" href="class_i_panel_control_data.html">IPanelControlData</a> *&nbsp;</td><td class="paramname"><em>panelData</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>storyRef</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Type definitions for some of the methods below is in <a class="el" href="class_i_in_copy_view_prefs.html">IInCopyViewPrefs</a>. The document window is either in kGalley, kStory, or kLayout. kGalley is the accurate line endings mode with copyfit. kStory is the innaccurate line endings mode without copyfit. kLayout is the InDesign layou preview mode.Returns the writing widget that has the passed in story ref. If a writing widget is not found it returns nil. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">panelData</td><td>The panel control data of the document window </td></tr><tr><td class="paramname">storyRef</td><td>The story reference the caller wants to find the writing widget for </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The writing widget </dl></div></div><a class="anchor" id="af2ed3937022ab06b82bb9a30d10b224b"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::GetXMeasureUnitList </td><td>(</td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; <a class="el" href="class_i_d_type.html">ClassID</a> &gt; &amp;&nbsp;</td><td class="paramname"><em>unitList</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the ClassID list of x measure unit, with <a class="el" href="classk_ruler_custom_m_s_boss.html">kRulerCustomMSBoss</a> in the last item. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">unitList</td><td>OUT the x measure unit list. </td></tr></table></dl></div></div><a class="anchor" id="af3d30c48625db681489b3b1da3017113"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::InGalley </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns kTrue if the window is in kGalley mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to check. If nil this method uses the front most document window. </td></tr></table></dl></div></div><a class="anchor" id="a2136baad6e302de52b0931de550b2c39"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::InGalleyOrStory </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns kTrue if the window has the writing widget active, i.e. in kGalley or kStory mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to check. If nil this method uses the front most document window. </td></tr></table></dl></div></div><a class="anchor" id="a369f6f615a4b19e55842cd3ee1afab1c"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::InLayout </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns kTrue if the window is in kLayout mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to check. If nil this method uses the front most document window. </td></tr></table></dl></div></div><a class="anchor" id="a324882109f076b2d6ef57abcac9887d7"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::InStory </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns kTrue if the window is in kStory mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to check. If nil this method uses the front most document window. </td></tr></table></dl></div></div><a class="anchor" id="a0cb4ecdee74898bb5ce620b02f4cfeb9"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::InvalInfoColumn </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>writingView</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Redraw the info column. </div></div><a class="anchor" id="ae78d55045edd05cb53b021474a5883a0"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::IsBreakCharacter </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_t_f32_text_char.html">UTF32TextChar</a> &amp;&nbsp;</td><td class="paramname"><em>character</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16 &amp;&nbsp;</td><td class="paramname"><em>forceBreak</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_drawing_style.html">IDrawingStyle</a> *&nbsp;</td><td class="paramname"><em>drawStyle</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_text_model.html">ITextModel</a> *&nbsp;</td><td class="paramname"><em>model</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>position</em> = <code>0L</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns if the given character is a break character or no. e.g. a carraige return. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">character</td><td>The text character to check in UTF32 format. Note, unless it&#39;s a J paragraph this is all that is really is needed to get a break point </td></tr><tr><td class="paramname">forceBreak</td><td>OUT Whether this is a force break character or not. </td></tr><tr><td class="paramname">drawStyle</td><td>used to determine whether this is a J paragraph which needs additional break rules applied </td></tr><tr><td class="paramname">model</td><td>if this is a J paragraph then the routine needs to look at surrounding characters to determine legal breaks </td></tr><tr><td class="paramname">position</td><td>text index within the story to look for legal break points </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if this is a bream character, kFalse if not. </dl></div></div><a class="anchor" id="ae47c2d147103a2d2411f035e96f37d0b"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::IsStoryCollapsedInGalley </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>storyRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This checks the front most documet window to see if the given story is collapsed. Each writing widget can have a different list of collapsed and not collapsed stories. Returns kFalse if the front most window is in kLayout mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">storyRef</td><td>The Story to check if it is collapsed. </td></tr></table></dl></div></div><a class="anchor" id="a704af557d515295e08256312356f4328"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::MeasureText </td><td>(</td><td class="paramtype"><a class="el" href="class_i_font_instance.html">IFontInstance</a> *&nbsp;</td><td class="paramname"><em>fontInstance</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">const <a class="el" href="class_p_m_string.html">PMString</a> &amp;&nbsp;</td><td class="paramname"><em>data</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a> *&nbsp;</td><td class="paramname"><em>xWidth</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_real.html">PMReal</a> *&nbsp;</td><td class="paramname"><em>yWidth</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>A mechanism to measure interface text that does not rely on an AGMGraphicsContext. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">fontInstance</td><td>The font used to measure with. </td></tr><tr><td class="paramname">data</td><td>The string of text to measure. </td></tr><tr><td class="paramname">xWidth</td><td>OUT The returned width in pixels. </td></tr><tr><td class="paramname">yWidth</td><td>OUT The returned height in pixels. </td></tr></table></dl></div></div><a class="anchor" id="a9fd604e03b42ad4c43a2c016e0261e11"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_text_data_validation.html#aed36cd10fdb74b25f6b6048c2bdec9b6">ITextDataValidation::RangeError</a> IGalleyUtils::ParseLineRange </td><td>(</td><td class="paramtype"><a class="el" href="class_k2_vector.html">K2Vector</a>&lt; int32 &gt; &amp;&nbsp;</td><td class="paramname"><em>rangeList</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_p_m_string.html">PMString</a>&nbsp;</td><td class="paramname"><em>rangeText</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>start</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">int32&nbsp;</td><td class="paramname"><em>end</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Returns the indices of the text lines specified in rangeText that is between start and end. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">rangeList</td><td>OUT The list of lines. </td></tr><tr><td class="paramname">rangeText</td><td>The text the user entered in the print or PDF dialog to specify a range </td></tr><tr><td class="paramname">start</td><td>The starting index within which to search </td></tr><tr><td class="paramname">end</td><td>The ending index within which to search </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns whether the passed in arguments are valid or not. See <a class="el" href="class_i_text_data_validation.html">ITextDataValidation</a>. </dl></div></div><a class="anchor" id="aaf912cf0713b605461586b3745a5862f"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual <a class="el" href="class_i_p_m_font.html">IPMFont</a>* IGalleyUtils::QueryInterfaceFont </td><td>(</td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>hilite</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Platform neutral way to get the interface font. Windows, Mac OS 9, and Mac OS X all have different interface fonts. This method allows client code to remain platform agnostic. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">hilite</td><td>Indicates whether to get the normal (kFalse) or bold (kTrue) interface font. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>The corresponding interface font. </dl></div></div><a class="anchor" id="a3b4a22ff0d74d68b50bbabad710367c1"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::ReadStoryListFile </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>docRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Read an existing story list file and apply the results to all galley and story views. This routine is only relevant for INCOPY and will not work for InDesign. Because only InCopy supports multiple stories in a view. Assumes the story list file exists next to the InDesign document as would be created by the <a class="el" href="class_i_galley_utils.html#a6c65e8a9125b5b8679b552d5f4e9779a">WriteStoryListFile()</a> routine. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>associated with the story list file from (parent document). </td></tr></table></dl><dl class="section return"><dt>Returns<dd>- kTrue if successful </dl></div></div><a class="anchor" id="a48966308d2d2c63ecec36ff311e92d12"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::RefreshAllText </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>writingView</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>justInval</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>ignoreILE</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>backgroundCompose</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Recreate textlines or simply redraw the text dependent on flags. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writingView</td><td>The writing control view. </td></tr><tr><td class="paramname">justInval</td><td>kFalse means to recompose the text. </td></tr><tr><td class="paramname">ignoreILE</td><td>kTrue measn to ignore the text when the mode is ILE </td></tr><tr><td class="paramname">backgroundCompose</td><td>when justInval is kFalse, backgroundCompose is kTure means to compose starting first line. </td></tr></table></dl></div></div><a class="anchor" id="a0f5316c548512f8cd1b8c8fe73cb3e79"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::ResumePlayPendingInvals </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This is a helper method that wraps the command to resume play pending invals (drawing) for the text lines associated with the specified window. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to resume. If nil this method uses the front most document window. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if resume was successful. </dl></div></div><a class="anchor" id="a0ffcbe50b7b3ed9546ae02f31c1e5cba"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::ResumePlayPendingInvals </td><td>(</td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>viewRef</em> = <code>UIDRef::gNull</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This is a helper method that wraps the command to resume play pending invals (drawing) for the text lines associated with the specified window. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">viewRef</td><td>The control view <a class="el" href="class_u_i_d_ref.html">UIDRef</a> to resume. If nil this method uses the front most document window. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if resume was successful. </dl></div></div><a class="anchor" id="a2d26d3930e050fb2c0414cd48cc5f698"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::ScrollToCursor </td><td>(</td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>writingView</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>forceScroll</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This routine will scroll the view to the current cursor location. It will be scrolled so that the cursor is visible not centered. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">writingView</td><td>the gallay or story view to scroll to the cursor on. </td></tr><tr><td class="paramname">forceScroll</td><td>force the view to scroll to so that cursor is at the view top even if the cursor is already visible </td></tr></table></dl><dl class="section return"><dt>Returns<dd>none </dl></div></div><a class="anchor" id="a9a4d93b82bc2a884eee488ef5c655e97"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::SetGalleyTextSelection </td><td>(</td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>nStart</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>nEnd</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>storyRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_control_view.html">IControlView</a> *&nbsp;</td><td class="paramname"><em>forView</em> = <code>nil</code>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>ownedItemAllowed</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Set the selection in the Galley or Story mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">nStart</td><td>The start index of the selection to set. </td></tr><tr><td class="paramname">nEnd</td><td>The end index of the selection to set. </td></tr><tr><td class="paramname">storyRef</td><td>The story to make active and to set the selection in. </td></tr><tr><td class="paramname">ownedItemAllowed</td><td>kTrue to set selection in the owned item story thread, kFalse to convert selection in owned item story thread into its anchor position and set it as the current selection. </td></tr></table></dl></div></div><a class="anchor" id="aceba518a5d4a197377943d2970853d53"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::SetLayoutTextSelection </td><td>(</td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>nStart</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">TextIndex&nbsp;</td><td class="paramname"><em>nEnd</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>storyRef</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype">bool16&nbsp;</td><td class="paramname"><em>ownedItemAllowed</em> = <code>kFalse</code>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Set the selection in the Layout mode. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">nStart</td><td>The start index of the selection to set. </td></tr><tr><td class="paramname">nEnd</td><td>The end index of the selection to set. </td></tr><tr><td class="paramname">storyRef</td><td>The story to set the selection in. </td></tr><tr><td class="paramname">ownedItemAllowed</td><td>kTrue to set selection in the owned item story thread, kFalse to convert selection in owned item story thread into its anchor position and set it as the current selection. </td></tr></table></dl></div></div><a class="anchor" id="ab2ec6eca32eebd3a9ddb3a1578c37ce9"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual void IGalleyUtils::SetViewMode </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em>, </td></tr><tr><td class="paramkey"></td><td></td><td class="paramtype"><a class="el" href="class_i_in_copy_view_prefs.html#a05ade85e2ab8503b788a76ded1d7cdc1">IInCopyViewPrefs::ActiveView</a>&nbsp;</td><td class="paramname"><em>viewMode</em>&nbsp;</td></tr><tr><td></td><td>)</td><td></td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Sets the current view of the given document window. If there are no InCopy stories in the InCopy story list this method will force the window into kLayout mode only. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to set the view mode on. </td></tr><tr><td class="paramname">viewMode</td><td>The view mode to use (kStory, kGalley, kLayout). </td></tr></table></dl></div></div><a class="anchor" id="a6424f0950cdba2f362e4f7be68bf3aa2"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::SuspendPlayPendingInvals </td><td>(</td><td class="paramtype"><a class="el" href="class_i_document_presentation.html">IDocumentPresentation</a> *&nbsp;</td><td class="paramname"><em>pres</em> = <code>nil</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This is a helper method that wraps the command to suspend play pending invals (drawing) for the text lines associated with the specified window. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">window</td><td>The window to suspend. If nil this method uses the front most document window. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if suspend was successful. </dl></div></div><a class="anchor" id="afe507a24da93eeca50af21d546f11910"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::SuspendPlayPendingInvals </td><td>(</td><td class="paramtype"><a class="el" href="class_u_i_d_ref.html">UIDRef</a>&nbsp;</td><td class="paramname"><em>viewRef</em> = <code>UIDRef::gNull</code></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>This is a helper method that wraps the command to suspend play pending invals (drawing) for the text lines associated with the specified window. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">viewRef</td><td>The control view <a class="el" href="class_u_i_d_ref.html">UIDRef</a> to suspend. If nil this method uses the front most document window. </td></tr></table></dl><dl class="section return"><dt>Returns<dd>Returns kTrue if suspend was successful. </dl></div></div><a class="anchor" id="a6c65e8a9125b5b8679b552d5f4e9779a"></a><div class="memitem"><div class="memproto"><table class="mlabels"><tr><td class="mlabels-left"><table class="memname"><tr><td class="memname">virtual bool16 IGalleyUtils::WriteStoryListFile </td><td>(</td><td class="paramtype">const <a class="el" href="class_u_i_d_ref.html">UIDRef</a> &amp;&nbsp;</td><td class="paramname"><em>docRef</em></td><td>)</td><td></td></tr></table></td><td class="mlabels-right"><span class="mlabels"><span class="mlabel">pure virtual</span></span></td></tr></table></div><div class="memdoc"><p>Create if necessary and write out a story list file. Document will be created in the same directory as the parent document. Parent document must have been previously been saved to disk for this to work. This routine is currently only relevant for INCOPY. Because only InCopy supports multiple stories in a view. <dl class="params"><dt>Parameters<dd><table class="params"><tr><td class="paramname">document</td><td>to create the story list file from (parent document). </td></tr></table></dl><dl class="section return"><dt>Returns<dd>- kTrue if successful </dl></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="class_i_galley_utils.html">IGalleyUtils</a><li class="footer">Generated on Sat Sep 22 2018 10:54:16 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
