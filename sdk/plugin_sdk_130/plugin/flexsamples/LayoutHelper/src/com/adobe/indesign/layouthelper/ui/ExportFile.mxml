<?xml version="1.0" encoding="utf-8"?>
<!--
ADOBE SYSTEMS INCORPORATED
Copyright 2012 Adobe Systems Incorporated
All Rights Reserved.

NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the 
terms of the Adobe license agreement accompanying it.  If you have received this file from a 
source other than Adobe, then your use, modification, or distribution of it requires the prior 
written permission of Adobe.
-->
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" label="Export" width="100%" height="100%" horizontalScrollPolicy="off" verticalScrollPolicy="off">
	<mx:Script>
		<![CDATA[
			import com.adobe.csawlib.indesign.InDesign;
			import com.adobe.indesign.*;
			
			import flash.filesystem.File;
			
			import mx.collections.ArrayCollection;
				
			[Bindable]
			private var hostName:String = HostObject.mainExtension;
			[Bindable]
			public var formats:ArrayCollection = new ArrayCollection(
				[   
					{label:"PDF", data:ExportFormat.PDF_TYPE},
					{label:"PNG", data:ExportFormat.PNG_FORMAT}
				]);
			
			public function SaveFile():void
			{	
				var f:File = File.desktopDirectory;
				f.browseForSave("Export");
				f.addEventListener(flash.events.Event.SELECT, function (event:flash.events.Event):void 
				{
					var file:File = event.target as File;
					var app:Application = InDesign.app;
					var doc:Document = app.activeDocument;
					if(doc == null)
					{
						return;
					}
					doc.exportFile(format.selectedItem.data, file, option.selected);
				});
			}

		]]>
	</mx:Script>
		<mx:VBox width="100%" height="100%" paddingLeft="1" paddingRight="1" paddingTop="1">
			<mx:HBox>
				<mx:Label text="Format:"/>
				<mx:ComboBox id="format" dataProvider="{formats}"/>
			</mx:HBox>
			<mx:CheckBox id="option" label="Show Options" disabledColor="0" selected="false" enabled="true"  color="#132124" fontFamily="Verdana"/>
			<mx:Button label="Export Files" click="{SaveFile();}" toolTip="Export to specific format file"/>
		</mx:VBox>
</mx:Canvas>
